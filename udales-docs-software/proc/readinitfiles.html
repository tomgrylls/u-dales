<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
    <meta name="description" content="Documentation for uDALES">
   
    <meta name="author" content="The uDALES Team" >
    <link rel="icon" href="../favicon.png">

    <title>readinitfiles &ndash; uDALES</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">uDALES </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/dalesurban.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/dalesurban.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>readinitfiles
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 4.7% of total for procedures.">607 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/modstartup.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/modstartup.f90.html'>modstartup.f90</a></li>
    
     <li><a href='../module/modstartup.html'>modstartup</a></li>
    
  
     <li class="active">readinitfiles</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/readinitfiles.html#src">readinitfiles</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine readinitfiles()
    
    
   
</h2>
    
  
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Uses</h3>
      </div>
      <ul class="list-group">
      
      <li class="list-group-item">
  <ul class="list-inline">
    
    <li><a href='../module/modfields.html'>modfields</a></li>
    
    <li><a href='../module/modglobal.html'>modglobal</a></li>
    
    <li><a href='../module/modsubgriddata.html'>modsubgriddata</a></li>
    
    <li><a href='../module/modsurfdata.html'>modsurfdata</a></li>
    
    <li><a href='../module/modboundary.html'>modboundary</a></li>
    
    <li><a href='../module/modmpi.html'>modmpi</a></li>
    
    <li><a href='../module/modthermodynamics.html'>modthermodynamics</a></li>
    
    <li><a href='../module/modinletdata.html'>modinletdata</a></li>
    
    <li><a href='../module/modinlet.html'>modinlet</a></li>
    
    <li><a href='../module/moddriver.html'>moddriver</a></li>
    
  </ul>
      </li>
      
      
      
      <li class="list-group-item">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: proc~~readinitfiles~~UsesGraph Pages: 1 -->
<svg id="procreadinitfilesUsesGraph" width="333pt" height="395pt"
 viewBox="0.00 0.00 333.00 394.52" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~readinitfiles~~UsesGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 390.5247)">
<title>proc~~readinitfiles~~UsesGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-390.5247 329,-390.5247 329,4 -4,4"/>
<!-- proc~readinitfiles -->
<g id="proc~~readinitfiles~~UsesGraph_node1" class="node">
<title>proc~readinitfiles</title>
<polygon fill="none" stroke="#000000" points="325,-213 258,-213 258,-189 325,-189 325,-213"/>
<text text-anchor="middle" x="291.5" y="-198.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">readinitfiles</text>
</g>
<!-- module~moddriver -->
<g id="proc~~readinitfiles~~UsesGraph_node2" class="node">
<title>module~moddriver</title>
<g id="a_proc~~readinitfiles~~UsesGraph_node2"><a xlink:href=".././module/moddriver.html" xlink:title="moddriver">
<polygon fill="#337ab7" stroke="#337ab7" points="196.5,-318 135.5,-318 135.5,-294 196.5,-294 196.5,-318"/>
<text text-anchor="middle" x="166" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">moddriver</text>
</a>
</g>
</g>
<!-- proc~readinitfiles&#45;&gt;module~moddriver -->
<g id="proc~~readinitfiles~~UsesGraph_edge1" class="edge">
<title>proc~readinitfiles&#45;&gt;module~moddriver</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M284.2834,-213.2852C273.0898,-231.3588 249.8993,-265.1171 222,-285 217.1247,-288.4744 211.6049,-291.449 205.9782,-293.9727"/>
<polygon fill="#ff0000" stroke="#ff0000" points="204.4624,-290.8103 196.5029,-297.8029 207.0858,-297.3001 204.4624,-290.8103"/>
</g>
<!-- module~modsurfdata -->
<g id="proc~~readinitfiles~~UsesGraph_node3" class="node">
<title>module~modsurfdata</title>
<g id="a_proc~~readinitfiles~~UsesGraph_node3"><a xlink:href=".././module/modsurfdata.html" xlink:title="modsurfdata">
<polygon fill="#337ab7" stroke="#337ab7" points="202.5,-360 129.5,-360 129.5,-336 202.5,-336 202.5,-360"/>
<text text-anchor="middle" x="166" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modsurfdata</text>
</a>
</g>
</g>
<!-- proc~readinitfiles&#45;&gt;module~modsurfdata -->
<g id="proc~~readinitfiles~~UsesGraph_edge2" class="edge">
<title>proc~readinitfiles&#45;&gt;module~modsurfdata</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M287.9412,-213.2432C280.1045,-238.1322 259.0451,-294.981 222,-327 218.9498,-329.6364 215.5366,-331.9561 211.9407,-333.9946"/>
<polygon fill="#ff0000" stroke="#ff0000" points="210.1723,-330.9633 202.7285,-338.5027 213.2492,-337.2509 210.1723,-330.9633"/>
</g>
<!-- module~modinlet -->
<g id="proc~~readinitfiles~~UsesGraph_node4" class="node">
<title>module~modinlet</title>
<g id="a_proc~~readinitfiles~~UsesGraph_node4"><a xlink:href=".././module/modinlet.html" xlink:title="modinlet">
<polygon fill="#337ab7" stroke="#337ab7" points="193,-276 139,-276 139,-252 193,-252 193,-276"/>
<text text-anchor="middle" x="166" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modinlet</text>
</a>
</g>
</g>
<!-- proc~readinitfiles&#45;&gt;module~modinlet -->
<g id="proc~~readinitfiles~~UsesGraph_edge5" class="edge">
<title>proc~readinitfiles&#45;&gt;module~modinlet</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M273.7225,-213.0001C259.9763,-221.9655 240.2698,-234.1481 222,-243 215.8474,-245.981 209.1551,-248.8178 202.6078,-251.3873"/>
<polygon fill="#ff0000" stroke="#ff0000" points="201.3136,-248.1348 193.1988,-254.9465 203.7903,-254.682 201.3136,-248.1348"/>
</g>
<!-- module~modmpi -->
<g id="proc~~readinitfiles~~UsesGraph_node5" class="node">
<title>module~modmpi</title>
<g id="a_proc~~readinitfiles~~UsesGraph_node5"><a xlink:href=".././module/modmpi.html" xlink:title="modmpi">
<polygon fill="#337ab7" stroke="#337ab7" points="193,-150 139,-150 139,-126 193,-126 193,-150"/>
<text text-anchor="middle" x="166" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modmpi</text>
</a>
</g>
</g>
<!-- proc~readinitfiles&#45;&gt;module~modmpi -->
<g id="proc~~readinitfiles~~UsesGraph_edge3" class="edge">
<title>proc~readinitfiles&#45;&gt;module~modmpi</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M273.7225,-188.9999C259.9763,-180.0345 240.2698,-167.8519 222,-159 215.8474,-156.019 209.1551,-153.1822 202.6078,-150.6127"/>
<polygon fill="#ff0000" stroke="#ff0000" points="203.7903,-147.318 193.1988,-147.0535 201.3136,-153.8652 203.7903,-147.318"/>
</g>
<!-- module~modboundary -->
<g id="proc~~readinitfiles~~UsesGraph_node6" class="node">
<title>module~modboundary</title>
<g id="a_proc~~readinitfiles~~UsesGraph_node6"><a xlink:href=".././module/modboundary.html" xlink:title="modboundary">
<polygon fill="#337ab7" stroke="#337ab7" points="205.5,-234 126.5,-234 126.5,-210 205.5,-210 205.5,-234"/>
<text text-anchor="middle" x="166" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modboundary</text>
</a>
</g>
</g>
<!-- proc~readinitfiles&#45;&gt;module~modboundary -->
<g id="proc~~readinitfiles~~UsesGraph_edge4" class="edge">
<title>proc~readinitfiles&#45;&gt;module~modboundary</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M257.8683,-206.6276C244.8978,-208.798 229.7946,-211.3252 215.6259,-213.6961"/>
<polygon fill="#ff0000" stroke="#ff0000" points="214.8031,-210.285 205.5179,-215.3874 215.9584,-217.189 214.8031,-210.285"/>
</g>
<!-- module~modsubgriddata -->
<g id="proc~~readinitfiles~~UsesGraph_node7" class="node">
<title>module~modsubgriddata</title>
<g id="a_proc~~readinitfiles~~UsesGraph_node7"><a xlink:href=".././module/modsubgriddata.html" xlink:title="modsubgriddata">
<polygon fill="#337ab7" stroke="#337ab7" points="211,-192 121,-192 121,-168 211,-168 211,-192"/>
<text text-anchor="middle" x="166" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modsubgriddata</text>
</a>
</g>
</g>
<!-- proc~readinitfiles&#45;&gt;module~modsubgriddata -->
<g id="proc~~readinitfiles~~UsesGraph_edge6" class="edge">
<title>proc~readinitfiles&#45;&gt;module~modsubgriddata</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M257.8683,-195.3724C246.5246,-193.4742 233.5497,-191.3031 220.9953,-189.2024"/>
<polygon fill="#ff0000" stroke="#ff0000" points="221.4968,-185.7377 211.0563,-187.5393 220.3415,-192.6418 221.4968,-185.7377"/>
</g>
<!-- module~modinletdata -->
<g id="proc~~readinitfiles~~UsesGraph_node8" class="node">
<title>module~modinletdata</title>
<g id="a_proc~~readinitfiles~~UsesGraph_node8"><a xlink:href=".././module/modinletdata.html" xlink:title="modinletdata">
<polygon fill="#337ab7" stroke="#337ab7" points="74,-318 0,-318 0,-294 74,-294 74,-318"/>
<text text-anchor="middle" x="37" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modinletdata</text>
</a>
</g>
</g>
<!-- proc~readinitfiles&#45;&gt;module~modinletdata -->
<g id="proc~~readinitfiles~~UsesGraph_edge7" class="edge">
<title>proc~readinitfiles&#45;&gt;module~modinletdata</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M290.8061,-213.1176C288.2343,-245.2571 276.3179,-332.6884 222,-369 180.6175,-396.6643 156.6566,-386.349 110,-369 86.9637,-360.4341 66.3407,-340.9732 52.9393,-325.9308"/>
<polygon fill="#ff0000" stroke="#ff0000" points="55.4257,-323.4529 46.2676,-318.1257 50.1047,-328.0013 55.4257,-323.4529"/>
</g>
<!-- module~modthermodynamics -->
<g id="proc~~readinitfiles~~UsesGraph_node9" class="node">
<title>module~modthermodynamics</title>
<g id="a_proc~~readinitfiles~~UsesGraph_node9"><a xlink:href=".././module/modthermodynamics.html" xlink:title="modthermodynamics">
<polygon fill="#337ab7" stroke="#337ab7" points="222,-108 110,-108 110,-84 222,-84 222,-108"/>
<text text-anchor="middle" x="166" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modthermodynamics</text>
</a>
</g>
</g>
<!-- proc~readinitfiles&#45;&gt;module~modthermodynamics -->
<g id="proc~~readinitfiles~~UsesGraph_edge8" class="edge">
<title>proc~readinitfiles&#45;&gt;module~modthermodynamics</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M284.2834,-188.7148C273.0898,-170.6412 249.8993,-136.8829 222,-117 219.8913,-115.4972 217.6621,-114.088 215.3558,-112.7683"/>
<polygon fill="#ff0000" stroke="#ff0000" points="216.6725,-109.5118 206.1703,-108.1136 213.5084,-115.7559 216.6725,-109.5118"/>
</g>
<!-- module~modfields -->
<g id="proc~~readinitfiles~~UsesGraph_node10" class="node">
<title>module~modfields</title>
<g id="a_proc~~readinitfiles~~UsesGraph_node10"><a xlink:href=".././module/modfields.html" xlink:title="modfields">
<polygon fill="#337ab7" stroke="#337ab7" points="195,-66 137,-66 137,-42 195,-42 195,-66"/>
<text text-anchor="middle" x="166" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modfields</text>
</a>
</g>
</g>
<!-- proc~readinitfiles&#45;&gt;module~modfields -->
<g id="proc~~readinitfiles~~UsesGraph_edge9" class="edge">
<title>proc~readinitfiles&#45;&gt;module~modfields</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M287.9412,-188.7568C280.1045,-163.8678 259.0451,-107.019 222,-75 216.9994,-70.6778 211.0231,-67.2067 204.8657,-64.4306"/>
<polygon fill="#ff0000" stroke="#ff0000" points="205.742,-61.0146 195.1546,-60.6179 203.1837,-67.5304 205.742,-61.0146"/>
</g>
<!-- module~modglobal -->
<g id="proc~~readinitfiles~~UsesGraph_node11" class="node">
<title>module~modglobal</title>
<g id="a_proc~~readinitfiles~~UsesGraph_node11"><a xlink:href=".././module/modglobal.html" xlink:title="modglobal">
<polygon fill="#337ab7" stroke="#337ab7" points="197,-24 135,-24 135,0 197,0 197,-24"/>
<text text-anchor="middle" x="166" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modglobal</text>
</a>
</g>
</g>
<!-- proc~readinitfiles&#45;&gt;module~modglobal -->
<g id="proc~~readinitfiles~~UsesGraph_edge10" class="edge">
<title>proc~readinitfiles&#45;&gt;module~modglobal</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M289.7916,-188.5617C284.9372,-157.8663 268.2867,-77.7623 222,-33 217.6009,-28.7458 212.2592,-25.3373 206.642,-22.6107"/>
<polygon fill="#ff0000" stroke="#ff0000" points="207.6248,-19.2295 197.0465,-18.6368 204.9463,-25.6968 207.6248,-19.2295"/>
</g>
<!-- module~moddriver&#45;&gt;module~modinletdata -->
<g id="proc~~readinitfiles~~UsesGraph_edge11" class="edge">
<title>module~moddriver&#45;&gt;module~modinletdata</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M135.4288,-306C120.2505,-306 101.568,-306 84.5728,-306"/>
<polygon fill="#ff0000" stroke="#ff0000" points="84.2554,-302.5001 74.2553,-306 84.2553,-309.5001 84.2554,-302.5001"/>
</g>
<!-- module~modinlet&#45;&gt;module~modinletdata -->
<g id="proc~~readinitfiles~~UsesGraph_edge12" class="edge">
<title>module~modinlet&#45;&gt;module~modinletdata</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M138.9574,-272.8046C123.0505,-277.9836 102.4923,-284.6769 84.0075,-290.6952"/>
<polygon fill="#cbff00" stroke="#cbff00" points="82.7062,-287.438 74.281,-293.862 84.8733,-294.0941 82.7062,-287.438"/>
</g>
<!-- mpi -->
<g id="proc~~readinitfiles~~UsesGraph_node12" class="node">
<title>mpi</title>
<g id="a_proc~~readinitfiles~~UsesGraph_node12"><a xlink:href="http://www.mpi-forum.org/docs/mpi-3.1/mpi31-report/node410.htm" xlink:title="mpi">
<polygon fill="#337ab7" stroke="#337ab7" points="64,-150 10,-150 10,-126 64,-126 64,-150"/>
<text text-anchor="middle" x="37" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mpi</text>
</a>
</g>
</g>
<!-- module~modmpi&#45;&gt;mpi -->
<g id="proc~~readinitfiles~~UsesGraph_edge13" class="edge">
<title>module~modmpi&#45;&gt;mpi</title>
<path fill="none" stroke="#33ff00" stroke-dasharray="5,2" d="M138.9574,-138C120.123,-138 94.7676,-138 74.0542,-138"/>
<polygon fill="#33ff00" stroke="#33ff00" points="74.0071,-134.5001 64.007,-138 74.007,-141.5001 74.0071,-134.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="490pt" height="32pt"
 viewBox="0.00 0.00 489.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 485.5,-28 485.5,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node">
<title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node">
<title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="139.5,-24 72.5,-24 72.5,0 139.5,0 139.5,-24"/>
<text text-anchor="middle" x="106" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="222,-24 158,-24 158,0 222,0 222,-24"/>
<text text-anchor="middle" x="190" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="294,-24 240,-24 240,0 294,0 294,-24"/>
<text text-anchor="middle" x="267" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="366,-24 312,-24 312,0 366,0 366,-24"/>
<text text-anchor="middle" x="339" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="481.5,-24 384.5,-24 384.5,0 481.5,0 481.5,-24"/>
<text text-anchor="middle" x="433" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a submodule to the (sub)module which it is
    descended from. Dashed arrows point from a module or program unit to 
    modules which it uses. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </li>
      
      </ul>
    </div>
    


    

    <h3>Arguments</h3>
    
    <em>None</em>
    <br>
    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: proc~~readinitfiles~~CallsGraph Pages: 1 -->
<svg id="procreadinitfilesCallsGraph" width="641pt" height="1170pt"
 viewBox="0.00 0.00 641.00 1169.82" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~readinitfiles~~CallsGraph" class="graph" transform="scale(.8903 .8903) rotate(0) translate(4 1310)">
<title>proc~~readinitfiles~~CallsGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-1310 716,-1310 716,4 -4,4"/>
<!-- proc~readinitfiles -->
<g id="proc~~readinitfiles~~CallsGraph_node1" class="node">
<title>proc~readinitfiles</title>
<polygon fill="none" stroke="#000000" points="67,-336 0,-336 0,-312 67,-312 67,-336"/>
<text text-anchor="middle" x="33.5" y="-321.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">readinitfiles</text>
</g>
<!-- proc~boundary -->
<g id="proc~~readinitfiles~~CallsGraph_node2" class="node">
<title>proc~boundary</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node2"><a xlink:href=".././proc/boundary.html" xlink:title="boundary">
<polygon fill="#d9534f" stroke="#d9534f" points="177.5,-806 119.5,-806 119.5,-782 177.5,-782 177.5,-806"/>
<text text-anchor="middle" x="148.5" y="-791.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">boundary</text>
</a>
</g>
</g>
<!-- proc~readinitfiles&#45;&gt;proc~boundary -->
<g id="proc~~readinitfiles~~CallsGraph_edge1" class="edge">
<title>proc~readinitfiles&#45;&gt;proc~boundary</title>
<path fill="none" stroke="#ff0000" d="M36.4583,-336.0904C51.8681,-399.0696 123.0085,-689.8174 143.1644,-772.1936"/>
<polygon fill="#ff0000" stroke="#ff0000" points="139.7848,-773.108 145.5613,-781.9896 146.5842,-771.4443 139.7848,-773.108"/>
</g>
<!-- proc~randomnize -->
<g id="proc~~readinitfiles~~CallsGraph_node3" class="node">
<title>proc~randomnize</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node3"><a xlink:href=".././proc/randomnize.html" xlink:title="randomnize">
<polygon fill="#d9534f" stroke="#d9534f" points="183,-356 114,-356 114,-332 183,-332 183,-356"/>
<text text-anchor="middle" x="148.5" y="-341.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">randomnize</text>
</a>
</g>
</g>
<!-- proc~readinitfiles&#45;&gt;proc~randomnize -->
<g id="proc~~readinitfiles~~CallsGraph_edge2" class="edge">
<title>proc~readinitfiles&#45;&gt;proc~randomnize</title>
<path fill="none" stroke="#ff0000" d="M67.0719,-329.8386C78.5702,-331.8383 91.6223,-334.1082 103.856,-336.2358"/>
<polygon fill="#ff0000" stroke="#ff0000" points="103.436,-339.7152 113.8878,-337.9805 104.6354,-332.8188 103.436,-339.7152"/>
</g>
<!-- proc~drivergen -->
<g id="proc~~readinitfiles~~CallsGraph_node4" class="node">
<title>proc~drivergen</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node4"><a xlink:href=".././proc/drivergen.html" xlink:title="drivergen">
<polygon fill="#d9534f" stroke="#d9534f" points="303,-1306 245,-1306 245,-1282 303,-1282 303,-1306"/>
<text text-anchor="middle" x="274" y="-1291.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">drivergen</text>
</a>
</g>
</g>
<!-- proc~readinitfiles&#45;&gt;proc~drivergen -->
<g id="proc~~readinitfiles~~CallsGraph_edge4" class="edge">
<title>proc~readinitfiles&#45;&gt;proc~drivergen</title>
<path fill="none" stroke="#ff0000" d="M33.9634,-336.1268C38.1277,-443.7352 69.724,-1232.0433 103,-1268 135.9524,-1303.607 195.4199,-1304.6262 234.8103,-1300.5325"/>
<polygon fill="#ff0000" stroke="#ff0000" points="235.3413,-1303.9941 244.8561,-1299.3337 234.5117,-1297.0434 235.3413,-1303.9941"/>
</g>
<!-- proc~calc_halflev -->
<g id="proc~~readinitfiles~~CallsGraph_node5" class="node">
<title>proc~calc_halflev</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node5"><a xlink:href=".././proc/calc_halflev.html" xlink:title="calc_halflev">
<polygon fill="#d9534f" stroke="#d9534f" points="308,-318 240,-318 240,-294 308,-294 308,-318"/>
<text text-anchor="middle" x="274" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">calc_halflev</text>
</a>
</g>
</g>
<!-- proc~readinitfiles&#45;&gt;proc~calc_halflev -->
<g id="proc~~readinitfiles~~CallsGraph_edge3" class="edge">
<title>proc~readinitfiles&#45;&gt;proc~calc_halflev</title>
<path fill="none" stroke="#ff0000" d="M67.1937,-321.4782C109.6193,-318.3029 182.6237,-312.839 229.5758,-309.3249"/>
<polygon fill="#ff0000" stroke="#ff0000" points="230.0464,-312.7995 239.7573,-308.5629 229.5239,-305.8191 230.0464,-312.7995"/>
</g>
<!-- proc~readrestartfiles -->
<g id="proc~~readinitfiles~~CallsGraph_node6" class="node">
<title>proc~readrestartfiles</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node6"><a xlink:href=".././proc/readrestartfiles.html" xlink:title="readrestartfiles">
<polygon fill="#d9534f" stroke="#d9534f" points="190.5,-150 106.5,-150 106.5,-126 190.5,-126 190.5,-150"/>
<text text-anchor="middle" x="148.5" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">readrestartfiles</text>
</a>
</g>
</g>
<!-- proc~readinitfiles&#45;&gt;proc~readrestartfiles -->
<g id="proc~~readinitfiles~~CallsGraph_edge5" class="edge">
<title>proc~readinitfiles&#45;&gt;proc~readrestartfiles</title>
<path fill="none" stroke="#ff0000" d="M41.0455,-311.796C60.3009,-280.6524 111.4391,-197.942 135.5614,-158.9268"/>
<polygon fill="#ff0000" stroke="#ff0000" points="138.7943,-160.3533 141.0762,-150.0071 132.8404,-156.6721 138.7943,-160.3533"/>
</g>
<!-- proc~readdriverfile -->
<g id="proc~~readinitfiles~~CallsGraph_node7" class="node">
<title>proc~readdriverfile</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node7"><a xlink:href=".././proc/readdriverfile.html" xlink:title="readdriverfile">
<polygon fill="#d9534f" stroke="#d9534f" points="186,-108 111,-108 111,-84 186,-84 186,-108"/>
<text text-anchor="middle" x="148.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">readdriverfile</text>
</a>
</g>
</g>
<!-- proc~readinitfiles&#45;&gt;proc~readdriverfile -->
<g id="proc~~readinitfiles~~CallsGraph_edge6" class="edge">
<title>proc~readinitfiles&#45;&gt;proc~readdriverfile</title>
<path fill="none" stroke="#ff0000" d="M34.318,-311.5941C37.2512,-276.6258 50.0959,-175.9789 103,-117 103.8823,-116.0164 104.82,-115.0756 105.8035,-114.176"/>
<polygon fill="#ff0000" stroke="#ff0000" points="108.118,-116.8176 114.0789,-108.0587 103.9569,-111.1886 108.118,-116.8176"/>
</g>
<!-- proc~thermodynamics -->
<g id="proc~~readinitfiles~~CallsGraph_node8" class="node">
<title>proc~thermodynamics</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node8"><a xlink:href=".././proc/thermodynamics.html" xlink:title="thermodynamics">
<polygon fill="#d9534f" stroke="#d9534f" points="194,-276 103,-276 103,-252 194,-252 194,-276"/>
<text text-anchor="middle" x="148.5" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">thermodynamics</text>
</a>
</g>
</g>
<!-- proc~readinitfiles&#45;&gt;proc~thermodynamics -->
<g id="proc~~readinitfiles~~CallsGraph_edge7" class="edge">
<title>proc~readinitfiles&#45;&gt;proc~thermodynamics</title>
<path fill="none" stroke="#ff0000" d="M56.772,-311.8581C73.9182,-302.9122 97.4488,-290.6354 116.3843,-280.756"/>
<polygon fill="#ff0000" stroke="#ff0000" points="118.0158,-283.8526 125.2626,-276.1238 114.7778,-277.6465 118.0158,-283.8526"/>
</g>
<!-- proc~readinletfile -->
<g id="proc~~readinitfiles~~CallsGraph_node9" class="node">
<title>proc~readinletfile</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node9"><a xlink:href=".././proc/readinletfile.html" xlink:title="readinletfile">
<polygon fill="#d9534f" stroke="#d9534f" points="451.5,-484 384.5,-484 384.5,-460 451.5,-460 451.5,-484"/>
<text text-anchor="middle" x="418" y="-469.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">readinletfile</text>
</a>
</g>
</g>
<!-- proc~readinitfiles&#45;&gt;proc~readinletfile -->
<g id="proc~~readinitfiles~~CallsGraph_edge8" class="edge">
<title>proc~readinitfiles&#45;&gt;proc~readinletfile</title>
<path fill="none" stroke="#ff0000" d="M51.5334,-336.0152C65.2501,-344.8097 84.8036,-356.6209 103,-365 152.4786,-387.784 300.0611,-435.0842 374.3134,-458.4023"/>
<polygon fill="#ff0000" stroke="#ff0000" points="373.6971,-461.877 384.2862,-461.5284 375.7909,-455.1975 373.6971,-461.877"/>
</g>
<!-- proc~slabsum -->
<g id="proc~~readinitfiles~~CallsGraph_node10" class="node">
<title>proc~slabsum</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node10"><a xlink:href=".././proc/slabsum.html" xlink:title="slabsum">
<polygon fill="#d9534f" stroke="#d9534f" points="445,-1106 391,-1106 391,-1082 445,-1082 445,-1106"/>
<text text-anchor="middle" x="418" y="-1091.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">slabsum</text>
</a>
</g>
</g>
<!-- proc~readinitfiles&#45;&gt;proc~slabsum -->
<g id="proc~~readinitfiles~~CallsGraph_edge9" class="edge">
<title>proc~readinitfiles&#45;&gt;proc~slabsum</title>
<path fill="none" stroke="#ff0000" d="M34.0278,-336.104C38.6553,-435.8022 75.8895,-1120.5982 230,-1235 261.404,-1258.3124 285.2056,-1256.3122 318,-1235 351.0328,-1213.5329 331.1761,-1186.1103 354,-1154 365.0745,-1138.4196 380.6731,-1123.6946 393.698,-1112.7313"/>
<polygon fill="#ff0000" stroke="#ff0000" points="396.2846,-1115.1375 401.8121,-1106.0988 391.8545,-1109.7177 396.2846,-1115.1375"/>
</g>
<!-- mpi_bcast -->
<g id="proc~~readinitfiles~~CallsGraph_node11" class="node">
<title>mpi_bcast</title>
<polygon fill="#777777" stroke="#777777" points="179,-66 118,-66 118,-42 179,-42 179,-66"/>
<text text-anchor="middle" x="148.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mpi_bcast</text>
</g>
<!-- proc~readinitfiles&#45;&gt;mpi_bcast -->
<g id="proc~~readinitfiles~~CallsGraph_edge10" class="edge">
<title>proc~readinitfiles&#45;&gt;mpi_bcast</title>
<path fill="none" stroke="#ff0000" d="M35.4909,-311.9398C43.0578,-267.3317 71.2141,-112.3349 103,-75 104.7272,-72.9713 106.6923,-71.1274 108.8137,-69.4532"/>
<polygon fill="#ff0000" stroke="#ff0000" points="111.0797,-72.1573 117.5976,-63.8046 107.2935,-66.2696 111.0797,-72.1573"/>
</g>
<!-- proc~boundary&#45;&gt;proc~drivergen -->
<g id="proc~~readinitfiles~~CallsGraph_edge14" class="edge">
<title>proc~boundary&#45;&gt;proc~drivergen</title>
<path fill="none" stroke="#ff0000" d="M148.7496,-806.1629C150.2422,-859.3459 160.5104,-1075.8868 230,-1235 236.2759,-1249.3701 246.6458,-1263.521 255.7425,-1274.3606"/>
<polygon fill="#ff0000" stroke="#ff0000" points="253.1521,-1276.7154 262.3618,-1281.9531 258.4285,-1272.1154 253.1521,-1276.7154"/>
</g>
<!-- proc~cyclicmj -->
<g id="proc~~readinitfiles~~CallsGraph_node13" class="node">
<title>proc~cyclicmj</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node13"><a xlink:href=".././proc/cyclicmj.html" xlink:title="cyclicmj">
<polygon fill="#d9534f" stroke="#d9534f" points="445,-442 391,-442 391,-418 445,-418 445,-442"/>
<text text-anchor="middle" x="418" y="-427.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">cyclicmj</text>
</a>
</g>
</g>
<!-- proc~boundary&#45;&gt;proc~cyclicmj -->
<g id="proc~~readinitfiles~~CallsGraph_edge11" class="edge">
<title>proc~boundary&#45;&gt;proc~cyclicmj</title>
<path fill="none" stroke="#ff0000" d="M152.2846,-781.6C161.3339,-753.8647 186.7487,-686.184 230,-647 261.5719,-618.3971 290.7645,-641.7588 318,-609 364.044,-553.6185 305.496,-504.2402 354,-451 361.0288,-443.2848 370.9356,-438.3968 380.8592,-435.3023"/>
<polygon fill="#ff0000" stroke="#ff0000" points="381.8743,-438.6551 390.6826,-432.7673 380.1252,-431.8771 381.8743,-438.6551"/>
</g>
<!-- proc~iohi -->
<g id="proc~~readinitfiles~~CallsGraph_node14" class="node">
<title>proc~iohi</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node14"><a xlink:href=".././proc/iohi.html" xlink:title="iohi">
<polygon fill="#d9534f" stroke="#d9534f" points="301,-558 247,-558 247,-534 301,-534 301,-558"/>
<text text-anchor="middle" x="274" y="-543.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">iohi</text>
</a>
</g>
</g>
<!-- proc~boundary&#45;&gt;proc~iohi -->
<g id="proc~~readinitfiles~~CallsGraph_edge12" class="edge">
<title>proc~boundary&#45;&gt;proc~iohi</title>
<path fill="none" stroke="#ff0000" d="M149.6477,-781.7622C153.7226,-744.7792 170.6059,-632.6915 230,-567 232.3416,-564.4101 235.071,-562.1096 238.0025,-560.0725"/>
<polygon fill="#ff0000" stroke="#ff0000" points="239.7871,-563.0834 246.6446,-555.0072 236.2474,-557.0443 239.7871,-563.0834"/>
</g>
<!-- proc~iolet -->
<g id="proc~~readinitfiles~~CallsGraph_node15" class="node">
<title>proc~iolet</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node15"><a xlink:href=".././proc/iolet.html" xlink:title="iolet">
<polygon fill="#d9534f" stroke="#d9534f" points="301,-890 247,-890 247,-866 301,-866 301,-890"/>
<text text-anchor="middle" x="274" y="-875.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">iolet</text>
</a>
</g>
</g>
<!-- proc~boundary&#45;&gt;proc~iolet -->
<g id="proc~~readinitfiles~~CallsGraph_edge13" class="edge">
<title>proc~boundary&#45;&gt;proc~iolet</title>
<path fill="none" stroke="#ff0000" d="M162.262,-806.1154C177.9546,-819.5699 204.7171,-841.4403 230,-857 232.5838,-858.5901 235.3067,-860.1467 238.079,-861.6479"/>
<polygon fill="#ff0000" stroke="#ff0000" points="236.4983,-864.7706 246.9925,-866.2275 239.6973,-858.5443 236.4983,-864.7706"/>
</g>
<!-- proc~cyclicqi -->
<g id="proc~~readinitfiles~~CallsGraph_node16" class="node">
<title>proc~cyclicqi</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node16"><a xlink:href=".././proc/cyclicqi.html" xlink:title="cyclicqi">
<polygon fill="#d9534f" stroke="#d9534f" points="301,-516 247,-516 247,-492 301,-492 301,-516"/>
<text text-anchor="middle" x="274" y="-501.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">cyclicqi</text>
</a>
</g>
</g>
<!-- proc~boundary&#45;&gt;proc~cyclicqi -->
<g id="proc~~readinitfiles~~CallsGraph_edge15" class="edge">
<title>proc~boundary&#45;&gt;proc~cyclicqi</title>
<path fill="none" stroke="#ff0000" d="M148.8282,-781.9212C150.5629,-740.8558 161.4665,-604.7598 230,-525 232.3324,-522.2856 235.0945,-519.895 238.0809,-517.7952"/>
<polygon fill="#ff0000" stroke="#ff0000" points="240.0585,-520.6932 246.9202,-512.6205 236.522,-514.6522 240.0585,-520.6932"/>
</g>
<!-- proc~inletgen -->
<g id="proc~~readinitfiles~~CallsGraph_node17" class="node">
<title>proc~inletgen</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node17"><a xlink:href=".././proc/inletgen.html" xlink:title="inletgen">
<polygon fill="#d9534f" stroke="#d9534f" points="301,-806 247,-806 247,-782 301,-782 301,-806"/>
<text text-anchor="middle" x="274" y="-791.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">inletgen</text>
</a>
</g>
</g>
<!-- proc~boundary&#45;&gt;proc~inletgen -->
<g id="proc~~readinitfiles~~CallsGraph_edge16" class="edge">
<title>proc~boundary&#45;&gt;proc~inletgen</title>
<path fill="none" stroke="#ff0000" d="M177.6077,-794C195.2033,-794 217.8096,-794 236.7069,-794"/>
<polygon fill="#ff0000" stroke="#ff0000" points="236.7684,-797.5001 246.7684,-794 236.7683,-790.5001 236.7684,-797.5001"/>
</g>
<!-- proc~cyclichi -->
<g id="proc~~readinitfiles~~CallsGraph_node21" class="node">
<title>proc~cyclichi</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node21"><a xlink:href=".././proc/cyclichi.html" xlink:title="cyclichi">
<polygon fill="#d9534f" stroke="#d9534f" points="301,-474 247,-474 247,-450 301,-450 301,-474"/>
<text text-anchor="middle" x="274" y="-459.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">cyclichi</text>
</a>
</g>
</g>
<!-- proc~boundary&#45;&gt;proc~cyclichi -->
<g id="proc~~readinitfiles~~CallsGraph_edge17" class="edge">
<title>proc~boundary&#45;&gt;proc~cyclichi</title>
<path fill="none" stroke="#ff0000" d="M150.2888,-781.8754C158.0785,-730.4558 190.431,-530.8556 230,-483 232.2805,-480.2419 235.008,-477.822 237.9725,-475.7039"/>
<polygon fill="#ff0000" stroke="#ff0000" points="239.9493,-478.6013 246.7809,-470.5031 236.3903,-472.5735 239.9493,-478.6013"/>
</g>
<!-- proc~iosi -->
<g id="proc~~readinitfiles~~CallsGraph_node23" class="node">
<title>proc~iosi</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node23"><a xlink:href=".././proc/iosi.html" xlink:title="iosi">
<polygon fill="#d9534f" stroke="#d9534f" points="301,-1184 247,-1184 247,-1160 301,-1160 301,-1184"/>
<text text-anchor="middle" x="274" y="-1169.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">iosi</text>
</a>
</g>
</g>
<!-- proc~boundary&#45;&gt;proc~iosi -->
<g id="proc~~readinitfiles~~CallsGraph_edge18" class="edge">
<title>proc~boundary&#45;&gt;proc~iosi</title>
<path fill="none" stroke="#ff0000" d="M149.8728,-806.3547C156.3489,-862.7395 185.408,-1095.2862 230,-1151 232.2363,-1153.7941 234.9342,-1156.2381 237.8801,-1158.3713"/>
<polygon fill="#ff0000" stroke="#ff0000" points="236.278,-1161.4907 246.6621,-1163.5936 239.8558,-1155.4741 236.278,-1161.4907"/>
</g>
<!-- proc~inletgennotemp -->
<g id="proc~~readinitfiles~~CallsGraph_node25" class="node">
<title>proc~inletgennotemp</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node25"><a xlink:href=".././proc/inletgennotemp.html" xlink:title="inletgennotemp">
<polygon fill="#d9534f" stroke="#d9534f" points="317,-848 231,-848 231,-824 317,-824 317,-848"/>
<text text-anchor="middle" x="274" y="-833.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">inletgennotemp</text>
</a>
</g>
</g>
<!-- proc~boundary&#45;&gt;proc~inletgennotemp -->
<g id="proc~~readinitfiles~~CallsGraph_edge19" class="edge">
<title>proc~boundary&#45;&gt;proc~inletgennotemp</title>
<path fill="none" stroke="#ff0000" d="M177.6077,-803.7412C192.6192,-808.765 211.2777,-815.0093 228.1686,-820.662"/>
<polygon fill="#ff0000" stroke="#ff0000" points="227.2747,-824.0536 237.8686,-823.9082 229.4963,-817.4155 227.2747,-824.0536"/>
</g>
<!-- proc~fluxtopscal -->
<g id="proc~~readinitfiles~~CallsGraph_node26" class="node">
<title>proc~fluxtopscal</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node26"><a xlink:href=".././proc/fluxtopscal.html" xlink:title="fluxtopscal">
<polygon fill="#d9534f" stroke="#d9534f" points="305.5,-1142 242.5,-1142 242.5,-1118 305.5,-1118 305.5,-1142"/>
<text text-anchor="middle" x="274" y="-1127.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">fluxtopscal</text>
</a>
</g>
</g>
<!-- proc~boundary&#45;&gt;proc~fluxtopscal -->
<g id="proc~~readinitfiles~~CallsGraph_edge20" class="edge">
<title>proc~boundary&#45;&gt;proc~fluxtopscal</title>
<path fill="none" stroke="#ff0000" d="M150.2682,-806.2793C157.9736,-858.3555 190.0301,-1060.5059 230,-1109 231.1474,-1110.3921 232.4086,-1111.6979 233.7569,-1112.9222"/>
<polygon fill="#ff0000" stroke="#ff0000" points="232.0925,-1116.0386 242.2428,-1119.0755 236.2018,-1110.3716 232.0925,-1116.0386"/>
</g>
<!-- proc~cyclicsi -->
<g id="proc~~readinitfiles~~CallsGraph_node28" class="node">
<title>proc~cyclicsi</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node28"><a xlink:href=".././proc/cyclicsi.html" xlink:title="cyclicsi">
<polygon fill="#d9534f" stroke="#d9534f" points="301,-1100 247,-1100 247,-1076 301,-1076 301,-1100"/>
<text text-anchor="middle" x="274" y="-1085.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">cyclicsi</text>
</a>
</g>
</g>
<!-- proc~boundary&#45;&gt;proc~cyclicsi -->
<g id="proc~~readinitfiles~~CallsGraph_edge21" class="edge">
<title>proc~boundary&#45;&gt;proc~cyclicsi</title>
<path fill="none" stroke="#ff0000" d="M150.7831,-806.2251C159.861,-853.7558 194.625,-1025.6604 230,-1067 232.3268,-1069.7192 235.0853,-1072.113 238.0693,-1074.2147"/>
<polygon fill="#ff0000" stroke="#ff0000" points="236.5079,-1077.3564 246.9054,-1079.3922 240.0469,-1071.3168 236.5079,-1077.3564"/>
</g>
<!-- proc~cyclicqj -->
<g id="proc~~readinitfiles~~CallsGraph_node29" class="node">
<title>proc~cyclicqj</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node29"><a xlink:href=".././proc/cyclicqj.html" xlink:title="cyclicqj">
<polygon fill="#d9534f" stroke="#d9534f" points="445,-400 391,-400 391,-376 445,-376 445,-400"/>
<text text-anchor="middle" x="418" y="-385.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">cyclicqj</text>
</a>
</g>
</g>
<!-- proc~boundary&#45;&gt;proc~cyclicqj -->
<g id="proc~~readinitfiles~~CallsGraph_edge22" class="edge">
<title>proc~boundary&#45;&gt;proc~cyclicqj</title>
<path fill="none" stroke="#ff0000" d="M149.6481,-781.9779C155.2191,-726.0884 181.1779,-492.2176 230,-441 269.3651,-399.7034 338.1875,-389.7957 380.7467,-387.8558"/>
<polygon fill="#ff0000" stroke="#ff0000" points="381.0874,-391.3466 390.967,-387.52 380.8575,-384.3504 381.0874,-391.3466"/>
</g>
<!-- proc~valuetop -->
<g id="proc~~readinitfiles~~CallsGraph_node30" class="node">
<title>proc~valuetop</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node30"><a xlink:href=".././proc/valuetop.html" xlink:title="valuetop">
<polygon fill="#d9534f" stroke="#d9534f" points="301,-1058 247,-1058 247,-1034 301,-1034 301,-1058"/>
<text text-anchor="middle" x="274" y="-1043.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">valuetop</text>
</a>
</g>
</g>
<!-- proc~boundary&#45;&gt;proc~valuetop -->
<g id="proc~~readinitfiles~~CallsGraph_edge23" class="edge">
<title>proc~boundary&#45;&gt;proc~valuetop</title>
<path fill="none" stroke="#ff0000" d="M149.553,-806.1847C153.3868,-843.5365 169.72,-957.9578 230,-1025 232.3345,-1027.5964 235.059,-1029.9012 237.9874,-1031.9411"/>
<polygon fill="#ff0000" stroke="#ff0000" points="236.2289,-1034.9674 246.6249,-1037.0106 239.7721,-1028.9303 236.2289,-1034.9674"/>
</g>
<!-- proc~inlettop -->
<g id="proc~~readinitfiles~~CallsGraph_node31" class="node">
<title>proc~inlettop</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node31"><a xlink:href=".././proc/inlettop.html" xlink:title="inlettop">
<polygon fill="#d9534f" stroke="#d9534f" points="301,-1226 247,-1226 247,-1202 301,-1202 301,-1226"/>
<text text-anchor="middle" x="274" y="-1211.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">inlettop</text>
</a>
</g>
</g>
<!-- proc~boundary&#45;&gt;proc~inlettop -->
<g id="proc~~readinitfiles~~CallsGraph_edge24" class="edge">
<title>proc~boundary&#45;&gt;proc~inlettop</title>
<path fill="none" stroke="#ff0000" d="M149.5328,-806.1608C154.836,-866.1203 180.6877,-1129.9179 230,-1193 232.2041,-1195.8196 234.8804,-1198.2806 237.8127,-1200.4246"/>
<polygon fill="#ff0000" stroke="#ff0000" points="236.1961,-1203.5359 246.5755,-1205.6621 239.7875,-1197.5273 236.1961,-1203.5359"/>
</g>
<!-- proc~cyclicmi -->
<g id="proc~~readinitfiles~~CallsGraph_node32" class="node">
<title>proc~cyclicmi</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node32"><a xlink:href=".././proc/cyclicmi.html" xlink:title="cyclicmi">
<polygon fill="#d9534f" stroke="#d9534f" points="301,-1016 247,-1016 247,-992 301,-992 301,-1016"/>
<text text-anchor="middle" x="274" y="-1001.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">cyclicmi</text>
</a>
</g>
</g>
<!-- proc~boundary&#45;&gt;proc~cyclicmi -->
<g id="proc~~readinitfiles~~CallsGraph_edge25" class="edge">
<title>proc~boundary&#45;&gt;proc~cyclicmi</title>
<path fill="none" stroke="#ff0000" d="M150.6767,-806.2649C157.0769,-839.0265 178.7047,-929.7081 230,-983 232.4213,-985.5156 235.2047,-987.7657 238.1707,-989.7706"/>
<polygon fill="#ff0000" stroke="#ff0000" points="236.4532,-992.8204 246.8637,-994.7884 239.9527,-986.7579 236.4532,-992.8204"/>
</g>
<!-- proc~scalrec -->
<g id="proc~~readinitfiles~~CallsGraph_node34" class="node">
<title>proc~scalrec</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node34"><a xlink:href=".././proc/scalrec.html" xlink:title="scalrec">
<polygon fill="#d9534f" stroke="#d9534f" points="301,-974 247,-974 247,-950 301,-950 301,-974"/>
<text text-anchor="middle" x="274" y="-959.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">scalrec</text>
</a>
</g>
</g>
<!-- proc~boundary&#45;&gt;proc~scalrec -->
<g id="proc~~readinitfiles~~CallsGraph_edge26" class="edge">
<title>proc~boundary&#45;&gt;proc~scalrec</title>
<path fill="none" stroke="#ff0000" d="M152.3916,-806.2841C161.6601,-833.782 187.4943,-901.0084 230,-941 232.4042,-943.262 235.0971,-945.3222 237.9349,-947.1896"/>
<polygon fill="#ff0000" stroke="#ff0000" points="236.3205,-950.2982 246.7391,-952.2222 239.7943,-944.221 236.3205,-950.2982"/>
</g>
<!-- proc~fluxtop -->
<g id="proc~~readinitfiles~~CallsGraph_node35" class="node">
<title>proc~fluxtop</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node35"><a xlink:href=".././proc/fluxtop.html" xlink:title="fluxtop">
<polygon fill="#d9534f" stroke="#d9534f" points="301,-932 247,-932 247,-908 301,-908 301,-932"/>
<text text-anchor="middle" x="274" y="-917.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">fluxtop</text>
</a>
</g>
</g>
<!-- proc~boundary&#45;&gt;proc~fluxtop -->
<g id="proc~~readinitfiles~~CallsGraph_edge27" class="edge">
<title>proc~boundary&#45;&gt;proc~fluxtop</title>
<path fill="none" stroke="#ff0000" d="M155.3455,-806.1902C167.798,-827.4492 196.0329,-871.6431 230,-899 232.4267,-900.9545 235.0654,-902.7811 237.8048,-904.4762"/>
<polygon fill="#ff0000" stroke="#ff0000" points="236.3184,-907.6539 246.7619,-909.4382 239.7105,-901.5307 236.3184,-907.6539"/>
</g>
<!-- proc~valuetopscal -->
<g id="proc~~readinitfiles~~CallsGraph_node37" class="node">
<title>proc~valuetopscal</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node37"><a xlink:href=".././proc/valuetopscal.html" xlink:title="valuetopscal">
<polygon fill="#d9534f" stroke="#d9534f" points="310,-764 238,-764 238,-740 310,-740 310,-764"/>
<text text-anchor="middle" x="274" y="-749.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">valuetopscal</text>
</a>
</g>
</g>
<!-- proc~boundary&#45;&gt;proc~valuetopscal -->
<g id="proc~~readinitfiles~~CallsGraph_edge28" class="edge">
<title>proc~boundary&#45;&gt;proc~valuetopscal</title>
<path fill="none" stroke="#ff0000" d="M177.6077,-784.2588C192.6192,-779.235 211.2777,-772.9907 228.1686,-767.338"/>
<polygon fill="#ff0000" stroke="#ff0000" points="229.4963,-770.5845 237.8686,-764.0918 227.2747,-763.9464 229.4963,-770.5845"/>
</g>
<!-- proc~cyclicsj -->
<g id="proc~~readinitfiles~~CallsGraph_node38" class="node">
<title>proc~cyclicsj</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node38"><a xlink:href=".././proc/cyclicsj.html" xlink:title="cyclicsj">
<polygon fill="#d9534f" stroke="#d9534f" points="301,-722 247,-722 247,-698 301,-698 301,-722"/>
<text text-anchor="middle" x="274" y="-707.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">cyclicsj</text>
</a>
</g>
</g>
<!-- proc~boundary&#45;&gt;proc~cyclicsj -->
<g id="proc~~readinitfiles~~CallsGraph_edge29" class="edge">
<title>proc~boundary&#45;&gt;proc~cyclicsj</title>
<path fill="none" stroke="#ff0000" d="M162.262,-781.8846C177.9546,-768.4301 204.7171,-746.5597 230,-731 232.5838,-729.4099 235.3067,-727.8533 238.079,-726.3521"/>
<polygon fill="#ff0000" stroke="#ff0000" points="239.6973,-729.4557 246.9925,-721.7725 236.4983,-723.2294 239.6973,-729.4557"/>
</g>
<!-- proc~cyclichj -->
<g id="proc~~readinitfiles~~CallsGraph_node39" class="node">
<title>proc~cyclichj</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node39"><a xlink:href=".././proc/cyclichj.html" xlink:title="cyclichj">
<polygon fill="#d9534f" stroke="#d9534f" points="445,-358 391,-358 391,-334 445,-334 445,-358"/>
<text text-anchor="middle" x="418" y="-343.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">cyclichj</text>
</a>
</g>
</g>
<!-- proc~boundary&#45;&gt;proc~cyclichj -->
<g id="proc~~readinitfiles~~CallsGraph_edge30" class="edge">
<title>proc~boundary&#45;&gt;proc~cyclichj</title>
<path fill="none" stroke="#ff0000" d="M149.2448,-781.9363C153.2316,-721.2851 174.0007,-450.2818 230,-392 269.1681,-351.2354 338.0524,-344.1837 380.6772,-344.1395"/>
<polygon fill="#ff0000" stroke="#ff0000" points="380.8727,-347.642 390.9142,-344.263 380.9572,-340.6426 380.8727,-347.642"/>
</g>
<!-- proc~ioqi -->
<g id="proc~~readinitfiles~~CallsGraph_node40" class="node">
<title>proc~ioqi</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node40"><a xlink:href=".././proc/ioqi.html" xlink:title="ioqi">
<polygon fill="#d9534f" stroke="#d9534f" points="301,-680 247,-680 247,-656 301,-656 301,-680"/>
<text text-anchor="middle" x="274" y="-665.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ioqi</text>
</a>
</g>
</g>
<!-- proc~boundary&#45;&gt;proc~ioqi -->
<g id="proc~~readinitfiles~~CallsGraph_edge31" class="edge">
<title>proc~boundary&#45;&gt;proc~ioqi</title>
<path fill="none" stroke="#ff0000" d="M155.3455,-781.8098C167.798,-760.5508 196.0329,-716.3569 230,-689 232.4267,-687.0455 235.0654,-685.2189 237.8048,-683.5238"/>
<polygon fill="#ff0000" stroke="#ff0000" points="239.7105,-686.4693 246.7619,-678.5618 236.3184,-680.3461 239.7105,-686.4693"/>
</g>
<!-- proc~scalsirane -->
<g id="proc~~readinitfiles~~CallsGraph_node43" class="node">
<title>proc~scalsirane</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node43"><a xlink:href=".././proc/scalsirane.html" xlink:title="scalSIRANE">
<polygon fill="#d9534f" stroke="#d9534f" points="309,-600 239,-600 239,-576 309,-576 309,-600"/>
<text text-anchor="middle" x="274" y="-585.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">scalSIRANE</text>
</a>
</g>
</g>
<!-- proc~boundary&#45;&gt;proc~scalsirane -->
<g id="proc~~readinitfiles~~CallsGraph_edge32" class="edge">
<title>proc~boundary&#45;&gt;proc~scalsirane</title>
<path fill="none" stroke="#ff0000" d="M151.3243,-781.6479C159.0293,-750.2834 183.0447,-666.3503 230,-614 232.6568,-611.038 235.7329,-608.3159 238.9999,-605.8405"/>
<polygon fill="#ff0000" stroke="#ff0000" points="241.041,-608.6858 247.3841,-600.1996 237.1334,-602.8779 241.041,-608.6858"/>
</g>
<!-- proc~writedriverfile -->
<g id="proc~~readinitfiles~~CallsGraph_node42" class="node">
<title>proc~writedriverfile</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node42"><a xlink:href=".././proc/writedriverfile.html" xlink:title="writedriverfile">
<polygon fill="#d9534f" stroke="#d9534f" points="456,-1306 380,-1306 380,-1282 456,-1282 456,-1306"/>
<text text-anchor="middle" x="418" y="-1291.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">writedriverfile</text>
</a>
</g>
</g>
<!-- proc~drivergen&#45;&gt;proc~writedriverfile -->
<g id="proc~~readinitfiles~~CallsGraph_edge33" class="edge">
<title>proc~drivergen&#45;&gt;proc~writedriverfile</title>
<path fill="none" stroke="#cbff00" d="M303.1405,-1294C322.2251,-1294 347.6262,-1294 369.6879,-1294"/>
<polygon fill="#cbff00" stroke="#cbff00" points="369.8801,-1297.5001 379.8801,-1294 369.8801,-1290.5001 369.8801,-1297.5001"/>
</g>
<!-- proc~zinterpolate2d -->
<g id="proc~~readinitfiles~~CallsGraph_node12" class="node">
<title>proc~zinterpolate2d</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node12"><a xlink:href=".././proc/zinterpolate2d.html" xlink:title="zinterpolate2d">
<polygon fill="#d9534f" stroke="#d9534f" points="314,-150 234,-150 234,-126 314,-126 314,-150"/>
<text text-anchor="middle" x="274" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">zinterpolate2d</text>
</a>
</g>
</g>
<!-- proc~readrestartfiles&#45;&gt;proc~zinterpolate2d -->
<g id="proc~~readinitfiles~~CallsGraph_edge34" class="edge">
<title>proc~readrestartfiles&#45;&gt;proc~zinterpolate2d</title>
<path fill="none" stroke="#00ff66" d="M190.6388,-138C201.2156,-138 212.6712,-138 223.6057,-138"/>
<polygon fill="#00ff66" stroke="#00ff66" points="223.8839,-141.5001 233.8839,-138 223.8839,-134.5001 223.8839,-141.5001"/>
</g>
<!-- proc~zinterpolatew1d -->
<g id="proc~~readinitfiles~~CallsGraph_node22" class="node">
<title>proc~zinterpolatew1d</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node22"><a xlink:href=".././proc/zinterpolatew1d.html" xlink:title="zinterpolatew1d">
<polygon fill="#d9534f" stroke="#d9534f" points="318,-108 230,-108 230,-84 318,-84 318,-108"/>
<text text-anchor="middle" x="274" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">zinterpolatew1d</text>
</a>
</g>
</g>
<!-- proc~readrestartfiles&#45;&gt;proc~zinterpolatew1d -->
<g id="proc~~readinitfiles~~CallsGraph_edge37" class="edge">
<title>proc~readrestartfiles&#45;&gt;proc~zinterpolatew1d</title>
<path fill="none" stroke="#00ff66" d="M184.4633,-125.9645C198.1166,-121.3952 213.8529,-116.1289 228.2877,-111.2981"/>
<polygon fill="#00ff66" stroke="#00ff66" points="229.6592,-114.53 238.0315,-108.0373 227.4376,-107.8919 229.6592,-114.53"/>
</g>
<!-- proc~zinterpolate1d -->
<g id="proc~~readinitfiles~~CallsGraph_node33" class="node">
<title>proc~zinterpolate1d</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node33"><a xlink:href=".././proc/zinterpolate1d.html" xlink:title="zinterpolate1d">
<polygon fill="#d9534f" stroke="#d9534f" points="314,-66 234,-66 234,-42 314,-42 314,-66"/>
<text text-anchor="middle" x="274" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">zinterpolate1d</text>
</a>
</g>
</g>
<!-- proc~readrestartfiles&#45;&gt;proc~zinterpolate1d -->
<g id="proc~~readinitfiles~~CallsGraph_edge36" class="edge">
<title>proc~readrestartfiles&#45;&gt;proc~zinterpolate1d</title>
<path fill="none" stroke="#00ff66" d="M179.3952,-125.9473C184.4936,-123.349 189.5583,-120.3577 194,-117 213.6123,-102.1743 210.4836,-89.9518 230,-75 231.6126,-73.7646 233.3095,-72.5762 235.0609,-71.437"/>
<polygon fill="#00ff66" stroke="#00ff66" points="237.2484,-74.2136 244.1317,-66.1593 233.728,-68.1631 237.2484,-74.2136"/>
</g>
<!-- proc~zinterpolatet1d -->
<g id="proc~~readinitfiles~~CallsGraph_node41" class="node">
<title>proc~zinterpolatet1d</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node41"><a xlink:href=".././proc/zinterpolatet1d.html" xlink:title="zinterpolatet1d">
<polygon fill="#d9534f" stroke="#d9534f" points="315.5,-24 232.5,-24 232.5,0 315.5,0 315.5,-24"/>
<text text-anchor="middle" x="274" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">zinterpolatet1d</text>
</a>
</g>
</g>
<!-- proc~readrestartfiles&#45;&gt;proc~zinterpolatet1d -->
<g id="proc~~readinitfiles~~CallsGraph_edge35" class="edge">
<title>proc~readrestartfiles&#45;&gt;proc~zinterpolatet1d</title>
<path fill="none" stroke="#00ff66" d="M182.2001,-125.9693C186.5144,-123.4613 190.6027,-120.4921 194,-117 222.323,-87.8867 201.8652,-62.2953 230,-33 230.9234,-32.0385 231.8998,-31.1158 232.919,-30.2308"/>
<polygon fill="#00ff66" stroke="#00ff66" points="235.306,-32.8269 241.4072,-24.1651 231.2361,-27.1316 235.306,-32.8269"/>
</g>
<!-- proc~thermodynamics&#45;&gt;proc~calc_halflev -->
<g id="proc~~readinitfiles~~CallsGraph_edge40" class="edge">
<title>proc~thermodynamics&#45;&gt;proc~calc_halflev</title>
<path fill="none" stroke="#0066ff" d="M184.4633,-276.0355C198.7232,-280.8078 215.2553,-286.3404 230.2037,-291.3431"/>
<polygon fill="#0066ff" stroke="#0066ff" points="229.1646,-294.6861 239.7584,-294.5407 231.3861,-288.0479 229.1646,-294.6861"/>
</g>
<!-- proc~calthv -->
<g id="proc~~readinitfiles~~CallsGraph_node19" class="node">
<title>proc~calthv</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node19"><a xlink:href=".././proc/calthv.html" xlink:title="calthv">
<polygon fill="#d9534f" stroke="#d9534f" points="301,-234 247,-234 247,-210 301,-210 301,-234"/>
<text text-anchor="middle" x="274" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">calthv</text>
</a>
</g>
</g>
<!-- proc~thermodynamics&#45;&gt;proc~calthv -->
<g id="proc~~readinitfiles~~CallsGraph_edge39" class="edge">
<title>proc~thermodynamics&#45;&gt;proc~calthv</title>
<path fill="none" stroke="#0066ff" d="M184.4633,-251.9645C200.8985,-246.4643 220.3518,-239.954 236.9201,-234.4092"/>
<polygon fill="#0066ff" stroke="#0066ff" points="238.4384,-237.592 246.8106,-231.0992 236.2168,-230.9538 238.4384,-237.592"/>
</g>
<!-- proc~diagfld -->
<g id="proc~~readinitfiles~~CallsGraph_node24" class="node">
<title>proc~diagfld</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node24"><a xlink:href=".././proc/diagfld.html" xlink:title="diagfld">
<polygon fill="#d9534f" stroke="#d9534f" points="301,-192 247,-192 247,-168 301,-168 301,-192"/>
<text text-anchor="middle" x="274" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">diagfld</text>
</a>
</g>
</g>
<!-- proc~thermodynamics&#45;&gt;proc~diagfld -->
<g id="proc~~readinitfiles~~CallsGraph_edge41" class="edge">
<title>proc~thermodynamics&#45;&gt;proc~diagfld</title>
<path fill="none" stroke="#0066ff" d="M162.262,-251.8846C177.9546,-238.4301 204.7171,-216.5597 230,-201 232.5838,-199.4099 235.3067,-197.8533 238.079,-196.3521"/>
<polygon fill="#0066ff" stroke="#0066ff" points="239.6973,-199.4557 246.9925,-191.7725 236.4983,-193.2294 239.6973,-199.4557"/>
</g>
<!-- proc~thermo -->
<g id="proc~~readinitfiles~~CallsGraph_node27" class="node">
<title>proc~thermo</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node27"><a xlink:href=".././proc/thermo.html" xlink:title="thermo">
<polygon fill="#d9534f" stroke="#d9534f" points="301,-276 247,-276 247,-252 301,-252 301,-276"/>
<text text-anchor="middle" x="274" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">thermo</text>
</a>
</g>
</g>
<!-- proc~thermodynamics&#45;&gt;proc~thermo -->
<g id="proc~~readinitfiles~~CallsGraph_edge38" class="edge">
<title>proc~thermodynamics&#45;&gt;proc~thermo</title>
<path fill="none" stroke="#0066ff" d="M194.1634,-264C208.0994,-264 223.2525,-264 236.5753,-264"/>
<polygon fill="#0066ff" stroke="#0066ff" points="236.8095,-267.5001 246.8094,-264 236.8094,-260.5001 236.8095,-267.5001"/>
</g>
<!-- proc~yinterpolate -->
<g id="proc~~readinitfiles~~CallsGraph_node18" class="node">
<title>proc~yinterpolate</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node18"><a xlink:href=".././proc/yinterpolate.html" xlink:title="yinterpolate">
<polygon fill="#d9534f" stroke="#d9534f" points="591.5,-484 523.5,-484 523.5,-460 591.5,-460 591.5,-484"/>
<text text-anchor="middle" x="557.5" y="-469.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">yinterpolate</text>
</a>
</g>
</g>
<!-- proc~readinletfile&#45;&gt;proc~yinterpolate -->
<g id="proc~~readinitfiles~~CallsGraph_edge43" class="edge">
<title>proc~readinletfile&#45;&gt;proc~yinterpolate</title>
<path fill="none" stroke="#3200ff" d="M451.7691,-472C470.1716,-472 493.1757,-472 513.0229,-472"/>
<polygon fill="#3200ff" stroke="#3200ff" points="513.0728,-475.5001 523.0728,-472 513.0728,-468.5001 513.0728,-475.5001"/>
</g>
<!-- proc~excjs -->
<g id="proc~~readinitfiles~~CallsGraph_node36" class="node">
<title>proc~excjs</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node36"><a xlink:href=".././proc/excjs.html" xlink:title="excjs">
<polygon fill="#d9534f" stroke="#d9534f" points="584.5,-421 530.5,-421 530.5,-397 584.5,-397 584.5,-421"/>
<text text-anchor="middle" x="557.5" y="-406.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">excjs</text>
</a>
</g>
</g>
<!-- proc~readinletfile&#45;&gt;proc~excjs -->
<g id="proc~~readinitfiles~~CallsGraph_edge42" class="edge">
<title>proc~readinletfile&#45;&gt;proc~excjs</title>
<path fill="none" stroke="#3200ff" d="M451.6683,-462.2822C461.5849,-459.0657 472.3576,-455.2179 482,-451 498.2328,-443.8992 515.5601,-434.409 529.5157,-426.2463"/>
<polygon fill="#3200ff" stroke="#3200ff" points="531.3458,-429.2301 538.1542,-421.1124 527.7696,-423.2126 531.3458,-429.2301"/>
</g>
<!-- mpi_allreduce -->
<g id="proc~~readinitfiles~~CallsGraph_node20" class="node">
<title>mpi_allreduce</title>
<polygon fill="#777777" stroke="#777777" points="597,-1146 518,-1146 518,-1122 597,-1122 597,-1146"/>
<text text-anchor="middle" x="557.5" y="-1131.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mpi_allreduce</text>
</g>
<!-- proc~slabsum&#45;&gt;mpi_allreduce -->
<g id="proc~~readinitfiles~~CallsGraph_edge44" class="edge">
<title>proc~slabsum&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#cc00ff" d="M445.2282,-1101.8074C463.0938,-1106.9301 486.9779,-1113.7786 508.1236,-1119.8419"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="507.352,-1123.2616 517.9293,-1122.6536 509.2814,-1116.5328 507.352,-1123.2616"/>
</g>
<!-- proc~cyclicmj&#45;&gt;proc~excjs -->
<g id="proc~~readinitfiles~~CallsGraph_edge45" class="edge">
<title>proc~cyclicmj&#45;&gt;proc~excjs</title>
<path fill="none" stroke="#ff2f00" d="M445.2282,-425.9011C466.6399,-422.6779 496.6965,-418.1532 520.3229,-414.5965"/>
<polygon fill="#ff2f00" stroke="#ff2f00" points="520.973,-418.0382 530.3405,-413.0885 519.9309,-411.1162 520.973,-418.0382"/>
</g>
<!-- proc~iolet&#45;&gt;proc~slabsum -->
<g id="proc~~readinitfiles~~CallsGraph_edge46" class="edge">
<title>proc~iolet&#45;&gt;proc~slabsum</title>
<path fill="none" stroke="#ff8f00" d="M301.3928,-886.3628C307.6437,-889.4365 313.7025,-893.5497 318,-899 365.5502,-959.3047 304.6795,-1009.1343 354,-1068 361.0042,-1076.3597 371.1081,-1082.0611 381.2256,-1085.9379"/>
<polygon fill="#ff8f00" stroke="#ff8f00" points="380.2361,-1089.2971 390.8295,-1089.1229 382.4396,-1082.6529 380.2361,-1089.2971"/>
</g>
<!-- proc~inletgen&#45;&gt;proc~readinletfile -->
<g id="proc~~readinitfiles~~CallsGraph_edge58" class="edge">
<title>proc~inletgen&#45;&gt;proc~readinletfile</title>
<path fill="none" stroke="#ffef00" d="M301.2501,-786.0983C307.6596,-782.9996 313.8302,-778.759 318,-773 391.5826,-671.3731 274.0565,-589.703 354,-493 359.3501,-486.5283 366.734,-482.0349 374.5899,-478.9192"/>
<polygon fill="#ffef00" stroke="#ffef00" points="375.8737,-482.1822 384.3014,-475.7617 373.7092,-475.5253 375.8737,-482.1822"/>
</g>
<!-- proc~inletgen&#45;&gt;proc~slabsum -->
<g id="proc~~readinitfiles~~CallsGraph_edge59" class="edge">
<title>proc~inletgen&#45;&gt;proc~slabsum</title>
<path fill="none" stroke="#ffef00" d="M301.117,-801.9998C307.5276,-805.0977 313.732,-809.3135 318,-815 377.4743,-894.242 307.0121,-947.7725 354,-1035 362.7011,-1051.1526 377.5434,-1065.2542 390.745,-1075.6172"/>
<polygon fill="#ffef00" stroke="#ffef00" points="388.999,-1078.6821 399.1025,-1081.8714 393.1931,-1073.0777 388.999,-1078.6821"/>
</g>
<!-- proc~enthalpythickness -->
<g id="proc~~readinitfiles~~CallsGraph_node44" class="node">
<title>proc~enthalpythickness</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node44"><a xlink:href=".././proc/enthalpythickness.html" xlink:title="enthalpythickness">
<polygon fill="#d9534f" stroke="#d9534f" points="466.5,-610 369.5,-610 369.5,-586 466.5,-586 466.5,-610"/>
<text text-anchor="middle" x="418" y="-595.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">enthalpythickness</text>
</a>
</g>
</g>
<!-- proc~inletgen&#45;&gt;proc~enthalpythickness -->
<g id="proc~~readinitfiles~~CallsGraph_edge47" class="edge">
<title>proc~inletgen&#45;&gt;proc~enthalpythickness</title>
<path fill="none" stroke="#ffef00" d="M301.3184,-785.5779C307.5707,-782.5055 313.6488,-778.4075 318,-773 362.0647,-718.2374 306.5168,-670.8265 354,-619 355.9996,-616.8175 358.2295,-614.8613 360.6246,-613.1079"/>
<polygon fill="#ffef00" stroke="#ffef00" points="362.5372,-616.042 369.3096,-607.8942 358.9344,-610.0404 362.5372,-616.042"/>
</g>
<!-- trec -->
<g id="proc~~readinitfiles~~CallsGraph_node46" class="node">
<title>trec</title>
<polygon fill="#777777" stroke="#777777" points="445,-568 391,-568 391,-544 445,-544 445,-568"/>
<text text-anchor="middle" x="418" y="-553.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">trec</text>
</g>
<!-- proc~inletgen&#45;&gt;trec -->
<g id="proc~~readinitfiles~~CallsGraph_edge48" class="edge">
<title>proc~inletgen&#45;&gt;trec</title>
<path fill="none" stroke="#ffef00" d="M301.0424,-785.9436C307.4536,-782.8461 313.6769,-778.6448 318,-773 371.8519,-702.6841 295.7531,-643.7206 354,-577 360.9215,-569.0716 370.8865,-564.1223 380.8995,-561.0374"/>
<polygon fill="#ffef00" stroke="#ffef00" points="381.979,-564.3747 390.8176,-558.5327 380.265,-557.5878 381.979,-564.3747"/>
</g>
<!-- wrec -->
<g id="proc~~readinitfiles~~CallsGraph_node47" class="node">
<title>wrec</title>
<polygon fill="#777777" stroke="#777777" points="445,-942 391,-942 391,-918 445,-918 445,-942"/>
<text text-anchor="middle" x="418" y="-927.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">wrec</text>
</g>
<!-- proc~inletgen&#45;&gt;wrec -->
<g id="proc~~readinitfiles~~CallsGraph_edge49" class="edge">
<title>proc~inletgen&#45;&gt;wrec</title>
<path fill="none" stroke="#ffef00" d="M301.2808,-803.0753C307.3864,-806.1089 313.4061,-810.0252 318,-815 348.3507,-847.8666 321.6056,-878.1457 354,-909 361.4939,-916.1376 371.4552,-920.85 381.2823,-923.9609"/>
<polygon fill="#ffef00" stroke="#ffef00" points="380.4022,-927.3485 390.9682,-926.5685 382.2219,-920.5892 380.4022,-927.3485"/>
</g>
<!-- uinl -->
<g id="proc~~readinitfiles~~CallsGraph_node48" class="node">
<title>uinl</title>
<polygon fill="#777777" stroke="#777777" points="445,-900 391,-900 391,-876 445,-876 445,-900"/>
<text text-anchor="middle" x="418" y="-885.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">uinl</text>
</g>
<!-- proc~inletgen&#45;&gt;uinl -->
<g id="proc~~readinitfiles~~CallsGraph_edge50" class="edge">
<title>proc~inletgen&#45;&gt;uinl</title>
<path fill="none" stroke="#ffef00" d="M301.4039,-804.3616C307.234,-807.285 313.1018,-810.8299 318,-815 339.4032,-833.2216 331.4732,-850.1874 354,-867 361.9988,-872.9698 371.7781,-877.2933 381.2615,-880.4045"/>
<polygon fill="#ffef00" stroke="#ffef00" points="380.3702,-883.7903 390.95,-883.2262 382.3276,-877.0695 380.3702,-883.7903"/>
</g>
<!-- urec -->
<g id="proc~~readinitfiles~~CallsGraph_node49" class="node">
<title>urec</title>
<polygon fill="#777777" stroke="#777777" points="445,-858 391,-858 391,-834 445,-834 445,-858"/>
<text text-anchor="middle" x="418" y="-843.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">urec</text>
</g>
<!-- proc~inletgen&#45;&gt;urec -->
<g id="proc~~readinitfiles~~CallsGraph_edge51" class="edge">
<title>proc~inletgen&#45;&gt;urec</title>
<path fill="none" stroke="#ffef00" d="M301.2657,-804.9752C316.6716,-811.0731 336.3276,-818.6815 354,-825 362.7205,-828.1179 372.1704,-831.3164 381.0638,-834.2473"/>
<polygon fill="#ffef00" stroke="#ffef00" points="380.2074,-837.6494 390.7998,-837.4241 382.3788,-830.9947 380.2074,-837.6494"/>
</g>
<!-- ttav -->
<g id="proc~~readinitfiles~~CallsGraph_node51" class="node">
<title>ttav</title>
<polygon fill="#777777" stroke="#777777" points="445,-526 391,-526 391,-502 445,-502 445,-526"/>
<text text-anchor="middle" x="418" y="-511.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ttav</text>
</g>
<!-- proc~inletgen&#45;&gt;ttav -->
<g id="proc~~readinitfiles~~CallsGraph_edge53" class="edge">
<title>proc~inletgen&#45;&gt;ttav</title>
<path fill="none" stroke="#ffef00" d="M301.1636,-786.0349C307.5738,-782.9368 313.7664,-778.7122 318,-773 381.7004,-687.0512 284.923,-616.6903 354,-535 360.8523,-526.8965 370.8889,-521.8993 380.9912,-518.8244"/>
<polygon fill="#ffef00" stroke="#ffef00" points="382.1341,-522.1472 390.9999,-516.3464 380.4518,-515.3524 382.1341,-522.1472"/>
</g>
<!-- proc~writerestartfiles -->
<g id="proc~~readinitfiles~~CallsGraph_node52" class="node">
<title>proc~writerestartfiles</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node52"><a xlink:href=".././proc/writerestartfiles.html" xlink:title="writerestartfiles">
<polygon fill="#d9534f" stroke="#d9534f" points="460.5,-816 375.5,-816 375.5,-792 460.5,-792 460.5,-816"/>
<text text-anchor="middle" x="418" y="-801.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">writerestartfiles</text>
</a>
</g>
</g>
<!-- proc~inletgen&#45;&gt;proc~writerestartfiles -->
<g id="proc~~readinitfiles~~CallsGraph_edge54" class="edge">
<title>proc~inletgen&#45;&gt;proc~writerestartfiles</title>
<path fill="none" stroke="#ffef00" d="M301.0853,-795.8809C319.1608,-797.1362 343.5244,-798.8281 365.3324,-800.3425"/>
<polygon fill="#ffef00" stroke="#ffef00" points="365.2478,-803.845 375.4663,-801.0463 365.7328,-796.8618 365.2478,-803.845"/>
</g>
<!-- proc~writeinletfile -->
<g id="proc~~readinitfiles~~CallsGraph_node54" class="node">
<title>proc~writeinletfile</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node54"><a xlink:href=".././proc/writeinletfile.html" xlink:title="writeinletfile">
<polygon fill="#d9534f" stroke="#d9534f" points="452,-774 384,-774 384,-750 452,-750 452,-774"/>
<text text-anchor="middle" x="418" y="-759.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">writeinletfile</text>
</a>
</g>
</g>
<!-- proc~inletgen&#45;&gt;proc~writeinletfile -->
<g id="proc~~readinitfiles~~CallsGraph_edge56" class="edge">
<title>proc~inletgen&#45;&gt;proc~writeinletfile</title>
<path fill="none" stroke="#ffef00" d="M301.0853,-787.981C321.6161,-783.4187 350.2593,-777.0535 374.0557,-771.7654"/>
<polygon fill="#ffef00" stroke="#ffef00" points="374.917,-775.1595 383.9196,-769.5734 373.3985,-768.3261 374.917,-775.1595"/>
</g>
<!-- proc~momentumthicknessexp -->
<g id="proc~~readinitfiles~~CallsGraph_node55" class="node">
<title>proc~momentumthicknessexp</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node55"><a xlink:href=".././proc/momentumthicknessexp.html" xlink:title="momentumthicknessexp">
<polygon fill="#d9534f" stroke="#d9534f" points="482,-732 354,-732 354,-708 482,-708 482,-732"/>
<text text-anchor="middle" x="418" y="-717.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">momentumthicknessexp</text>
</a>
</g>
</g>
<!-- proc~inletgen&#45;&gt;proc~momentumthicknessexp -->
<g id="proc~~readinitfiles~~CallsGraph_edge61" class="edge">
<title>proc~inletgen&#45;&gt;proc~momentumthicknessexp</title>
<path fill="none" stroke="#ffef00" d="M301.1829,-782.5019C306.9032,-779.6798 312.7813,-776.4638 318,-773 335.836,-761.1616 335.4421,-751.6712 354,-741 357.1775,-739.1729 360.5363,-737.4784 363.9844,-735.9114"/>
<polygon fill="#ffef00" stroke="#ffef00" points="365.3658,-739.1276 373.257,-732.0579 362.6795,-732.6635 365.3658,-739.1276"/>
</g>
<!-- proc~blthicknesst -->
<g id="proc~~readinitfiles~~CallsGraph_node56" class="node">
<title>proc~blthicknesst</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node56"><a xlink:href=".././proc/blthicknesst.html" xlink:title="blthicknesst">
<polygon fill="#d9534f" stroke="#d9534f" points="452,-1026 384,-1026 384,-1002 452,-1002 452,-1026"/>
<text text-anchor="middle" x="418" y="-1011.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">blthicknesst</text>
</a>
</g>
</g>
<!-- proc~inletgen&#45;&gt;proc~blthicknesst -->
<g id="proc~~readinitfiles~~CallsGraph_edge57" class="edge">
<title>proc~inletgen&#45;&gt;proc~blthicknesst</title>
<path fill="none" stroke="#ffef00" d="M301.4319,-802.3322C307.682,-805.4064 313.7307,-809.5276 318,-815 367.6473,-878.6374 300.3769,-932.6747 354,-993 359.4681,-999.1516 366.7671,-1003.5079 374.477,-1006.5912"/>
<polygon fill="#ffef00" stroke="#ffef00" points="373.396,-1009.9202 383.9896,-1009.7559 375.6058,-1003.2781 373.396,-1009.9202"/>
</g>
<!-- tinl -->
<g id="proc~~readinitfiles~~CallsGraph_node57" class="node">
<title>tinl</title>
<polygon fill="#777777" stroke="#777777" points="445,-652 391,-652 391,-628 445,-628 445,-652"/>
<text text-anchor="middle" x="418" y="-637.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">tinl</text>
</g>
<!-- proc~inletgen&#45;&gt;tinl -->
<g id="proc~~readinitfiles~~CallsGraph_edge52" class="edge">
<title>proc~inletgen&#45;&gt;tinl</title>
<path fill="none" stroke="#ffef00" d="M301.4275,-785.0573C307.5287,-782.0197 313.5095,-778.0683 318,-773 351.2737,-735.4448 319.6254,-702.5502 354,-666 361.2715,-658.2683 371.1641,-652.7751 380.9965,-648.8967"/>
<polygon fill="#ffef00" stroke="#ffef00" points="382.4053,-652.1128 390.7096,-645.5334 380.1148,-645.4981 382.4053,-652.1128"/>
</g>
<!-- proc~dispthicknessexp -->
<g id="proc~~readinitfiles~~CallsGraph_node58" class="node">
<title>proc~dispthicknessexp</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node58"><a xlink:href=".././proc/dispthicknessexp.html" xlink:title="dispthicknessexp">
<polygon fill="#d9534f" stroke="#d9534f" points="465,-984 371,-984 371,-960 465,-960 465,-984"/>
<text text-anchor="middle" x="418" y="-969.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">dispthicknessexp</text>
</a>
</g>
</g>
<!-- proc~inletgen&#45;&gt;proc~dispthicknessexp -->
<g id="proc~~readinitfiles~~CallsGraph_edge55" class="edge">
<title>proc~inletgen&#45;&gt;proc~dispthicknessexp</title>
<path fill="none" stroke="#ffef00" d="M301.2099,-802.5107C307.4643,-805.5815 313.5706,-809.6564 318,-815 357.9031,-863.1381 311.0943,-905.5178 354,-951 356.3271,-953.4668 358.9482,-955.6443 361.7669,-957.5662"/>
<polygon fill="#ffef00" stroke="#ffef00" points="360.2872,-960.7495 370.7193,-962.5994 363.7178,-954.6477 360.2872,-960.7495"/>
</g>
<!-- utav -->
<g id="proc~~readinitfiles~~CallsGraph_node59" class="node">
<title>utav</title>
<polygon fill="#777777" stroke="#777777" points="584.5,-984 530.5,-984 530.5,-960 584.5,-960 584.5,-984"/>
<text text-anchor="middle" x="557.5" y="-969.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">utav</text>
</g>
<!-- proc~inletgen&#45;&gt;utav -->
<g id="proc~~readinitfiles~~CallsGraph_edge60" class="edge">
<title>proc~inletgen&#45;&gt;utav</title>
<path fill="none" stroke="#ffef00" d="M301.4387,-784.4062C307.399,-781.4173 313.3141,-777.651 318,-773 343.9584,-747.2349 322.993,-718.397 354,-699 402.2293,-668.8292 436.7286,-664.5494 482,-699 522.6235,-729.9137 547.0141,-890.2479 554.7823,-949.7462"/>
<polygon fill="#ffef00" stroke="#ffef00" points="551.3439,-950.453 556.077,-959.9318 558.288,-949.5703 551.3439,-950.453"/>
</g>
<!-- proc~fromztop -->
<g id="proc~~readinitfiles~~CallsGraph_node50" class="node">
<title>proc~fromztop</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node50"><a xlink:href=".././proc/fromztop.html" xlink:title="fromztop">
<polygon fill="#d9534f" stroke="#d9534f" points="445.5,-192 390.5,-192 390.5,-168 445.5,-168 445.5,-192"/>
<text text-anchor="middle" x="418" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">fromztop</text>
</a>
</g>
</g>
<!-- proc~diagfld&#45;&gt;proc~fromztop -->
<g id="proc~~readinitfiles~~CallsGraph_edge62" class="edge">
<title>proc~diagfld&#45;&gt;proc~fromztop</title>
<path fill="none" stroke="#00ff3f" d="M301.0853,-180C323.327,-180 355.0895,-180 379.8963,-180"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="380.054,-183.5001 390.0539,-180 380.0539,-176.5001 380.054,-183.5001"/>
</g>
<!-- proc~inletgennotemp&#45;&gt;proc~readinletfile -->
<g id="proc~~readinitfiles~~CallsGraph_edge70" class="edge">
<title>proc~inletgennotemp&#45;&gt;proc~readinletfile</title>
<path fill="none" stroke="#00ff6f" d="M308.854,-823.789C312.3728,-821.3508 315.5464,-818.4484 318,-815 401.485,-697.667 263.168,-604.7423 354,-493 359.2964,-486.4843 366.6568,-481.9716 374.5065,-478.8509"/>
<polygon fill="#00ff6f" stroke="#00ff6f" points="375.7905,-482.1139 384.2184,-475.6936 373.6262,-475.4568 375.7905,-482.1139"/>
</g>
<!-- proc~inletgennotemp&#45;&gt;proc~slabsum -->
<g id="proc~~readinitfiles~~CallsGraph_edge71" class="edge">
<title>proc~inletgennotemp&#45;&gt;proc~slabsum</title>
<path fill="none" stroke="#00ff6f" d="M308.2352,-848.0636C311.9547,-850.5375 315.346,-853.4887 318,-857 375.3641,-932.8923 294.4069,-993.8452 354,-1068 360.8887,-1076.572 371.0536,-1082.339 381.2638,-1086.2107"/>
<polygon fill="#00ff6f" stroke="#00ff6f" points="380.3691,-1089.6002 390.9614,-1089.3716 382.5384,-1082.9448 380.3691,-1089.6002"/>
</g>
<!-- proc~inletgennotemp&#45;&gt;wrec -->
<g id="proc~~readinitfiles~~CallsGraph_edge63" class="edge">
<title>proc~inletgennotemp&#45;&gt;wrec</title>
<path fill="none" stroke="#00ff6f" d="M304.6233,-848.0404C309.3629,-850.6122 314.0041,-853.5981 318,-857 339.4032,-875.2216 331.4732,-892.1874 354,-909 361.9988,-914.9698 371.7781,-919.2933 381.2615,-922.4045"/>
<polygon fill="#00ff6f" stroke="#00ff6f" points="380.3702,-925.7903 390.95,-925.2262 382.3276,-919.0695 380.3702,-925.7903"/>
</g>
<!-- proc~inletgennotemp&#45;&gt;uinl -->
<g id="proc~~readinitfiles~~CallsGraph_edge64" class="edge">
<title>proc~inletgennotemp&#45;&gt;uinl</title>
<path fill="none" stroke="#00ff6f" d="M303.8717,-848.005C318.8495,-853.9145 337.3094,-861.0326 354,-867 362.7205,-870.1179 372.1704,-873.3164 381.0638,-876.2473"/>
<polygon fill="#00ff6f" stroke="#00ff6f" points="380.2074,-879.6494 390.7998,-879.4241 382.3788,-872.9947 380.2074,-879.6494"/>
</g>
<!-- proc~inletgennotemp&#45;&gt;urec -->
<g id="proc~~readinitfiles~~CallsGraph_edge65" class="edge">
<title>proc~inletgennotemp&#45;&gt;urec</title>
<path fill="none" stroke="#00ff6f" d="M317.2047,-839.0003C337.429,-840.4048 361.2824,-842.0613 380.7063,-843.4102"/>
<polygon fill="#00ff6f" stroke="#00ff6f" points="380.4846,-846.9031 390.703,-844.1044 380.9696,-839.9199 380.4846,-846.9031"/>
</g>
<!-- proc~inletgennotemp&#45;&gt;proc~writerestartfiles -->
<g id="proc~~readinitfiles~~CallsGraph_edge66" class="edge">
<title>proc~inletgennotemp&#45;&gt;proc~writerestartfiles</title>
<path fill="none" stroke="#00ff6f" d="M317.2047,-826.3989C332.2914,-823.0464 349.3976,-819.245 365.178,-815.7382"/>
<polygon fill="#00ff6f" stroke="#00ff6f" points="366.3194,-819.07 375.322,-813.484 364.8008,-812.2367 366.3194,-819.07"/>
</g>
<!-- proc~inletgennotemp&#45;&gt;proc~writeinletfile -->
<g id="proc~~readinitfiles~~CallsGraph_edge68" class="edge">
<title>proc~inletgennotemp&#45;&gt;proc~writeinletfile</title>
<path fill="none" stroke="#00ff6f" d="M302.577,-823.8077C307.8521,-821.1567 313.2045,-818.183 318,-815 335.836,-803.1616 335.4421,-793.6712 354,-783 360.13,-779.4751 366.9349,-776.4438 373.7538,-773.8695"/>
<polygon fill="#00ff6f" stroke="#00ff6f" points="375.3806,-777.0095 383.6774,-770.4206 373.0826,-770.3975 375.3806,-777.0095"/>
</g>
<!-- proc~inletgennotemp&#45;&gt;proc~momentumthicknessexp -->
<g id="proc~~readinitfiles~~CallsGraph_edge73" class="edge">
<title>proc~inletgennotemp&#45;&gt;proc~momentumthicknessexp</title>
<path fill="none" stroke="#00ff6f" d="M305.9947,-823.9519C310.3516,-821.4277 314.5156,-818.4584 318,-815 343.9584,-789.2349 326.4439,-765.0487 354,-741 355.5198,-739.6736 357.1254,-738.4306 358.7983,-737.2659"/>
<polygon fill="#00ff6f" stroke="#00ff6f" points="360.7912,-740.1543 367.6383,-732.0693 357.2437,-734.1198 360.7912,-740.1543"/>
</g>
<!-- proc~inletgennotemp&#45;&gt;proc~blthicknesst -->
<g id="proc~~readinitfiles~~CallsGraph_edge69" class="edge">
<title>proc~inletgennotemp&#45;&gt;proc~blthicknesst</title>
<path fill="none" stroke="#00ff6f" d="M307.5042,-848.0181C311.4389,-850.5123 315.083,-853.4811 318,-857 357.9031,-905.1381 311.0943,-947.5178 354,-993 359.5293,-998.8614 366.7189,-1003.0889 374.2742,-1006.1373"/>
<polygon fill="#00ff6f" stroke="#00ff6f" points="373.3484,-1009.5188 383.9426,-1009.4025 375.5882,-1002.8868 373.3484,-1009.5188"/>
</g>
<!-- proc~inletgennotemp&#45;&gt;proc~dispthicknessexp -->
<g id="proc~~readinitfiles~~CallsGraph_edge67" class="edge">
<title>proc~inletgennotemp&#45;&gt;proc~dispthicknessexp</title>
<path fill="none" stroke="#00ff6f" d="M306.7165,-848.0486C310.8699,-850.554 314.7842,-853.5177 318,-857 348.3507,-889.8666 321.6056,-920.1457 354,-951 356.4133,-953.2986 359.0825,-955.3456 361.9207,-957.1687"/>
<polygon fill="#00ff6f" stroke="#00ff6f" points="360.3932,-960.3215 370.8553,-961.9933 363.7192,-954.1621 360.3932,-960.3215"/>
</g>
<!-- proc~inletgennotemp&#45;&gt;utav -->
<g id="proc~~readinitfiles~~CallsGraph_edge72" class="edge">
<title>proc~inletgennotemp&#45;&gt;utav</title>
<path fill="none" stroke="#00ff6f" d="M308.1336,-848.1416C311.8697,-850.6028 315.2926,-853.5297 318,-857 367.6473,-920.6374 291.5261,-983.8964 354,-1035 398.0335,-1071.0194 428.5153,-1054.3838 482,-1035 505.5635,-1026.4602 526.9312,-1006.9954 540.872,-991.945"/>
<polygon fill="#00ff6f" stroke="#00ff6f" points="543.7879,-993.933 547.8195,-984.1352 538.5579,-989.2804 543.7879,-993.933"/>
</g>
<!-- proc~cyclicqj&#45;&gt;proc~excjs -->
<g id="proc~~readinitfiles~~CallsGraph_edge74" class="edge">
<title>proc~cyclicqj&#45;&gt;proc~excjs</title>
<path fill="none" stroke="#00cfff" d="M445.2282,-392.0989C466.6399,-395.3221 496.6965,-399.8468 520.3229,-403.4035"/>
<polygon fill="#00cfff" stroke="#00cfff" points="519.9309,-406.8838 530.3405,-404.9115 520.973,-399.9618 519.9309,-406.8838"/>
</g>
<!-- proc~slabsumi -->
<g id="proc~~readinitfiles~~CallsGraph_node45" class="node">
<title>proc~slabsumi</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node45"><a xlink:href=".././proc/slabsumi.html" xlink:title="slabsumi">
<polygon fill="#d9534f" stroke="#d9534f" points="445.5,-1187 390.5,-1187 390.5,-1163 445.5,-1163 445.5,-1187"/>
<text text-anchor="middle" x="418" y="-1172.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">slabsumi</text>
</a>
</g>
</g>
<!-- proc~inlettop&#45;&gt;proc~slabsumi -->
<g id="proc~~readinitfiles~~CallsGraph_edge75" class="edge">
<title>proc~inlettop&#45;&gt;proc~slabsumi</title>
<path fill="none" stroke="#006fff" d="M301.0853,-1206.6644C323.4262,-1200.6137 355.3733,-1191.9614 380.2281,-1185.2299"/>
<polygon fill="#006fff" stroke="#006fff" points="381.3166,-1188.5612 390.0539,-1182.5687 379.4867,-1181.8047 381.3166,-1188.5612"/>
</g>
<!-- mpi_sendrecv -->
<g id="proc~~readinitfiles~~CallsGraph_node53" class="node">
<title>mpi_sendrecv</title>
<polygon fill="#777777" stroke="#777777" points="712,-421 633,-421 633,-397 712,-397 712,-421"/>
<text text-anchor="middle" x="672.5" y="-406.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mpi_sendrecv</text>
</g>
<!-- proc~excjs&#45;&gt;mpi_sendrecv -->
<g id="proc~~readinitfiles~~CallsGraph_edge76" class="edge">
<title>proc~excjs&#45;&gt;mpi_sendrecv</title>
<path fill="none" stroke="#7f00ff" d="M584.7534,-409C596.0739,-409 609.5809,-409 622.5644,-409"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="622.8129,-412.5001 632.8128,-409 622.8128,-405.5001 622.8129,-412.5001"/>
</g>
<!-- proc~cyclichj&#45;&gt;proc~excjs -->
<g id="proc~~readinitfiles~~CallsGraph_edge77" class="edge">
<title>proc~cyclichj&#45;&gt;proc~excjs</title>
<path fill="none" stroke="#ff00ef" d="M445.2059,-353.6699C456.7412,-357.2425 470.2149,-361.8447 482,-367 498.2328,-374.1008 515.5601,-383.591 529.5157,-391.7537"/>
<polygon fill="#ff00ef" stroke="#ff00ef" points="527.7696,-394.7874 538.1542,-396.8876 531.3458,-388.7699 527.7696,-394.7874"/>
</g>
<!-- proc~slabsumi&#45;&gt;mpi_allreduce -->
<g id="proc~~readinitfiles~~CallsGraph_edge78" class="edge">
<title>proc~slabsumi&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#ff5f00" d="M445.5607,-1166.8997C463.3831,-1161.6616 487.092,-1154.6934 508.1011,-1148.5187"/>
<polygon fill="#ff5f00" stroke="#ff5f00" points="509.2384,-1151.8325 517.8456,-1145.6547 507.2645,-1145.1166 509.2384,-1151.8325"/>
</g>
<!-- proc~dispthicknessexp&#45;&gt;utav -->
<g id="proc~~readinitfiles~~CallsGraph_edge79" class="edge">
<title>proc~dispthicknessexp&#45;&gt;utav</title>
<path fill="none" stroke="#ff00bf" d="M465.2283,-972C483.1637,-972 503.3246,-972 520.2159,-972"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="520.2615,-975.5001 530.2615,-972 520.2614,-968.5001 520.2615,-975.5001"/>
</g>
</g>
</svg>
</div><script>var panprocreadinitfilesCallsGraph = svgPanZoom('#procreadinitfilesCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,0 64,0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,0 136,0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,0 209.5,0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,0 364,0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,0 436,0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="551.5,-24 454.5,-24 454.5,0 551.5,0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: proc~~readinitfiles~~CalledByGraph Pages: 1 -->
<svg id="procreadinitfilesCalledByGraph" width="283pt" height="32pt"
 viewBox="0.00 0.00 283.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~readinitfiles~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~readinitfiles~~CalledByGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 279,-28 279,4 -4,4"/>
<!-- proc~readinitfiles -->
<g id="proc~~readinitfiles~~CalledByGraph_node1" class="node">
<title>proc~readinitfiles</title>
<polygon fill="none" stroke="#000000" points="275,-24 208,-24 208,0 275,0 275,-24"/>
<text text-anchor="middle" x="241.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">readinitfiles</text>
</g>
<!-- proc~startup -->
<g id="proc~~readinitfiles~~CalledByGraph_node2" class="node">
<title>proc~startup</title>
<g id="a_proc~~readinitfiles~~CalledByGraph_node2"><a xlink:href=".././proc/startup.html" xlink:title="startup">
<polygon fill="#d9534f" stroke="#d9534f" points="172,-24 118,-24 118,0 172,0 172,-24"/>
<text text-anchor="middle" x="145" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">startup</text>
</a>
</g>
</g>
<!-- proc~startup&#45;&gt;proc~readinitfiles -->
<g id="proc~~readinitfiles~~CalledByGraph_edge1" class="edge">
<title>proc~startup&#45;&gt;proc~readinitfiles</title>
<path fill="none" stroke="#ff0000" d="M172.1374,-12C180.0709,-12 188.9529,-12 197.6433,-12"/>
<polygon fill="#ff0000" stroke="#ff0000" points="197.6887,-15.5001 207.6886,-12 197.6886,-8.5001 197.6887,-15.5001"/>
</g>
<!-- program~dalesurban -->
<g id="proc~~readinitfiles~~CalledByGraph_node3" class="node">
<title>program~dalesurban</title>
<g id="a_proc~~readinitfiles~~CalledByGraph_node3"><a xlink:href=".././program/dalesurban.html" xlink:title="DALESURBAN">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="82,-24 0,-24 0,0 82,0 82,-24"/>
<text text-anchor="middle" x="41" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DALESURBAN</text>
</a>
</g>
</g>
<!-- program~dalesurban&#45;&gt;proc~startup -->
<g id="proc~~readinitfiles~~CalledByGraph_edge2" class="edge">
<title>program~dalesurban&#45;&gt;proc~startup</title>
<path fill="none" stroke="#ff0000" d="M82.1036,-12C90.5669,-12 99.4334,-12 107.7509,-12"/>
<polygon fill="#ff0000" stroke="#ff0000" points="107.9213,-15.5001 117.9213,-12 107.9213,-8.5001 107.9213,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,0 64,0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,0 136,0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,0 209.5,0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,0 364,0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,0 436,0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="551.5,-24 454.5,-24 454.5,0 551.5,0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/readinitfiles.html#src">readinitfiles</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>   <span class="k">subroutine </span><span class="n">readinitfiles</span>
      <span class="k">use </span><span class="n">modfields</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span><span class="n">u0</span><span class="p">,</span> <span class="n">v0</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">um</span><span class="p">,</span> <span class="n">vm</span><span class="p">,</span> <span class="n">wm</span><span class="p">,</span> <span class="n">thlm</span><span class="p">,</span> <span class="n">thl0</span><span class="p">,</span> <span class="n">thl0h</span><span class="p">,</span> <span class="n">qtm</span><span class="p">,</span> <span class="n">qt0</span><span class="p">,</span> <span class="n">qt0h</span><span class="p">,</span> <span class="p">&amp;</span>
         <span class="n">ql0</span><span class="p">,</span> <span class="n">ql0h</span><span class="p">,</span> <span class="n">thv0h</span><span class="p">,</span> <span class="n">sv0</span><span class="p">,</span> <span class="n">svm</span><span class="p">,</span> <span class="n">e12m</span><span class="p">,</span> <span class="n">e120</span><span class="p">,</span> <span class="p">&amp;</span>
         <span class="n">dudxls</span><span class="p">,</span> <span class="n">dudyls</span><span class="p">,</span> <span class="n">dvdxls</span><span class="p">,</span> <span class="n">dvdyls</span><span class="p">,</span> <span class="n">dthldxls</span><span class="p">,</span> <span class="n">dthldyls</span><span class="p">,</span> <span class="p">&amp;</span>
         <span class="n">dqtdxls</span><span class="p">,</span> <span class="n">dqtdyls</span><span class="p">,</span> <span class="n">dqtdtls</span><span class="p">,</span> <span class="n">dpdx</span><span class="p">,</span> <span class="n">dpdxl</span><span class="p">,</span> <span class="n">dpdyl</span><span class="p">,</span> <span class="p">&amp;</span>
         <span class="n">wfls</span><span class="p">,</span> <span class="n">whls</span><span class="p">,</span> <span class="n">ug</span><span class="p">,</span> <span class="n">vg</span><span class="p">,</span> <span class="n">pgx</span><span class="p">,</span> <span class="n">pgy</span><span class="p">,</span> <span class="n">uprof</span><span class="p">,</span> <span class="n">vprof</span><span class="p">,</span> <span class="n">thlprof</span><span class="p">,</span> <span class="n">qtprof</span><span class="p">,</span> <span class="n">e12prof</span><span class="p">,</span> <span class="n">svprof</span><span class="p">,</span> <span class="p">&amp;</span>
         <span class="n">v0av</span><span class="p">,</span> <span class="n">u0av</span><span class="p">,</span> <span class="n">qt0av</span><span class="p">,</span> <span class="n">ql0av</span><span class="p">,</span> <span class="n">thl0av</span><span class="p">,</span> <span class="n">qt0av</span><span class="p">,</span> <span class="n">sv0av</span><span class="p">,</span> <span class="n">exnf</span><span class="p">,</span> <span class="n">exnh</span><span class="p">,</span> <span class="n">presf</span><span class="p">,</span> <span class="n">presh</span><span class="p">,</span> <span class="n">rhof</span><span class="p">,</span> <span class="p">&amp;</span>
         <span class="n">thlpcar</span><span class="p">,</span> <span class="n">uav</span><span class="p">,</span> <span class="n">thvh</span><span class="p">,</span> <span class="n">thvf</span><span class="p">,</span> <span class="n">IIc</span><span class="p">,</span> <span class="n">IIcs</span><span class="p">,</span> <span class="n">IIu</span><span class="p">,</span> <span class="n">IIus</span><span class="p">,</span> <span class="n">IIv</span><span class="p">,</span> <span class="n">IIvs</span><span class="p">,</span> <span class="n">IIw</span><span class="p">,</span> <span class="n">IIws</span>
            <span class="k">use </span><span class="n">modglobal</span><span class="p">,</span>         <span class="n">only</span> <span class="p">:</span> <span class="n">ib</span><span class="p">,</span><span class="n">ie</span><span class="p">,</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="p">,</span><span class="n">je</span><span class="p">,</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="p">,</span><span class="n">kh</span><span class="p">,</span><span class="n">khc</span><span class="p">,</span><span class="n">kmax</span><span class="p">,</span><span class="n">dtmax</span><span class="p">,</span><span class="n">dt</span><span class="p">,</span><span class="n">runtime</span><span class="p">,</span><span class="n">timeleft</span><span class="p">,</span><span class="n">timee</span><span class="p">,</span><span class="n">ntimee</span><span class="p">,</span><span class="n">ntrun</span><span class="p">,</span><span class="n">btime</span><span class="p">,</span><span class="n">dt_lim</span><span class="p">,</span><span class="n">nsv</span><span class="p">,&amp;</span>
         <span class="n">zf</span><span class="p">,</span> <span class="n">zh</span><span class="p">,</span> <span class="n">dzf</span><span class="p">,</span> <span class="n">dzh</span><span class="p">,</span> <span class="n">rv</span><span class="p">,</span> <span class="n">rd</span><span class="p">,</span> <span class="n">grav</span><span class="p">,</span> <span class="n">cp</span><span class="p">,</span> <span class="n">rlv</span><span class="p">,</span> <span class="n">pref0</span><span class="p">,</span> <span class="n">om23_gs</span><span class="p">,</span> <span class="n">jgb</span><span class="p">,</span> <span class="n">jge</span><span class="p">,</span> <span class="n">Uinf</span><span class="p">,</span> <span class="n">Vinf</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="p">&amp;</span>
         <span class="n">rslabs</span><span class="p">,</span> <span class="n">e12min</span><span class="p">,</span> <span class="n">dzh</span><span class="p">,</span> <span class="n">dtheta</span><span class="p">,</span> <span class="n">dqt</span><span class="p">,</span> <span class="n">dsv</span><span class="p">,</span> <span class="n">cexpnr</span><span class="p">,</span> <span class="n">ifinput</span><span class="p">,</span> <span class="n">lwarmstart</span><span class="p">,</span> <span class="n">lstratstart</span><span class="p">,</span> <span class="n">trestart</span><span class="p">,</span> <span class="n">numol</span><span class="p">,</span> <span class="p">&amp;</span>
         <span class="n">ladaptive</span><span class="p">,</span> <span class="n">tnextrestart</span><span class="p">,</span> <span class="n">jmax</span><span class="p">,</span> <span class="n">linoutflow</span><span class="p">,</span> <span class="n">lper2inout</span><span class="p">,</span> <span class="n">iinletgen</span><span class="p">,</span> <span class="n">lreadminl</span><span class="p">,</span> <span class="p">&amp;</span>
         <span class="n">uflowrate</span><span class="p">,</span> <span class="n">vflowrate</span><span class="p">,</span><span class="n">ltempeq</span><span class="p">,</span> <span class="n">prandtlmoli</span><span class="p">,</span> <span class="n">freestreamav</span><span class="p">,</span> <span class="p">&amp;</span>
         <span class="n">tnextfielddump</span><span class="p">,</span> <span class="n">tfielddump</span><span class="p">,</span> <span class="n">tsample</span><span class="p">,</span> <span class="n">tstatsdump</span><span class="p">,</span> <span class="n">startfile</span><span class="p">,</span> <span class="n">lprofforc</span><span class="p">,</span> <span class="n">lchem</span><span class="p">,</span> <span class="n">k1</span><span class="p">,</span> <span class="n">JNO2</span><span class="p">,&amp;</span>
         <span class="n">idriver</span><span class="p">,</span><span class="n">dtdriver</span><span class="p">,</span><span class="n">driverstore</span><span class="p">,</span><span class="n">tdriverstart</span><span class="p">,</span><span class="n">tdriverdump</span>        
      <span class="k">use </span><span class="n">modsubgriddata</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span><span class="n">ekm</span><span class="p">,</span> <span class="n">ekh</span>
      <span class="k">use </span><span class="n">modsurfdata</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span><span class="n">wtsurf</span><span class="p">,</span> <span class="n">wqsurf</span><span class="p">,</span> <span class="n">wsvsurf</span><span class="p">,</span> <span class="p">&amp;</span>
         <span class="n">thls</span><span class="p">,</span> <span class="n">thvs</span><span class="p">,</span> <span class="n">ps</span><span class="p">,</span> <span class="n">qts</span><span class="p">,</span> <span class="n">svs</span><span class="p">,</span> <span class="n">sv_top</span>
      <span class="c">! use modsurface,        only : surface,dthldz</span>
      <span class="k">use </span><span class="n">modboundary</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span><span class="n">boundary</span><span class="p">,</span> <span class="n">tqaver</span>
      <span class="k">use </span><span class="n">modmpi</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span><span class="n">slabsum</span><span class="p">,</span> <span class="n">myid</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">,</span> <span class="n">my_real</span><span class="p">,</span> <span class="n">avexy_ibm</span>
      <span class="k">use </span><span class="n">modthermodynamics</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span><span class="n">thermodynamics</span><span class="p">,</span> <span class="n">calc_halflev</span>
      <span class="k">use </span><span class="n">modinletdata</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span><span class="n">Uinl</span><span class="p">,</span> <span class="n">Urec</span><span class="p">,</span> <span class="n">Wrec</span><span class="p">,</span> <span class="n">u0inletbc</span><span class="p">,</span> <span class="n">v0inletbc</span><span class="p">,</span> <span class="n">w0inletbc</span><span class="p">,</span> <span class="n">ubulk</span><span class="p">,</span> <span class="n">irecy</span><span class="p">,</span> <span class="n">Utav</span><span class="p">,</span> <span class="n">Ttav</span><span class="p">,</span> <span class="p">&amp;</span>
         <span class="n">uminletbc</span><span class="p">,</span> <span class="n">vminletbc</span><span class="p">,</span> <span class="n">wminletbc</span><span class="p">,</span> <span class="n">u0inletbcold</span><span class="p">,</span> <span class="n">v0inletbcold</span><span class="p">,</span> <span class="n">w0inletbcold</span><span class="p">,</span> <span class="p">&amp;</span>
         <span class="n">storeu0inletbc</span><span class="p">,</span> <span class="n">storev0inletbc</span><span class="p">,</span> <span class="n">storew0inletbc</span><span class="p">,</span> <span class="n">nstepread</span><span class="p">,</span> <span class="n">nfile</span><span class="p">,</span> <span class="n">Tinl</span><span class="p">,</span> <span class="p">&amp;</span>
         <span class="n">Trec</span><span class="p">,</span> <span class="n">tminletbc</span><span class="p">,</span> <span class="n">t0inletbcold</span><span class="p">,</span> <span class="n">t0inletbc</span><span class="p">,</span> <span class="n">storet0inletbc</span><span class="p">,</span> <span class="n">utaui</span><span class="p">,</span> <span class="n">ttaui</span><span class="p">,</span> <span class="n">iangle</span><span class="p">,&amp;</span>
         <span class="n">u0driver</span><span class="p">,</span><span class="n">v0driver</span><span class="p">,</span><span class="n">w0driver</span><span class="p">,</span><span class="n">e120driver</span><span class="p">,</span><span class="n">tdriver</span><span class="p">,</span><span class="n">thl0driver</span><span class="p">,</span><span class="n">qt0driver</span><span class="p">,</span><span class="n">storetdriver</span><span class="p">,&amp;</span>
         <span class="n">storeu0driver</span><span class="p">,</span><span class="n">storev0driver</span><span class="p">,</span><span class="n">storew0driver</span><span class="p">,</span><span class="n">storee120driver</span><span class="p">,</span><span class="n">storethl0driver</span><span class="p">,</span><span class="n">storeqt0driver</span><span class="p">,&amp;</span>
         <span class="n">nstepreaddriver</span>
      <span class="k">use </span><span class="n">modinlet</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span><span class="n">readinletfile</span>
      <span class="k">use </span><span class="n">moddriver</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">readdriverfile</span><span class="p">,</span><span class="n">initdriver</span><span class="p">,</span><span class="n">drivergen</span>

      <span class="kt">integer </span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">n</span>

      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">height</span><span class="p">(:),</span> <span class="n">th0av</span><span class="p">(:)</span>
      <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="n">ih</span><span class="p">:</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span><span class="p">,</span> <span class="n">jb</span> <span class="o">-</span> <span class="n">jh</span><span class="p">:</span><span class="n">je</span> <span class="o">+</span> <span class="n">jh</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">)</span> <span class="kd">::</span> <span class="n">thv0</span>
      <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span> <span class="kd">::</span> <span class="n">uaverage</span> <span class="c">! volume averaged u-velocity</span>
      <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vaverage</span> <span class="c">! volume averaged v-velocity</span>
      <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span> <span class="kd">::</span> <span class="n">uaverager</span> <span class="c">! recycle plane</span>
      <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span> <span class="kd">::</span> <span class="n">uaveragei</span> <span class="c">! inlet plane</span>
      <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span> <span class="kd">::</span> <span class="n">taverager</span> <span class="c">! recycle plane</span>
      <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span> <span class="kd">::</span> <span class="n">taveragei</span> <span class="c">! inlet plane</span>
      <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">waverage</span>
      <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">uprofrot</span>
      <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vprofrot</span>
      <span class="kt">real </span><span class="n">tv</span><span class="p">,</span> <span class="n">ran</span><span class="p">,</span> <span class="n">ran1</span><span class="p">,</span> <span class="n">vbulk</span>

      <span class="kt">character</span><span class="p">(</span><span class="mi">80</span><span class="p">)</span> <span class="n">chmess</span>

      <span class="k">allocate</span> <span class="p">(</span><span class="n">height</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">))</span>
      <span class="k">allocate</span> <span class="p">(</span><span class="n">th0av</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">))</span>

      <span class="k">if</span> <span class="p">(</span><span class="n">lstratstart</span><span class="p">)</span> <span class="k">then</span> <span class="c">! Switch</span>

         <span class="c">! Read restart files as in lwarmstart</span>
         <span class="k">call </span><span class="n">readrestartfiles</span>
         <span class="n">um</span> <span class="o">=</span> <span class="n">u0</span>
         <span class="n">vm</span> <span class="o">=</span> <span class="n">v0</span>
         <span class="n">wm</span> <span class="o">=</span> <span class="n">w0</span>
         <span class="n">thlm</span> <span class="o">=</span> <span class="n">thl0</span> <span class="c">!do this before or just not?</span>
         <span class="n">qtm</span> <span class="o">=</span> <span class="n">qt0</span>
         <span class="n">svm</span> <span class="o">=</span> <span class="n">sv0</span>
         <span class="n">e12m</span> <span class="o">=</span> <span class="n">e120</span>

         <span class="c">! Overwrite thlm, thl0, qtm, qt0 from prof.inp.xxx</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">myid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            open</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="s1">&#39;prof.inp.&#39;</span><span class="o">//</span><span class="n">cexpnr</span><span class="p">)</span>
            <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="s1">&#39;(a80)&#39;</span><span class="p">)</span> <span class="n">chmess</span>
            <span class="k">write</span> <span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="s1">&#39;(a80)&#39;</span><span class="p">)</span> <span class="n">chmess</span>
            <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="s1">&#39;(a80)&#39;</span><span class="p">)</span> <span class="n">chmess</span>

            <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
               <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="p">&amp;</span>
                  <span class="n">height</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                  <span class="n">thlprof</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                  <span class="n">qtprof</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                  <span class="n">uprof</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                  <span class="n">vprof</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                  <span class="n">e12prof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
            <span class="k">end do</span>
<span class="k">            close</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">)</span>

            <span class="k">write</span> <span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;height    thl     qt      u      v     e12&#39;</span>
            <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">ke</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>
               <span class="k">write</span> <span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="s1">&#39;(f7.1,2f8.1,3f7.1)&#39;</span><span class="p">)</span> <span class="p">&amp;</span>
                  <span class="n">height</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                  <span class="n">thlprof</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                  <span class="n">qtprof</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                  <span class="n">uprof</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                  <span class="n">vprof</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                  <span class="n">e12prof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>

            <span class="k">end do</span>
<span class="k">         end if</span> <span class="c">!myid=0</span>

         <span class="c">! MPI broadcast thl and qt</span>
         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">thlprof</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">qtprof</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>

         <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
            <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="n">jb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">je</span> <span class="o">+</span> <span class="mi">1</span>
               <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ie</span> <span class="o">+</span> <span class="mi">1</span>
                  <span class="n">thl0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">thlprof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
                  <span class="n">thlm</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">thlprof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
                  <span class="n">qt0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">qtprof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
                  <span class="n">qtm</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">qtprof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
               <span class="k">end do</span>
<span class="k">            end do</span>
<span class="k">         end do</span>

         <span class="c">!ILS13 reintroduced thv !tg3315 this part may wrong, could need to use</span>
         <span class="k">call </span><span class="n">calc_halflev</span>
         <span class="c">! exnf = (presf/pref0)**(rd/cp)  !exner functions not in restart files</span>
         <span class="c">! anymore.. or at least not read</span>
         <span class="c">! exnh = (presh/pref0)**(rd/cp)</span>

         <span class="c">!   write(*,*) &quot;exnf&quot;,enf</span>
         <span class="c">!   write(*,*) &quot;exnh&quot;,exnh</span>
         <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span>
            <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span>
               <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ie</span>
                  <span class="c">!write(*,*) &quot;thl0h&quot;,thl0h(i,j,k)</span>
                  <span class="n">thv0h</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">thl0h</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">rlv</span><span class="o">*</span><span class="n">ql0h</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">cp</span><span class="p">))</span> <span class="p">&amp;</span>
                                   <span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">rv</span><span class="o">/</span><span class="n">rd</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">qt0h</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">-</span> <span class="n">rv</span><span class="o">/</span><span class="n">rd</span><span class="o">*</span><span class="n">ql0h</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span>
               <span class="k">end do</span>
<span class="k">            end do</span>
<span class="k">         end do</span>

<span class="k">         do </span><span class="n">j</span> <span class="o">=</span> <span class="n">j</span><span class="p">,</span> <span class="n">je</span>
            <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ie</span>
               <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span>
                  <span class="n">thv0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">thl0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">rlv</span><span class="o">*</span><span class="n">ql0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">cp</span><span class="p">))</span> <span class="p">&amp;</span>
                                  <span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">rv</span><span class="o">/</span><span class="n">rd</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">qt0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">-</span> <span class="n">rv</span><span class="o">/</span><span class="n">rd</span><span class="o">*</span><span class="n">ql0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span>
               <span class="k">end do</span>
<span class="k">            end do</span>
<span class="k">         end do</span>

<span class="k">         </span><span class="n">thvh</span> <span class="o">=</span> <span class="mf">0.</span>
         <span class="c">! call slabsum(thvh,kb,ke,thv0h,ib-ih,ie+ih,jb-jh,je+jh,kb-kh,ke+kh,ib,ie,jb,je,kb,ke) ! redefine halflevel thv using calculated thv</span>
         <span class="k">call </span><span class="n">avexy_ibm</span><span class="p">(</span><span class="n">thvh</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),</span><span class="n">thv0h</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),</span><span class="n">ib</span><span class="p">,</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">,</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="p">,</span><span class="n">ih</span><span class="p">,</span><span class="n">jh</span><span class="p">,</span><span class="n">kh</span><span class="p">,</span><span class="n">IIw</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),</span><span class="n">IIws</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),.</span><span class="n">false</span><span class="p">.)</span>
         <span class="c">! thvh = thvh/rslabs</span>

         <span class="n">thvf</span> <span class="o">=</span> <span class="mf">0.0</span>
         <span class="k">call </span><span class="n">avexy_ibm</span><span class="p">(</span><span class="n">thvf</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),</span><span class="n">thv0</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),</span><span class="n">ib</span><span class="p">,</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">,</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="p">,</span><span class="n">ih</span><span class="p">,</span><span class="n">jh</span><span class="p">,</span><span class="n">kh</span><span class="p">,</span><span class="n">IIc</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),</span><span class="n">IIcs</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),.</span><span class="n">false</span><span class="p">.)</span>
         <span class="c">! call slabsum(thvf,kb,ke,thv0,ib-ih,ie+ih,jb-jh,je+jh,kb-kh,ke+kh,ib,ie,jb,je,kb,ke)</span>
         <span class="c">! thvf = thvf/rslabs</span>

      <span class="k">else</span> <span class="c">!if not lstratstart</span>

         <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lwarmstart</span><span class="p">)</span> <span class="k">then</span>

            <span class="c">!********************************************************************</span>

            <span class="c">!    1.0 prepare initial fields from files &#39;prof.inp&#39; and &#39;scalar.inp&#39;</span>
            <span class="c">!    ----------------------------------------------------------------</span>

            <span class="c">!--------------------------------------------------------------------</span>
            <span class="c">!    1.1 read fields</span>
            <span class="c">!-----------------------------------------------------------------</span>

            <span class="n">dt</span> <span class="o">=</span> <span class="n">dtmax</span><span class="o">/</span><span class="mi">10</span><span class="mf">0.</span>
            <span class="n">timee</span> <span class="o">=</span> <span class="mf">0.</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">myid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">               open</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="s1">&#39;prof.inp.&#39;</span><span class="o">//</span><span class="n">cexpnr</span><span class="p">)</span>
               <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="s1">&#39;(a80)&#39;</span><span class="p">)</span> <span class="n">chmess</span>
               <span class="k">write</span> <span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="s1">&#39;(a80)&#39;</span><span class="p">)</span> <span class="n">chmess</span>
               <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="s1">&#39;(a80)&#39;</span><span class="p">)</span> <span class="n">chmess</span>

               <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
                  <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="p">&amp;</span>
                     <span class="n">height</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                     <span class="n">thlprof</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                     <span class="n">qtprof</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                     <span class="n">uprof</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                     <span class="n">vprof</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                     <span class="n">e12prof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
               <span class="k">end do</span>

               <span class="c">! Apply rotation in horizontal</span>
               <span class="c">!write (6, *) &#39;iangle = &#39;, iangle</span>

               <span class="c">!uprofrot = uprof*cos(iangle) - vprof*sin(iangle)</span>
               <span class="c">!vprofrot = vprof*cos(iangle) + uprof*sin(iangle)</span>
               <span class="c">!uprof = uprofrot</span>
               <span class="c">!vprof = vprofrot</span>

               <span class="k">close</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">)</span>
               <span class="k">write</span> <span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;height    thl     qt      u      v     e12&#39;</span>
               <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">ke</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>
                  <span class="k">write</span> <span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="s1">&#39;(f7.1,2f8.1,3f7.1)&#39;</span><span class="p">)</span> <span class="p">&amp;</span>
                     <span class="n">height</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                     <span class="n">thlprof</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                     <span class="n">qtprof</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                     <span class="n">uprof</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                     <span class="n">vprof</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                     <span class="n">e12prof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>

               <span class="k">end do</span>

<span class="k">               if</span> <span class="p">(</span><span class="nb">minval</span><span class="p">(</span><span class="n">e12prof</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span> <span class="o">&lt;</span> <span class="n">e12min</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                  write</span> <span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;e12 value is zero (or less) in prof.inp&#39;</span>
                  <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
                     <span class="n">e12prof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">e12prof</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="n">e12min</span><span class="p">)</span>
                  <span class="k">end do</span>
<span class="k">               end if</span>

<span class="k">            end if</span> <span class="c">! end if myid==0</span>
            <span class="c">! MPI broadcast numbers reading</span>
            <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">thlprof</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
            <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">qtprof</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
            <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">uprof</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
            <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">vprof</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
            <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">e12prof</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
            <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
            <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="n">jb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">je</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ie</span> <span class="o">+</span> <span class="mi">1</span>
               <span class="n">thl0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">thlprof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
               <span class="n">thlm</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">thlprof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
               <span class="n">qt0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">qtprof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
               <span class="n">qtm</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">qtprof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
               <span class="n">u0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">uprof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
               <span class="n">um</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">uprof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
               <span class="n">v0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">vprof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
               <span class="n">vm</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">vprof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
               <span class="n">w0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0</span>
               <span class="n">wm</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0</span>
               <span class="n">e120</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">e12prof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
               <span class="n">e12m</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">e12prof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
               <span class="c">!        ekm (i,j,k) = 0.0</span>
               <span class="c">!        ekh (i,j,k) = 0.0</span>
               <span class="n">ekm</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">numol</span>
               <span class="n">ekh</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">numol</span>
            <span class="k">end do</span>
<span class="k">            end do</span>
<span class="k">            end do</span>

<span class="k">            </span><span class="n">ekh</span><span class="p">(:,</span> <span class="p">:,</span> <span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ekh</span><span class="p">(:,</span> <span class="p">:,</span> <span class="n">ke</span><span class="p">)</span> <span class="c">! also for start up</span>

            <span class="c">! ILS13 30.11.17, added, not sure if necessary</span>
            <span class="c">! ILS13 30.11.1, commented</span>
            <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="n">jb</span> <span class="o">-</span> <span class="n">jh</span><span class="p">,</span> <span class="n">je</span> <span class="o">+</span> <span class="n">jh</span>
               <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ib</span> <span class="o">-</span> <span class="n">ih</span><span class="p">,</span> <span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span>
                  <span class="n">thl0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">thl0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">ke</span><span class="p">)</span>
                  <span class="n">thl0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">kb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">thl0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">kb</span><span class="p">)</span>
               <span class="k">end do</span>
<span class="k">            end do</span>

            <span class="c">!! add random fluctuations</span>
            <span class="n">krand</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">krand</span><span class="p">,</span> <span class="n">ke</span><span class="p">)</span>
            <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">krand</span>
               <span class="k">call </span><span class="n">randomnize</span><span class="p">(</span><span class="n">um</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">randu</span><span class="p">,</span> <span class="n">irandom</span><span class="p">,</span> <span class="n">ih</span><span class="p">,</span> <span class="n">jh</span><span class="p">)</span>
            <span class="k">end do</span>
<span class="k">            do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">krand</span>
               <span class="k">call </span><span class="n">randomnize</span><span class="p">(</span><span class="n">vm</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">randu</span><span class="p">,</span> <span class="n">irandom</span><span class="p">,</span> <span class="n">ih</span><span class="p">,</span> <span class="n">jh</span><span class="p">)</span>
            <span class="k">end do</span>
<span class="k">            do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">krand</span>
               <span class="k">call </span><span class="n">randomnize</span><span class="p">(</span><span class="n">wm</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">randu</span><span class="p">,</span> <span class="n">irandom</span><span class="p">,</span> <span class="n">ih</span><span class="p">,</span> <span class="n">jh</span><span class="p">)</span>
            <span class="k">end do</span>

            <span class="c">!       do k=kb+1,ke-1</span>
            <span class="c">!       do j=jb,je</span>
            <span class="c">!       do i=ib+1,ie-1</span>
            <span class="c">!         call random_number(ran)</span>
            <span class="c">!         ran1 = -1. +2.*ran</span>
            <span class="c">!         wm(i,j,k)=wm(i,j,k)+ 0.1*Uinf*ran1</span>
            <span class="c">!       end do</span>
            <span class="c">!       end do</span>
            <span class="c">!       end do</span>
            <span class="c">!</span>
            <span class="c">!       do k=kb+1,ke-1</span>
            <span class="c">!       do j=jb,je</span>
            <span class="c">!       do i=ib+2,ie-1</span>
            <span class="c">!         call random_number(ran)</span>
            <span class="c">!         ran1 = -1. +2.*ran</span>
            <span class="c">!         um(i,j,k)=um(i,j,k)+ 0.1*Uinf*ran1</span>
            <span class="c">!       end do</span>
            <span class="c">!       end do</span>
            <span class="c">!       end do</span>
            <span class="c">!</span>
            <span class="c">!       do k=kb+1,ke-1</span>
            <span class="c">!       do j=jb,je</span>
            <span class="c">!       do i=ib+1,ie-1</span>
            <span class="c">!         call random_number(ran)</span>
            <span class="c">!         ran1 = -1. +2.*ran</span>
            <span class="c">!         vm(i,j,k)=vm(i,j,k)+ 0.1*Uinf*ran1</span>
            <span class="c">!       end do</span>
            <span class="c">!       end do</span>
            <span class="c">!       end do</span>

            <span class="n">u0</span> <span class="o">=</span> <span class="n">um</span>
            <span class="n">v0</span> <span class="o">=</span> <span class="n">vm</span>
            <span class="n">w0</span> <span class="o">=</span> <span class="n">wm</span>

            <span class="n">uaverage</span> <span class="o">=</span> <span class="mf">0.</span>
            <span class="c">! call slabsum(uaverage, kb, ke, um, ib - 1, ie + 1, jb - 1, je + 1, kb - 1, ke + 1, ib, ie, jb, je, kb, ke)</span>
            <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
               <span class="n">uaverage</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">uprof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">dzf</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
            <span class="k">end do</span>
<span class="k">            </span><span class="n">ubulk</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">uaverage</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">zh</span><span class="p">(</span><span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">zh</span><span class="p">(</span><span class="n">kb</span><span class="p">))</span> <span class="c">! averaged u-velocity inflow profile</span>

            <span class="n">vaverage</span> <span class="o">=</span> <span class="mf">0.</span>
            <span class="c">! call slabsum(vaverage, kb, ke, vm, ib - 1, ie + 1, jb - 1, je + 1, kb - 1, ke + 1, ib, ie, jb, je, kb, ke)</span>
            <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
               <span class="n">vaverage</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">vprof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">dzf</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
            <span class="k">end do</span>
<span class="k">            </span><span class="n">vbulk</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">vaverage</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">zh</span><span class="p">(</span><span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">zh</span><span class="p">(</span><span class="n">kb</span><span class="p">))</span> <span class="c">! averaged u-velocity inflow profile</span>

            <span class="c">! Set average inlet profile to initial inlet profile in case of inletgenerator mode</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">iinletgen</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>

<span class="k">               </span><span class="n">uaverage</span> <span class="o">=</span> <span class="mf">0.</span>
               <span class="k">call </span><span class="n">slabsum</span><span class="p">(</span><span class="n">uaverage</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span><span class="p">,</span> <span class="n">um</span><span class="p">,</span> <span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ie</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">jb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">je</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">kb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ie</span><span class="p">,</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span><span class="p">)</span>
               <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
                  <span class="n">uaverage</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">uprof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">dzf</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
               <span class="k">end do</span>
<span class="k">               </span><span class="n">ubulk</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">uaverage</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">zh</span><span class="p">(</span><span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">zh</span><span class="p">(</span><span class="n">kb</span><span class="p">))</span> <span class="c">! volume-averaged u-velocity</span>
               <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Modstartup: ubulk=&#39;</span><span class="p">,</span> <span class="n">ubulk</span>
               <span class="n">Utav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span> <span class="o">=</span> <span class="n">um</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span> <span class="n">jb</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span>
               <span class="n">Uinl</span> <span class="o">=</span> <span class="n">um</span><span class="p">(</span><span class="n">ib</span><span class="p">,</span> <span class="n">jb</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span> <span class="c">! set the initial time-averaged inlet profile equal to um</span>
               <span class="n">Urec</span> <span class="o">=</span> <span class="n">um</span><span class="p">(</span><span class="n">ib</span><span class="p">,</span> <span class="n">jb</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span> <span class="c">! set the initial time-averaged inlet profile equal to um</span>
               <span class="n">Wrec</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">wm</span><span class="p">(</span><span class="n">ib</span><span class="p">,</span> <span class="n">jb</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="c">! set the initial time-averaged inlet profile equal to mean w-profile</span>
               <span class="n">u0inletbcold</span><span class="p">(</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span> <span class="o">=</span> <span class="n">um</span><span class="p">(</span><span class="n">ib</span><span class="p">,</span> <span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span>
               <span class="n">v0inletbcold</span><span class="p">(</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span> <span class="o">=</span> <span class="n">vm</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span>
               <span class="n">w0inletbcold</span><span class="p">(</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">wm</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
               <span class="n">uminletbc</span><span class="p">(</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span> <span class="o">=</span> <span class="n">um</span><span class="p">(</span><span class="n">ib</span><span class="p">,</span> <span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span>
               <span class="n">vminletbc</span><span class="p">(</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span> <span class="o">=</span> <span class="n">vm</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span>
               <span class="n">wminletbc</span><span class="p">(</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span> <span class="o">=</span> <span class="n">wm</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span>
               <span class="n">u0inletbc</span><span class="p">(</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span> <span class="o">=</span> <span class="n">um</span><span class="p">(</span><span class="n">ib</span><span class="p">,</span> <span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span>
               <span class="n">v0inletbc</span><span class="p">(</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span> <span class="o">=</span> <span class="n">vm</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span>
               <span class="n">w0inletbc</span><span class="p">(</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">wm</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
               <span class="n">utaui</span> <span class="o">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">numol</span><span class="o">*</span><span class="n">Uinl</span><span class="p">(</span><span class="n">kb</span><span class="p">)</span><span class="o">/</span><span class="n">dzf</span><span class="p">(</span><span class="n">kb</span><span class="p">)))</span> <span class="c">! average streamwise friction at inlet (need for first time step)</span>

               <span class="k">if</span> <span class="p">(</span><span class="n">ltempeq</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                  </span><span class="n">Ttav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span> <span class="o">=</span> <span class="n">thlm</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span> <span class="n">jb</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span> <span class="c">! set the initial time-averaged inlet profile equal to thlm</span>
                  <span class="n">Tinl</span> <span class="o">=</span> <span class="n">thlm</span><span class="p">(</span><span class="n">ib</span><span class="p">,</span> <span class="n">jb</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span> <span class="c">! set the initial time-averaged inlet profile equal to thlm</span>
                  <span class="n">Trec</span> <span class="o">=</span> <span class="n">thlm</span><span class="p">(</span><span class="n">ib</span><span class="p">,</span> <span class="n">jb</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span> <span class="c">! set the initial time-averaged inlet profile equal to thlm</span>
                  <span class="n">t0inletbcold</span><span class="p">(</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span> <span class="o">=</span> <span class="n">thlm</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span>
                  <span class="n">t0inletbc</span><span class="p">(</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span> <span class="o">=</span> <span class="n">thl0</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span>
                  <span class="n">tminletbc</span><span class="p">(</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span> <span class="o">=</span> <span class="n">thlm</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span>
                  <span class="n">ttaui</span> <span class="o">=</span> <span class="n">numol</span><span class="o">*</span><span class="n">prandtlmoli</span><span class="o">*</span><span class="mf">2.</span><span class="o">*</span><span class="p">(</span><span class="n">Tinl</span><span class="p">(</span><span class="n">kb</span><span class="p">)</span> <span class="o">-</span> <span class="n">thls</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">dzf</span><span class="p">(</span><span class="n">kb</span><span class="p">)</span><span class="o">*</span><span class="n">utaui</span><span class="p">)</span> <span class="c">! average friction temp. at inlet (need for first time step)</span>
               <span class="k">end if</span>

               <span class="c">! add random perturbations</span>
               <span class="k">if</span> <span class="p">(</span><span class="n">myid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                  call </span><span class="nb">random_number</span><span class="p">(</span><span class="n">ran</span><span class="p">)</span>
                  <span class="n">ran1</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.</span><span class="o">+</span><span class="mf">2.</span><span class="o">*</span><span class="n">ran</span>
                  <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;random=&#39;</span><span class="p">,</span> <span class="n">ran</span><span class="p">,</span> <span class="n">ran1</span>
                  <span class="k">call </span><span class="nb">random_number</span><span class="p">(</span><span class="n">ran</span><span class="p">)</span>
                  <span class="n">ran1</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.</span><span class="o">+</span><span class="mf">2.</span><span class="o">*</span><span class="n">ran</span>
                  <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;random=&#39;</span><span class="p">,</span> <span class="n">ran</span><span class="p">,</span> <span class="n">ran1</span>
                  <span class="k">call </span><span class="nb">random_number</span><span class="p">(</span><span class="n">ran</span><span class="p">)</span>
                  <span class="n">ran1</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.</span><span class="o">+</span><span class="mf">2.</span><span class="o">*</span><span class="n">ran</span>
                  <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;random=&#39;</span><span class="p">,</span> <span class="n">ran</span><span class="p">,</span> <span class="n">ran1</span>
                  <span class="k">call </span><span class="nb">random_number</span><span class="p">(</span><span class="n">ran</span><span class="p">)</span>
                  <span class="n">ran1</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.</span><span class="o">+</span><span class="mf">2.</span><span class="o">*</span><span class="n">ran</span>
                  <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;random=&#39;</span><span class="p">,</span> <span class="n">ran</span><span class="p">,</span> <span class="n">ran1</span>
                  <span class="k">call </span><span class="nb">random_number</span><span class="p">(</span><span class="n">ran</span><span class="p">)</span>
                  <span class="n">ran1</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.</span><span class="o">+</span><span class="mf">2.</span><span class="o">*</span><span class="n">ran</span>
                  <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;random=&#39;</span><span class="p">,</span> <span class="n">ran</span><span class="p">,</span> <span class="n">ran1</span>
                  <span class="k">call </span><span class="nb">random_number</span><span class="p">(</span><span class="n">ran</span><span class="p">)</span>
                  <span class="n">ran1</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.</span><span class="o">+</span><span class="mf">2.</span><span class="o">*</span><span class="n">ran</span>
                  <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;random=&#39;</span><span class="p">,</span> <span class="n">ran</span><span class="p">,</span> <span class="n">ran1</span>
               <span class="k">end if</span>

<span class="k">               do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">kb</span> <span class="o">+</span> <span class="mi">48</span>
               <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span>
               <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ib</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ie</span> <span class="o">-</span> <span class="mi">1</span>
                  <span class="k">call </span><span class="nb">random_number</span><span class="p">(</span><span class="n">ran</span><span class="p">)</span>
                  <span class="n">ran1</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.</span><span class="o">+</span><span class="mf">2.</span><span class="o">*</span><span class="n">ran</span>
                  <span class="n">wm</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">wm</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">Uinf</span><span class="o">*</span><span class="n">ran1</span>
               <span class="k">end do</span>
<span class="k">               end do</span>
<span class="k">               end do</span>

               <span class="c">!       do k=kb+1,ke-1</span>
               <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">kb</span> <span class="o">+</span> <span class="mi">48</span>
               <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span>
               <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ib</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ie</span> <span class="o">-</span> <span class="mi">1</span>
                  <span class="k">call </span><span class="nb">random_number</span><span class="p">(</span><span class="n">ran</span><span class="p">)</span>
                  <span class="n">ran1</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.</span><span class="o">+</span><span class="mf">2.</span><span class="o">*</span><span class="n">ran</span>
                  <span class="n">um</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">um</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">Uinf</span><span class="o">*</span><span class="n">ran1</span>
               <span class="k">end do</span>
<span class="k">               end do</span>
<span class="k">               end do</span>

               <span class="c">!       do k=kb+1,ke-1</span>
               <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">kb</span> <span class="o">+</span> <span class="mi">48</span>
               <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span>
               <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ib</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ie</span> <span class="o">-</span> <span class="mi">1</span>
                  <span class="k">call </span><span class="nb">random_number</span><span class="p">(</span><span class="n">ran</span><span class="p">)</span>
                  <span class="n">ran1</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.</span><span class="o">+</span><span class="mf">2.</span><span class="o">*</span><span class="n">ran</span>
                  <span class="n">vm</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">vm</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">Uinf</span><span class="o">*</span><span class="n">ran1</span>
               <span class="k">end do</span>
<span class="k">               end do</span>
<span class="k">               end do</span>

<span class="k">               </span><span class="n">u0</span> <span class="o">=</span> <span class="n">um</span>
               <span class="n">v0</span> <span class="o">=</span> <span class="n">vm</span>
               <span class="n">w0</span> <span class="o">=</span> <span class="n">wm</span>

            <span class="k">else if</span> <span class="p">(</span><span class="n">iinletgen</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="k">then</span>

<span class="k">               </span><span class="n">nfile</span> <span class="o">=</span> <span class="n">nfile</span> <span class="o">+</span> <span class="mi">1</span>
               <span class="k">call </span><span class="n">readinletfile</span>
               <span class="n">u0inletbc</span><span class="p">(:,</span> <span class="p">:)</span> <span class="o">=</span> <span class="n">storeu0inletbc</span><span class="p">(:,</span> <span class="p">:,</span> <span class="n">nstepread</span><span class="p">)</span>
               <span class="n">v0inletbc</span><span class="p">(:,</span> <span class="p">:)</span> <span class="o">=</span> <span class="n">storev0inletbc</span><span class="p">(:,</span> <span class="p">:,</span> <span class="n">nstepread</span><span class="p">)</span>
               <span class="n">w0inletbc</span><span class="p">(:,</span> <span class="p">:)</span> <span class="o">=</span> <span class="n">storew0inletbc</span><span class="p">(:,</span> <span class="p">:,</span> <span class="n">nstepread</span><span class="p">)</span>
               <span class="n">uminletbc</span><span class="p">(:,</span> <span class="p">:)</span> <span class="o">=</span> <span class="n">storeu0inletbc</span><span class="p">(:,</span> <span class="p">:,</span> <span class="n">nstepread</span><span class="p">)</span>
               <span class="n">vminletbc</span><span class="p">(:,</span> <span class="p">:)</span> <span class="o">=</span> <span class="n">storev0inletbc</span><span class="p">(:,</span> <span class="p">:,</span> <span class="n">nstepread</span><span class="p">)</span>
               <span class="n">wminletbc</span><span class="p">(:,</span> <span class="p">:)</span> <span class="o">=</span> <span class="n">storew0inletbc</span><span class="p">(:,</span> <span class="p">:,</span> <span class="n">nstepread</span><span class="p">)</span>
               <span class="c">! determine bulk velocity</span>
               <span class="k">call </span><span class="n">slabsum</span><span class="p">(</span><span class="n">uaverage</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span><span class="p">,</span> <span class="n">u0</span><span class="p">,</span> <span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ie</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">jb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">je</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">kb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ie</span><span class="p">,</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span><span class="p">)</span>
               <span class="n">uaverage</span> <span class="o">=</span> <span class="n">uaverage</span><span class="o">/</span><span class="p">((</span><span class="n">ie</span> <span class="o">-</span> <span class="n">ib</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">jge</span> <span class="o">-</span> <span class="n">jgb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="c">! this gives the i-j-averaged velocity (only correct for equidistant grid?)</span>
               <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
                  <span class="n">uaverage</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">uaverage</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">dzf</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
               <span class="k">end do</span>
<span class="k">               </span><span class="n">ubulk</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">uaverage</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">zh</span><span class="p">(</span><span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">zh</span><span class="p">(</span><span class="n">kb</span><span class="p">))</span> <span class="c">! volume-averaged u-velocity</span>
               <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Modstartup: ubulk=&#39;</span><span class="p">,</span> <span class="n">ubulk</span>
            <span class="n">elseif</span> <span class="p">(</span><span class="n">idriver</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="k">then</span> <span class="c">! idriver</span>

               <span class="k">call </span><span class="n">readdriverfile</span>

               <span class="c">! if(myid==0) then</span>
                 <span class="c">! write(*,*) &#39;Driver inlet velocity&#39;</span>
                 <span class="c">! do n=1,driverstore</span>
                   <span class="c">! write (*,&#39;(f9.2,e20.12)&#39;) storetdriver(n),     storeu0driver(1,32,n)</span>
                 <span class="c">! end do</span>
               <span class="c">! endif</span>

              <span class="c">! call slabsum(uaverage,kb,ke,u0,ib-1,ie+1,jb-1,je+1,kb-1,ke+1,ib,ie,jb,je,kb,ke)</span>
              <span class="c">! uaverage = uaverage / ((ie-ib+1)*(jge-jgb+1))  ! this gives the i-j-averaged velocity (only correct for equidistant grid?)</span>

              <span class="k">call </span><span class="n">avexy_ibm</span><span class="p">(</span><span class="n">uaverage</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">),</span><span class="n">u0</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">),</span><span class="n">ib</span><span class="p">,</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">,</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="p">,</span><span class="n">ih</span><span class="p">,</span><span class="n">jh</span><span class="p">,</span><span class="n">kh</span><span class="p">,</span><span class="n">IIu</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">),</span><span class="n">IIus</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">),.</span><span class="n">false</span><span class="p">.)</span>
              <span class="k">do </span><span class="n">k</span><span class="o">=</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span>
                <span class="n">uaverage</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">uaverage</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">dzf</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
              <span class="k">end do</span>
<span class="k">              </span><span class="n">ubulk</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">uaverage</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">zh</span><span class="p">(</span><span class="n">ke</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">zh</span><span class="p">(</span><span class="n">kb</span><span class="p">))</span> <span class="c">!volume-averaged u-velocity</span>

              <span class="k">if</span> <span class="p">(</span><span class="n">myid</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                 write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Modstartup: ubulk=&#39;</span><span class="p">,</span><span class="n">ubulk</span>
              <span class="k">end if</span>

<span class="k">            </span><span class="n">elseif</span> <span class="p">(</span><span class="n">idriver</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>

<span class="k">              call </span><span class="n">drivergen</span>

            <span class="k">end if</span>

            <span class="c">!---------------------------------------------------------------</span>
            <span class="c">!  1.2 randomnize fields</span>
            <span class="c">!---------------------------------------------------------------</span>
            <span class="c">!     if (iinletgen /= 2 .and. iinletgen /= 1) then</span>
            <span class="c">!       write(6,*) &#39;randomnizing temperature!&#39;</span>
            <span class="c">!       krand  = min(krand,ke)</span>
            <span class="c">!        do k = kb,ke !edited tg3315 krand --&gt; ke</span>
            <span class="c">!          call randomnize(thlm,k,randthl,irandom,ih,jh)</span>
            <span class="c">!          call randomnize(thl0,k,randthl,irandom,ih,jh)</span>
            <span class="c">!        end do</span>
            <span class="c">!       end if</span>

            <span class="n">svprof</span> <span class="o">=</span> <span class="mf">0.</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">myid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">               if</span> <span class="p">(</span><span class="n">nsv</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                  open</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="s1">&#39;scalar.inp.&#39;</span><span class="o">//</span><span class="n">cexpnr</span><span class="p">)</span>
                  <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="s1">&#39;(a80)&#39;</span><span class="p">)</span> <span class="n">chmess</span>
                  <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="s1">&#39;(a80)&#39;</span><span class="p">)</span> <span class="n">chmess</span>
                  <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
                     <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="p">&amp;</span>
                        <span class="n">height</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                        <span class="p">(</span><span class="n">svprof</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nsv</span><span class="p">)</span>
                  <span class="k">end do</span>
<span class="k">                  open</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="s1">&#39;scalar.inp.&#39;</span><span class="o">//</span><span class="n">cexpnr</span><span class="p">)</span>
                  <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;height   sv(1) --------- sv(nsv) &#39;</span>
                  <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">ke</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>
                     <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="p">&amp;</span>
                        <span class="n">height</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                        <span class="p">(</span><span class="n">svprof</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nsv</span><span class="p">)</span>
                  <span class="k">end do</span>

<span class="k">               end if</span>
<span class="k">            end if</span> <span class="c">! end if myid==0</span>

            <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">svprof</span><span class="p">,</span> <span class="p">(</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span> <span class="o">-</span> <span class="p">(</span><span class="n">kb</span> <span class="o">-</span> <span class="n">kh</span><span class="p">))</span><span class="o">*</span><span class="n">nsv</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
            <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
               <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="n">jb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">je</span> <span class="o">+</span> <span class="mi">1</span>
                  <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ie</span> <span class="o">+</span> <span class="mi">1</span>
                     <span class="k">do </span><span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nsv</span>
                        <span class="n">sv0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="n">svprof</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
                        <span class="n">svm</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="n">svprof</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
                     <span class="k">end do</span>
<span class="k">                  end do</span>
<span class="k">               end do</span>
<span class="k">            end do</span>
<span class="k">          </span>
<span class="k">            if</span> <span class="p">(</span><span class="n">nsv</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span> <span class="c">!tg3315 set these variables here for now and repeat for warmstart</span>

              <span class="k">allocate</span><span class="p">(</span><span class="n">sv_top</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nsv</span><span class="p">))</span>
              <span class="n">sv_top</span><span class="p">(:)</span> <span class="o">=</span> <span class="n">svprof</span><span class="p">(</span><span class="n">ke</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">nsv</span><span class="p">)</span>

              <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">sv_top</span><span class="p">,</span> <span class="n">nsv</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>

              <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;svprof&#39;</span><span class="p">,</span> <span class="n">svprof</span>
              <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;sv_top&#39;</span><span class="p">,</span> <span class="n">sv_top</span>

            <span class="k">end if</span>
 
            <span class="c">!do n = 1,nsv</span>
            <span class="c">!  do j = jb - jhc, je + jhc</span>
            <span class="c">!    do i = ib - ihc, ie + ihc</span>
            <span class="c">!      svm(i, j, ke + 1, n) = svm(i, j, ke)</span>
            <span class="c">!      sv0(i, j, kb - 1, n) = sv0(i, j, kb)</span>
            <span class="c">!    end do</span>
            <span class="c">!  end do</span>
            <span class="c">!end do</span>

            <span class="c">!-----------------------------------------------------------------</span>
            <span class="c">!    2.2 Initialize surface layer</span>
            <span class="c">!-----------------------------------------------------------------</span>

         <span class="c">!ILS13 reintroduced thv !tg3315 this part may wrong, could need to use</span>
         <span class="k">call </span><span class="n">calc_halflev</span>
         <span class="c">! exnf = (presf/pref0)**(rd/cp)  !exner functions not in restart files</span>
         <span class="c">! anymore.. or at least not read</span>
         <span class="c">! exnh = (presh/pref0)**(rd/cp)</span>

            <span class="k">call </span><span class="n">boundary</span> <span class="c">! tg3315 17.10.17 having this in startup was causing issues for running with lmoist ! turned of when pot. temp = temp.</span>
            <span class="k">call </span><span class="n">thermodynamics</span> <span class="c">! turned off when pot. temp = temp.</span>

            <span class="k">call </span><span class="n">boundary</span>
            <span class="k">call </span><span class="n">thermodynamics</span> <span class="c">! turned off when pot. temp = temp.</span>

         <span class="k">else</span> <span class="c">!if lwarmstart</span>
            <span class="k">write</span> <span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s2">&quot;doing warmstart&quot;</span>
            <span class="k">call </span><span class="n">readrestartfiles</span>

            <span class="n">um</span> <span class="o">=</span> <span class="n">u0</span>
            <span class="n">vm</span> <span class="o">=</span> <span class="n">v0</span>
            <span class="n">wm</span> <span class="o">=</span> <span class="n">w0</span>
            <span class="n">thlm</span> <span class="o">=</span> <span class="n">thl0</span>
            <span class="n">qtm</span> <span class="o">=</span> <span class="n">qt0</span>
            <span class="n">svm</span> <span class="o">=</span> <span class="n">sv0</span>
            <span class="n">e12m</span> <span class="o">=</span> <span class="n">e120</span>
            <span class="n">ekm</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:)</span> <span class="o">=</span> <span class="n">numol</span>
            <span class="n">ekh</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:)</span> <span class="o">=</span> <span class="n">numol</span><span class="o">*</span><span class="n">prandtlmoli</span> <span class="c">!tg3315 added because wttop using ekh in modboundary which is called in startup</span>

            <span class="n">ekh</span><span class="p">(:,</span> <span class="p">:,</span> <span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ekh</span><span class="p">(:,</span> <span class="p">:,</span> <span class="n">ke</span><span class="p">)</span> <span class="c">! also for start up</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">idriver</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>                                                                   
              <span class="c">!driverstore = (timeleft - tdriverstart)/dtdriver + 1</span>
              <span class="c">!if(myid==0) then</span>
              <span class="c">!  write(*,*) &#39;driverstore: &#39;, driverstore</span>
              <span class="c">!end if</span>
              <span class="k">call </span><span class="n">drivergen</span>
              <span class="n">tdriverdump</span> <span class="o">=</span> <span class="n">tdriverstart</span>
            <span class="n">endif</span>

            <span class="c">!ILS13 reintroduced thv</span>
            <span class="k">call </span><span class="n">calc_halflev</span>
            <span class="c">! exnf = (presf/pref0)**(rd/cp)  !exner functions not in restart files</span>
            <span class="c">! anymore.. or at least not read</span>
            <span class="c">! exnh = (presh/pref0)**(rd/cp)</span>

            <span class="c">!   write(*,*) &quot;exnf&quot;,enf</span>
            <span class="c">!   write(*,*) &quot;exnh&quot;,exnh</span>

            <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span>
            <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ie</span>
            <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span>
               <span class="c">!write(*,*) &quot;thl0h&quot;,thl0h(i,j,k)</span>
               <span class="n">thv0h</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">thl0h</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">rlv</span><span class="o">*</span><span class="n">ql0h</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">cp</span><span class="p">))</span> <span class="p">&amp;</span>
                                <span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">rv</span><span class="o">/</span><span class="n">rd</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">qt0h</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">-</span> <span class="n">rv</span><span class="o">/</span><span class="n">rd</span><span class="o">*</span><span class="n">ql0h</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span>
            <span class="k">end do</span>
<span class="k">            end do</span>
<span class="k">            end do</span>

<span class="k">            do </span><span class="n">j</span> <span class="o">=</span> <span class="n">j</span><span class="p">,</span> <span class="n">je</span>
            <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ie</span>
            <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span>
               <span class="n">thv0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">thl0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">rlv</span><span class="o">*</span><span class="n">ql0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">cp</span><span class="p">))</span> <span class="p">&amp;</span>
                               <span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">rv</span><span class="o">/</span><span class="n">rd</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">qt0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">-</span> <span class="n">rv</span><span class="o">/</span><span class="n">rd</span><span class="o">*</span><span class="n">ql0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span>
            <span class="k">end do</span>
<span class="k">            end do</span>
<span class="k">            end do</span>

<span class="k">            </span><span class="n">thvh</span> <span class="o">=</span> <span class="mf">0.</span>
            <span class="c">! call slabsum(thvh,kb,ke,thv0h,ib-ih,ie+ih,jb-jh,je+jh,kb-kh,ke+kh,ib,ie,jb,je,kb,ke) ! redefine halflevel thv using calculated thv</span>
            <span class="k">call </span><span class="n">avexy_ibm</span><span class="p">(</span><span class="n">thvh</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),</span><span class="n">thv0h</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),</span><span class="n">ib</span><span class="p">,</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">,</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="p">,</span><span class="n">ih</span><span class="p">,</span><span class="n">jh</span><span class="p">,</span><span class="n">kh</span><span class="p">,</span><span class="n">IIw</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),</span><span class="n">IIws</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),.</span><span class="n">false</span><span class="p">.)</span>
            <span class="c">! thvh = thvh/rslabs</span>

            <span class="n">thvf</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="k">call </span><span class="n">avexy_ibm</span><span class="p">(</span><span class="n">thvf</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),</span><span class="n">thv0</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),</span><span class="n">ib</span><span class="p">,</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">,</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="p">,</span><span class="n">ih</span><span class="p">,</span><span class="n">jh</span><span class="p">,</span><span class="n">kh</span><span class="p">,</span><span class="n">IIc</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),</span><span class="n">IIcs</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),.</span><span class="n">false</span><span class="p">.)</span>
            <span class="c">! call slabsum(thvf,kb,ke,thv0,ib-ih,ie+ih,jb-jh,je+jh,kb-kh,ke+kh,ib,ie,jb,je,kb,ke)</span>
            <span class="c">! thvf = thvf/rslabs</span>

            <span class="c">! Set average inlet profile to initial inlet profile in case of inletgenerator mode</span>
            <span class="n">uaverage</span> <span class="o">=</span> <span class="mf">0.</span>
            <span class="n">uaveragei</span> <span class="o">=</span> <span class="mf">0.</span>
            <span class="n">uaverager</span> <span class="o">=</span> <span class="mf">0.</span>
            <span class="n">waverage</span> <span class="o">=</span> <span class="mf">0.</span>
            <span class="n">taveragei</span> <span class="o">=</span> <span class="mf">0.</span>
            <span class="n">taverager</span> <span class="o">=</span> <span class="mf">0.</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">iinletgen</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">               call </span><span class="n">slabsum</span><span class="p">(</span><span class="n">uaveragei</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span><span class="p">,</span> <span class="n">u0</span><span class="p">,</span> <span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ie</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">jb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">je</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">kb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ib</span><span class="p">,</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span><span class="p">)</span>
               <span class="k">call </span><span class="n">slabsum</span><span class="p">(</span><span class="n">uaverager</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span><span class="p">,</span> <span class="n">u0</span><span class="p">,</span> <span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ie</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">jb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">je</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">kb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">irecy</span><span class="p">,</span> <span class="n">irecy</span><span class="p">,</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span><span class="p">)</span>
               <span class="k">call </span><span class="n">slabsum</span><span class="p">(</span><span class="n">waverage</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ie</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">jb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">je</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">kb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ie</span><span class="p">,</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
               <span class="k">call </span><span class="n">slabsum</span><span class="p">(</span><span class="n">uaverage</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span><span class="p">,</span> <span class="n">u0</span><span class="p">,</span> <span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ie</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">jb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">je</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">kb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ie</span><span class="p">,</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span><span class="p">)</span>
               <span class="n">uaverage</span> <span class="o">=</span> <span class="n">uaverage</span><span class="o">/</span><span class="p">((</span><span class="n">ie</span> <span class="o">-</span> <span class="n">ib</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">jge</span> <span class="o">-</span> <span class="n">jgb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="c">! this gives the i-j-averaged velocity (only correct for equidistant grid?)</span>
               <span class="n">uaveragei</span> <span class="o">=</span> <span class="n">uaveragei</span><span class="o">/</span><span class="p">(</span><span class="n">jge</span> <span class="o">-</span> <span class="n">jgb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="c">! this gives the j-averaged u-velocity at the inlet</span>
               <span class="n">uaverager</span> <span class="o">=</span> <span class="n">uaverager</span><span class="o">/</span><span class="p">(</span><span class="n">jge</span> <span class="o">-</span> <span class="n">jgb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="c">! this gives the j-averaged u-velocity at the recycle plane</span>
               <span class="n">waverage</span> <span class="o">=</span> <span class="n">waverage</span><span class="o">/</span><span class="p">((</span><span class="n">ie</span> <span class="o">-</span> <span class="n">ib</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">jge</span> <span class="o">-</span> <span class="n">jgb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="c">! this gives the i-j-averaged w-velocity (only correct for equidistant grid?)</span>
               <span class="k">if</span> <span class="p">(</span><span class="n">ltempeq</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                  call </span><span class="n">slabsum</span><span class="p">(</span><span class="n">taveragei</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span><span class="p">,</span> <span class="n">thl0</span><span class="p">,</span> <span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ie</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">jb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">je</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">kb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ie</span><span class="p">,</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span><span class="p">)</span>
                  <span class="k">call </span><span class="n">slabsum</span><span class="p">(</span><span class="n">taverager</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span><span class="p">,</span> <span class="n">thl0</span><span class="p">,</span> <span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ie</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">jb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">je</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">kb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">irecy</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">irecy</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span><span class="p">)</span>
                  <span class="n">taveragei</span> <span class="o">=</span> <span class="n">taveragei</span><span class="o">/</span><span class="p">((</span><span class="n">ie</span> <span class="o">-</span> <span class="n">ib</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">jge</span> <span class="o">-</span> <span class="n">jgb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="c">! this gives the j-averaged temperature at the inlet</span>
                  <span class="n">taverager</span> <span class="o">=</span> <span class="n">taverager</span><span class="o">/</span><span class="p">(</span><span class="n">jge</span> <span class="o">-</span> <span class="n">jgb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="c">! this gives the j-averaged temperature at the recycle plane</span>
               <span class="k">end if</span>
<span class="k">               if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lreadminl</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                  if</span> <span class="p">(</span><span class="n">myid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                     write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;uaverage(kb)=&#39;</span><span class="p">,</span> <span class="n">uaverage</span><span class="p">(</span><span class="n">kb</span><span class="p">)</span>
                     <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;uaverage(ke)=&#39;</span><span class="p">,</span> <span class="n">uaverage</span><span class="p">(</span><span class="n">ke</span><span class="p">)</span>
                     <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;waverage(ke)=&#39;</span><span class="p">,</span> <span class="n">waverage</span><span class="p">(</span><span class="n">ke</span><span class="p">)</span>
                     <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;waverage(ke-20)=&#39;</span><span class="p">,</span> <span class="n">waverage</span><span class="p">(</span><span class="n">ke</span> <span class="o">-</span> <span class="mi">20</span><span class="p">)</span>
                     <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;taveragei(kb)=&#39;</span><span class="p">,</span> <span class="n">taveragei</span><span class="p">(</span><span class="n">kb</span><span class="p">)</span>
                     <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;taveragei(ke)=&#39;</span><span class="p">,</span> <span class="n">taveragei</span><span class="p">(</span><span class="n">ke</span><span class="p">)</span>
                  <span class="k">end if</span>

<span class="k">                  </span><span class="n">Utav</span> <span class="o">=</span> <span class="mf">0.</span>
                  <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ie</span>
                     <span class="n">Utav</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="p">:)</span> <span class="o">=</span> <span class="n">uaverage</span>
                  <span class="k">end do</span>

<span class="k">                  </span><span class="n">Uinl</span> <span class="o">=</span> <span class="n">uaverage</span> <span class="c">! set the initial time-averaged inlet profile equal to mean u-profile read from means</span>
                  <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Uinl(kb+10)=&#39;</span><span class="p">,</span> <span class="n">Uinl</span><span class="p">(</span><span class="n">kb</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
                  <span class="n">utaui</span> <span class="o">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">numol</span><span class="o">*</span><span class="n">Uinl</span><span class="p">(</span><span class="n">kb</span><span class="p">)</span><span class="o">/</span><span class="n">dzf</span><span class="p">(</span><span class="n">kb</span><span class="p">)))</span> <span class="c">! average streamwise friction at inlet (need for first time step)</span>
                  <span class="n">Urec</span> <span class="o">=</span> <span class="n">uaverage</span> <span class="c">! set the initial time-averaged inlet profile equal to mean u-profile</span>

                  <span class="n">Wrec</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">waverage</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="c">! set the initial time-averaged inlet profile equal to mean w-profile</span>
                  <span class="n">Wrec</span><span class="p">(</span><span class="n">kb</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.</span> <span class="c">! set the initial time-averaged inlet profile equal to zero</span>
                  <span class="k">if</span> <span class="p">(</span><span class="n">ltempeq</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                     </span><span class="n">Ttav</span> <span class="o">=</span> <span class="mf">0.</span>
                     <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ie</span>
                        <span class="n">Ttav</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="p">:)</span> <span class="o">=</span> <span class="n">taveragei</span><span class="p">(:)</span>
                     <span class="k">end do</span>
<span class="k">                     </span><span class="n">Tinl</span> <span class="o">=</span> <span class="n">taveragei</span>
                     <span class="n">Trec</span> <span class="o">=</span> <span class="n">taveragei</span>
                     <span class="n">ttaui</span> <span class="o">=</span> <span class="n">numol</span><span class="o">*</span><span class="n">prandtlmoli</span><span class="o">*</span><span class="mf">2.</span><span class="o">*</span><span class="p">(</span><span class="n">Tinl</span><span class="p">(</span><span class="n">kb</span><span class="p">)</span> <span class="o">-</span> <span class="n">thls</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">dzf</span><span class="p">(</span><span class="n">kb</span><span class="p">)</span><span class="o">*</span><span class="n">utaui</span><span class="p">)</span> <span class="c">! friction temp. at inlet (need at first time step)</span>
                  <span class="k">end if</span>
<span class="k">               else</span> <span class="c">! -&gt; lreadminl -&gt; Uinl, Urec, Wrec already read</span>
                  <span class="k">call </span><span class="n">slabsum</span><span class="p">(</span><span class="n">uaverage</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span><span class="p">,</span> <span class="n">u0</span><span class="p">,</span> <span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ie</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">jb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">je</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">kb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ie</span><span class="p">,</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span><span class="p">)</span>
                  <span class="n">uaverage</span> <span class="o">=</span> <span class="n">uaverage</span><span class="o">/</span><span class="p">((</span><span class="n">ie</span> <span class="o">-</span> <span class="n">ib</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">jge</span> <span class="o">-</span> <span class="n">jgb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="c">! this gives the i-j-averaged velocity (only correct for equidistant grid?)</span>
               <span class="k">end if</span>

               <span class="c">! determine bulk velocity</span>
               <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
                  <span class="n">uaverage</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">uaverage</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">dzf</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
               <span class="k">end do</span>
<span class="k">               </span><span class="n">ubulk</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">uaverage</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">zh</span><span class="p">(</span><span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">zh</span><span class="p">(</span><span class="n">kb</span><span class="p">))</span> <span class="c">! volume-averaged u-velocity</span>
               <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Modstartup: ubulk=&#39;</span><span class="p">,</span> <span class="n">ubulk</span>

               <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
               <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span>
                  <span class="n">uminletbc</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">um</span><span class="p">(</span><span class="n">ib</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
                  <span class="n">vminletbc</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">vm</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
                  <span class="n">u0inletbcold</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">um</span><span class="p">(</span><span class="n">ib</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
                  <span class="n">v0inletbcold</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">vm</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
                  <span class="n">u0inletbc</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">um</span><span class="p">(</span><span class="n">ib</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
                  <span class="n">v0inletbc</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">vm</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
               <span class="k">end do</span>
<span class="k">               end do</span>

<span class="k">               do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span>
               <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span>
                  <span class="n">wminletbc</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">wm</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
                  <span class="n">w0inletbcold</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">wm</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
                  <span class="n">w0inletbc</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">wm</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
               <span class="k">end do</span>
<span class="k">               end do</span>

<span class="k">               if</span> <span class="p">(</span><span class="n">ltempeq</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                  do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
                  <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span>
                     <span class="n">tminletbc</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">thlm</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
                     <span class="n">t0inletbcold</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">thlm</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
                     <span class="n">t0inletbc</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">thlm</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
                  <span class="k">end do</span>
<span class="k">                  end do</span>
<span class="k">               end if</span>

<span class="k">               write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;uminletbc(jb,kb),um(ib,jb,kb)=&#39;</span><span class="p">,</span> <span class="n">uminletbc</span><span class="p">(</span><span class="n">jb</span><span class="p">,</span> <span class="n">kb</span><span class="p">),</span> <span class="n">um</span><span class="p">(</span><span class="n">ib</span><span class="p">,</span> <span class="n">jb</span><span class="p">,</span> <span class="n">kb</span><span class="p">)</span>
               <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;uminletbc(jb+1,kb+10),um(ib,jb+1,kb+10)=&#39;</span><span class="p">,</span> <span class="n">uminletbc</span><span class="p">(</span><span class="n">jb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">kb</span> <span class="o">+</span> <span class="mi">10</span><span class="p">),</span> <span class="n">um</span><span class="p">(</span><span class="n">ib</span><span class="p">,</span> <span class="n">jb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">kb</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
               <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;uminletbc(je,kb+10),um(ib,je,kb+10)=&#39;</span><span class="p">,</span> <span class="n">uminletbc</span><span class="p">(</span><span class="n">je</span><span class="p">,</span> <span class="n">kb</span> <span class="o">+</span> <span class="mi">10</span><span class="p">),</span> <span class="n">um</span><span class="p">(</span><span class="n">ib</span><span class="p">,</span> <span class="n">je</span><span class="p">,</span> <span class="n">kb</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>

            <span class="k">else if</span> <span class="p">(</span><span class="n">iinletgen</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="k">then</span>

<span class="k">               </span><span class="n">nfile</span> <span class="o">=</span> <span class="n">nfile</span> <span class="o">+</span> <span class="mi">1</span>
               <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Loading inletfile&#39;</span>
               <span class="k">call </span><span class="n">readinletfile</span>
               <span class="n">u0inletbc</span><span class="p">(:,</span> <span class="p">:)</span> <span class="o">=</span> <span class="n">storeu0inletbc</span><span class="p">(:,</span> <span class="p">:,</span> <span class="n">nstepread</span><span class="p">)</span>
               <span class="n">v0inletbc</span><span class="p">(:,</span> <span class="p">:)</span> <span class="o">=</span> <span class="n">storev0inletbc</span><span class="p">(:,</span> <span class="p">:,</span> <span class="n">nstepread</span><span class="p">)</span>
               <span class="n">w0inletbc</span><span class="p">(:,</span> <span class="p">:)</span> <span class="o">=</span> <span class="n">storew0inletbc</span><span class="p">(:,</span> <span class="p">:,</span> <span class="n">nstepread</span><span class="p">)</span>
               <span class="n">uminletbc</span><span class="p">(:,</span> <span class="p">:)</span> <span class="o">=</span> <span class="n">storeu0inletbc</span><span class="p">(:,</span> <span class="p">:,</span> <span class="n">nstepread</span><span class="p">)</span>
               <span class="n">vminletbc</span><span class="p">(:,</span> <span class="p">:)</span> <span class="o">=</span> <span class="n">storev0inletbc</span><span class="p">(:,</span> <span class="p">:,</span> <span class="n">nstepread</span><span class="p">)</span>
               <span class="n">wminletbc</span><span class="p">(:,</span> <span class="p">:)</span> <span class="o">=</span> <span class="n">storew0inletbc</span><span class="p">(:,</span> <span class="p">:,</span> <span class="n">nstepread</span><span class="p">)</span>
               <span class="k">if</span> <span class="p">(</span><span class="n">ltempeq</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                  </span><span class="n">t0inletbc</span><span class="p">(:,</span> <span class="p">:)</span> <span class="o">=</span> <span class="n">storet0inletbc</span><span class="p">(:,</span> <span class="p">:,</span> <span class="n">nstepread</span><span class="p">)</span>
                  <span class="n">tminletbc</span><span class="p">(:,</span> <span class="p">:)</span> <span class="o">=</span> <span class="n">storet0inletbc</span><span class="p">(:,</span> <span class="p">:,</span> <span class="n">nstepread</span><span class="p">)</span>
               <span class="k">end if</span>
               <span class="c">! determine bulk velocity</span>
               <span class="k">call </span><span class="n">slabsum</span><span class="p">(</span><span class="n">uaverage</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span><span class="p">,</span> <span class="n">u0</span><span class="p">,</span> <span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ie</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">jb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">je</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">kb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ie</span><span class="p">,</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span><span class="p">)</span>
               <span class="n">uaverage</span> <span class="o">=</span> <span class="n">uaverage</span><span class="o">/</span><span class="p">((</span><span class="n">ie</span> <span class="o">-</span> <span class="n">ib</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">jge</span> <span class="o">-</span> <span class="n">jgb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="c">! this gives the i-j-averaged velocity (only correct for equidistant grid?)</span>
               <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
                  <span class="n">uaverage</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">uaverage</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">dzf</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
               <span class="k">end do</span>
<span class="k">               </span><span class="n">ubulk</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">uaverage</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">zh</span><span class="p">(</span><span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">zh</span><span class="p">(</span><span class="n">kb</span><span class="p">))</span> <span class="c">! volume-averaged u-velocity</span>
               <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Modstartup: ubulk=&#39;</span><span class="p">,</span> <span class="n">ubulk</span>

            <span class="n">elseif</span> <span class="p">(</span><span class="n">idriver</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="k">then</span> <span class="c">! idriver</span>

               <span class="k">call </span><span class="n">readdriverfile</span>
               <span class="k">call </span><span class="n">drivergen</span>

              <span class="c">!call slabsum(uaverage,kb,ke,u0,ib-1,ie+1,jb-1,je+1,kb-1,ke+1,ib,ie,jb,je,kb,ke)</span>
              <span class="c">!uaverage = uaverage / ((ie-ib+1)*(jge-jgb+1))  ! this gives the i-j-averaged velocity (only correct for equidistant grid?)</span>
              <span class="k">call </span><span class="n">avexy_ibm</span><span class="p">(</span><span class="n">uaverage</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">),</span><span class="n">u0</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">),</span><span class="n">ib</span><span class="p">,</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">,</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="p">,</span><span class="n">ih</span><span class="p">,</span><span class="n">jh</span><span class="p">,</span><span class="n">kh</span><span class="p">,</span><span class="n">IIu</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">),</span><span class="n">IIus</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">),.</span><span class="n">false</span><span class="p">.)</span>
              <span class="k">do </span><span class="n">k</span><span class="o">=</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span>
                <span class="n">uaverage</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">uaverage</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">dzf</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
              <span class="k">end do</span>
<span class="k">              </span><span class="n">ubulk</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">uaverage</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">zh</span><span class="p">(</span><span class="n">ke</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">zh</span><span class="p">(</span><span class="n">kb</span><span class="p">))</span> <span class="c">!volume-averaged u-velocity</span>
              <span class="k">if</span> <span class="p">(</span><span class="n">myid</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                 write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Modstartup: ubulk=&#39;</span><span class="p">,</span><span class="n">ubulk</span>
              <span class="k">end if</span>

<span class="k">            end if</span> <span class="c">! iinletgen/idriver</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">lper2inout</span><span class="p">)</span> <span class="k">then</span> <span class="c">! if the restart starts from a periodic simulation to in/outflow, lper2inout should be set to .true.</span>
               <span class="k">if</span> <span class="p">(</span><span class="n">myid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                  write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;per2inout=.true. -&gt; reading inlet profile from prof.inp.XXX and scalar.inp.XXX&#39;</span>
                  <span class="k">open</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="s1">&#39;prof.inp.&#39;</span><span class="o">//</span><span class="n">cexpnr</span><span class="p">)</span> <span class="c">!  read the inlet profile from prof.inp</span>
                  <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="s1">&#39;(a80)&#39;</span><span class="p">)</span> <span class="n">chmess</span>
                  <span class="k">write</span> <span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="s1">&#39;(a80)&#39;</span><span class="p">)</span> <span class="n">chmess</span>
                  <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="s1">&#39;(a80)&#39;</span><span class="p">)</span> <span class="n">chmess</span>

                  <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
                     <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="p">&amp;</span>
                        <span class="n">height</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                        <span class="n">thlprof</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                        <span class="n">qtprof</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                        <span class="n">uprof</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                        <span class="n">vprof</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                        <span class="n">e12prof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
                  <span class="k">end do</span>
<span class="k">                  </span><span class="n">svprof</span> <span class="o">=</span> <span class="mf">0.</span>
                  <span class="k">if</span> <span class="p">(</span><span class="n">nsv</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                     open</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="s1">&#39;scalar.inp.&#39;</span><span class="o">//</span><span class="n">cexpnr</span><span class="p">)</span>
                     <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="s1">&#39;(a80)&#39;</span><span class="p">)</span> <span class="n">chmess</span>
                     <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="s1">&#39;(a80)&#39;</span><span class="p">)</span> <span class="n">chmess</span>
                     <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
                        <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="p">&amp;</span>
                           <span class="n">height</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                           <span class="p">(</span><span class="n">svprof</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nsv</span><span class="p">)</span>
                     <span class="k">end do</span>
<span class="k">                     open</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="s1">&#39;scalar.inp.&#39;</span><span class="o">//</span><span class="n">cexpnr</span><span class="p">)</span>
                     <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;height   sv(1) --------- sv(nsv) &#39;</span>
                     <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">ke</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>
                        <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="p">&amp;</span>
                           <span class="n">height</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                           <span class="p">(</span><span class="n">svprof</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nsv</span><span class="p">)</span>
                     <span class="k">end do</span>

<span class="k">                  end if</span>
<span class="k">               end if</span> <span class="c">! end if myid==0</span>

               <span class="c">! MPI broadcast numbers reading</span>
               <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">thlprof</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
               <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">uprof</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
               <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">vprof</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
               <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">e12prof</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
               <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">qtprof</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
               <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">svprof</span><span class="p">,</span> <span class="p">(</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span> <span class="o">-</span> <span class="p">(</span><span class="n">kb</span> <span class="o">-</span> <span class="n">kh</span><span class="p">))</span><span class="o">*</span><span class="n">nsv</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>

            <span class="k">else if</span> <span class="p">(</span><span class="n">linoutflow</span><span class="p">)</span> <span class="k">then</span> <span class="c">! restart of inoutflow simulation: reproduce inlet boundary condition from restartfile</span>
               <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="n">jb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">je</span> <span class="o">+</span> <span class="mi">1</span>
                  <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span>
                     <span class="n">uprof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">u0</span><span class="p">(</span><span class="n">ib</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
                     <span class="n">vprof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">v0</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">v0</span><span class="p">(</span><span class="n">ib</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span>
                     <span class="n">thlprof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">thl0</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">thl0</span><span class="p">(</span><span class="n">ib</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span>
                     <span class="n">qtprof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">qt0</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">qt0</span><span class="p">(</span><span class="n">ib</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span>
                     <span class="n">e12prof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">e120</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">e120</span><span class="p">(</span><span class="n">ib</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span>
                     <span class="k">do </span><span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nsv</span>
                        <span class="n">svprof</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">sv0</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">sv0</span><span class="p">(</span><span class="n">ib</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span>
                     <span class="n">enddo</span>
                  <span class="n">enddo</span>
               <span class="n">enddo</span>
               <span class="c">! outlet bulk velocity</span>
               <span class="k">call </span><span class="n">slabsum</span><span class="p">(</span><span class="n">uaverage</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span><span class="p">,</span> <span class="n">u0</span><span class="p">,</span> <span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ie</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">jb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">je</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">kb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ie</span><span class="p">,</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span><span class="p">)</span>
               <span class="n">uaverage</span> <span class="o">=</span> <span class="n">uaverage</span><span class="o">/</span><span class="p">((</span><span class="n">ie</span> <span class="o">-</span> <span class="n">ib</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">jge</span> <span class="o">-</span> <span class="n">jgb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="c">! this gives the i-j-averaged velocity (only correct for equidistant grid?)</span>
               <span class="c">! determine bulk velocity</span>
               <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
                  <span class="n">uaverage</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">uaverage</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">dzf</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
               <span class="k">end do</span>
<span class="k">               </span><span class="n">ubulk</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">uaverage</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">zh</span><span class="p">(</span><span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">zh</span><span class="p">(</span><span class="n">kb</span><span class="p">))</span> <span class="c">! volume-averaged u-velocity</span>
               <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Modstartup: ubulk=&#39;</span><span class="p">,</span> <span class="n">ubulk</span>
            <span class="k">else</span> <span class="c">! else per2per... read svprof regardless...</span>

            <span class="c">! tg3315 read svprof (but do not use regardless of above...)</span>
              <span class="n">svprof</span> <span class="o">=</span> <span class="mf">0.</span>
              <span class="k">if</span> <span class="p">(</span><span class="n">myid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                 if</span> <span class="p">(</span><span class="n">nsv</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                    open</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="s1">&#39;scalar.inp.&#39;</span><span class="o">//</span><span class="n">cexpnr</span><span class="p">)</span>
                    <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="s1">&#39;(a80)&#39;</span><span class="p">)</span> <span class="n">chmess</span>
                    <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="s1">&#39;(a80)&#39;</span><span class="p">)</span> <span class="n">chmess</span>
                    <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
                       <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="p">&amp;</span>
                          <span class="n">height</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                          <span class="p">(</span><span class="n">svprof</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nsv</span><span class="p">)</span>
                    <span class="k">end do</span>
<span class="k">                    open</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="s1">&#39;scalar.inp.&#39;</span><span class="o">//</span><span class="n">cexpnr</span><span class="p">)</span>
                    <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;height   sv(1) --------- sv(nsv) &#39;</span>
                    <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">ke</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>
                       <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="p">&amp;</span>
                          <span class="n">height</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                          <span class="p">(</span><span class="n">svprof</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nsv</span><span class="p">)</span>
                    <span class="k">end do</span>

<span class="k">                 end if</span>
<span class="k">              end if</span> <span class="c">! end if myid==0</span>

              <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">svprof</span><span class="p">,</span> <span class="p">(</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span> <span class="o">-</span> <span class="p">(</span><span class="n">kb</span> <span class="o">-</span> <span class="n">kh</span><span class="p">))</span><span class="o">*</span><span class="n">nsv</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
          
              <span class="k">if</span> <span class="p">(</span><span class="n">nsv</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span> <span class="c">!tg3315 set these variables here for now and repeat for warmstart</span>

                <span class="k">allocate</span><span class="p">(</span><span class="n">sv_top</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nsv</span><span class="p">))</span>
                <span class="n">sv_top</span><span class="p">(:)</span> <span class="o">=</span> <span class="n">svprof</span><span class="p">(</span><span class="n">ke</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">nsv</span><span class="p">)</span>

                <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">sv_top</span><span class="p">,</span> <span class="n">nsv</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>

              <span class="k">end if</span>

<span class="k">            end if</span> <span class="c">! end if lper2inout</span>

            <span class="n">u0av</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="n">v0av</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="n">thl0av</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="n">qt0av</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="n">th0av</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="n">sv0av</span> <span class="o">=</span> <span class="mf">0.</span>

            <span class="c">! call slabsum(u0av  ,kb,ke+kh,u0(:,:,kb:ke+kh)  ,ib-ih,ie+ih,jb-jh,je+jh,kb,ke+kh,ib,ie,jb,je,kb,ke+kh)</span>
            <span class="k">call </span><span class="n">avexy_ibm</span><span class="p">(</span><span class="n">u0av</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),</span><span class="n">u0</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),</span><span class="n">ib</span><span class="p">,</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">,</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="p">,</span><span class="n">ih</span><span class="p">,</span><span class="n">jh</span><span class="p">,</span><span class="n">kh</span><span class="p">,</span><span class="n">IIu</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),</span><span class="n">IIus</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),.</span><span class="n">false</span><span class="p">.)</span>
            <span class="c">! call slabsum(v0av  ,kb,ke+kh,v0(:,:,kb:ke+kh)  ,ib-ih,ie+ih,jb-jh,je+jh,kb,ke+kh,ib,ie,jb,je,kb,ke+kh)</span>
            <span class="k">call </span><span class="n">avexy_ibm</span><span class="p">(</span><span class="n">v0av</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),</span><span class="n">v0</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),</span><span class="n">ib</span><span class="p">,</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">,</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="p">,</span><span class="n">ih</span><span class="p">,</span><span class="n">jh</span><span class="p">,</span><span class="n">kh</span><span class="p">,</span><span class="n">IIv</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),</span><span class="n">IIvs</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),.</span><span class="n">false</span><span class="p">.)</span>
            <span class="c">! call slabsum(thl0av,kb,ke+kh,thl0(:,:,kb:ke+kh),ib-ih,ie+ih,jb-jh,je+jh,kb,ke+kh,ib,ie,jb,je,kb,ke+kh)</span>
            <span class="k">call </span><span class="n">avexy_ibm</span><span class="p">(</span><span class="n">thl0av</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),</span><span class="n">thl0</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),</span><span class="n">ib</span><span class="p">,</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">,</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="p">,</span><span class="n">ih</span><span class="p">,</span><span class="n">jh</span><span class="p">,</span><span class="n">kh</span><span class="p">,</span><span class="n">IIc</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),</span><span class="n">IIcs</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),.</span><span class="n">false</span><span class="p">.)</span>
            <span class="c">! call slabsum(qt0av,kb,ke+kh,qt0(:,:,kb:ke+kh),ib-ih,ie+ih,jb-jh,je+jh,kb,ke+kh,ib,ie,jb,je,kb,ke+kh)</span>
            <span class="k">call </span><span class="n">avexy_ibm</span><span class="p">(</span><span class="n">qt0av</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),</span><span class="n">qt0</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),</span><span class="n">ib</span><span class="p">,</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">,</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="p">,</span><span class="n">ih</span><span class="p">,</span><span class="n">jh</span><span class="p">,</span><span class="n">kh</span><span class="p">,</span><span class="n">IIc</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),</span><span class="n">IIcs</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),.</span><span class="n">false</span><span class="p">.)</span>
            <span class="k">do </span><span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nsv</span>
               <span class="c">! call slabsum(sv0av(kb,n),kb,ke+kh,sv0(ib-ih,jb-jh,kb,n),ib-ih,ie+ih,jb-jh,je+jh,kb,ke+kh,ib,ie,jb,je,kb,ke+kh)</span>
               <span class="k">call </span><span class="n">avexy_ibm</span><span class="p">(</span><span class="n">sv0av</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">khc</span><span class="p">,</span><span class="n">n</span><span class="p">),</span><span class="n">sv0</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">khc</span><span class="p">,</span><span class="n">n</span><span class="p">),</span><span class="n">ib</span><span class="p">,</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">,</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="p">,</span><span class="n">ih</span><span class="p">,</span><span class="n">jh</span><span class="p">,</span><span class="n">kh</span><span class="p">,</span><span class="n">IIc</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">khc</span><span class="p">),</span><span class="n">IIcs</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">khc</span><span class="p">),.</span><span class="n">false</span><span class="p">.)</span>
            <span class="k">end do</span>

            <span class="c">! CvH - only do this for fixed timestepping. In adaptive dt comes from restartfile</span>
            <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">ladaptive</span><span class="p">)</span> <span class="n">dt</span> <span class="o">=</span> <span class="n">dtmax</span>
            <span class="c">!  call boundary</span>
         <span class="k">end if</span> <span class="c">! lwarmstart</span>
      <span class="k">end if</span> <span class="c">! not lstratstart</span>
      <span class="c">!-----------------------------------------------------------------</span>
      <span class="c">!    2.1 read and initialise fields</span>
      <span class="c">!-----------------------------------------------------------------</span>

      <span class="k">if</span> <span class="p">(</span><span class="n">myid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         open</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="s1">&#39;lscale.inp.&#39;</span><span class="o">//</span><span class="n">cexpnr</span><span class="p">)</span>
         <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="s1">&#39;(a80)&#39;</span><span class="p">)</span> <span class="n">chmess</span>
         <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="s1">&#39;(a80)&#39;</span><span class="p">)</span> <span class="n">chmess</span>
         <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39; height  u_geo  v_geo  pgx  pgy  subs     &#39;</span> <span class="p">&amp;</span>
            <span class="p">,</span> <span class="s1">&#39;   dqtdx      dqtdy        dqtdtls     thl_rad &#39;</span>
         <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
            <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="p">&amp;</span>
               <span class="n">height</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
               <span class="n">ug</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
               <span class="n">vg</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
               <span class="n">pgx</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
               <span class="n">pgy</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
               <span class="n">wfls</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
               <span class="n">dqtdxls</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
               <span class="n">dqtdyls</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
               <span class="n">dqtdtls</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
               <span class="n">thlpcar</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
         <span class="k">end do</span>
<span class="k">         close</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">)</span>

         <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">ke</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>
            <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;(3f7.1,5e12.4)&#39;</span><span class="p">)</span> <span class="p">&amp;</span>
               <span class="n">height</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
               <span class="n">ug</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
               <span class="n">vg</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
               <span class="n">pgx</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
               <span class="n">pgy</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
               <span class="n">wfls</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
               <span class="n">dqtdxls</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
               <span class="n">dqtdyls</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
               <span class="n">dqtdtls</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
               <span class="n">thlpcar</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
         <span class="k">end do</span>

<span class="k">      end if</span> <span class="c">! end myid==0</span>

      <span class="c">! MPI broadcast variables read in</span>

      <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">ug</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
      <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">vg</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
      <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">pgx</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
      <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">pgy</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
      <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">wfls</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
      <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">dqtdxls</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
      <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">dqtdyls</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
      <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">dqtdtls</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
      <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">thlpcar</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>

      <span class="c">!-----------------------------------------------------------------</span>
      <span class="c">!    2.3 make large-scale horizontal pressure gradient</span>
      <span class="c">!-----------------------------------------------------------------</span>

      <span class="c">!******include rho if rho = rho(z) /= 1.0 ***********</span>

      <span class="k">if</span> <span class="p">(</span><span class="n">lprofforc</span><span class="p">)</span> <span class="k">then</span> <span class="c">!tg3315</span>
         <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
            <span class="n">dpdxl</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">pgx</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">-</span> <span class="n">dpdx</span> <span class="c">!-om23_gs*ug(k)-pgx(k)-dpdx</span>
            <span class="n">dpdyl</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">pgy</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
         <span class="k">end do</span>
<span class="k">      else</span>
<span class="k">         do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
            <span class="c">!dpdxl(k) =  om23_gs*vg(k)</span>
            <span class="c">!dpdyl(k) = -om23_gs*ug(k)</span>
            <span class="c">!dpdxl(k) =  -ug(k)</span>
            <span class="c">!dpdyl(k) =  -vg(k)</span>
            <span class="n">dpdxl</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">om23_gs</span><span class="o">*</span><span class="n">vg</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">-</span> <span class="n">pgx</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">-</span> <span class="n">dpdx</span> <span class="c">!corriolis forcing and pressure gradient</span>
            <span class="n">dpdyl</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">om23_gs</span><span class="o">*</span><span class="n">ug</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">-</span> <span class="n">pgy</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
         <span class="k">end do</span>
<span class="k">      </span><span class="n">endif</span>

      <span class="c">!-----------------------------------------------------------------</span>
      <span class="c">!    2.4 large-scale subsidence, reintroduced ILS13 05.06.2014</span>
      <span class="c">!-----------------------------------------------------------------</span>

      <span class="n">whls</span><span class="p">(</span><span class="n">kb</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0</span>
      <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ke</span>
         <span class="n">whls</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">wfls</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">dzf</span><span class="p">(</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">wfls</span><span class="p">(</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">dzf</span><span class="p">(</span><span class="n">k</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">dzh</span><span class="p">(</span><span class="n">k</span><span class="p">))</span>
      <span class="k">end do</span>
<span class="k">      </span><span class="n">whls</span><span class="p">(</span><span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">wfls</span><span class="p">(</span><span class="n">ke</span><span class="p">)</span> <span class="o">+</span> <span class="n">dzf</span><span class="p">(</span><span class="n">ke</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">wfls</span><span class="p">(</span><span class="n">ke</span><span class="p">)</span> <span class="o">-</span> <span class="n">wfls</span><span class="p">(</span><span class="n">ke</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="n">dzh</span><span class="p">(</span><span class="n">ke</span><span class="p">))</span> <span class="c">! tg3315 31/07/18 removed a 0.5</span>

      <span class="c">!    idtmax = floor(dtmax/tres)</span>
      <span class="n">btime</span> <span class="o">=</span> <span class="n">timee</span>
      <span class="c">!    timeleft=ceiling(runtime/tres)</span>
      <span class="n">timeleft</span> <span class="o">=</span> <span class="n">runtime</span>
      <span class="n">dt_lim</span> <span class="o">=</span> <span class="n">timeleft</span>
      <span class="c">!    write(6,*) &#39;real(dt)*tres= &#39;,rdt, &#39; dtmax/100= &#39;,dtmax/100</span>
      <span class="k">if</span> <span class="p">((</span><span class="n">lwarmstart</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">lstratstart</span><span class="p">))</span> <span class="k">then</span> <span class="c">! tg3315 to have cumulative number on restart files</span>
         <span class="k">read</span> <span class="p">(</span><span class="n">startfile</span><span class="p">(</span><span class="mi">6</span><span class="p">:</span><span class="mi">13</span><span class="p">),</span> <span class="s1">&#39;(i4)&#39;</span><span class="p">)</span> <span class="n">ntrun</span>
         <span class="c">! ntrun = ichar(startfile(6:13))</span>
      <span class="k">else</span>
<span class="k">         </span><span class="n">ntrun</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="k">end if</span>
<span class="k">      </span><span class="n">ntimee</span> <span class="o">=</span> <span class="nb">nint</span><span class="p">(</span><span class="n">timee</span><span class="o">/</span><span class="n">dtmax</span><span class="p">)</span>
      <span class="n">tnextrestart</span> <span class="o">=</span> <span class="n">btime</span> <span class="o">+</span> <span class="n">trestart</span>
      <span class="n">tnextfielddump</span> <span class="o">=</span> <span class="n">btime</span> <span class="o">+</span> <span class="n">tfielddump</span>
      <span class="k">deallocate</span> <span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="n">th0av</span><span class="p">)</span>

      <span class="c">!    call boundary</span>

   <span class="k">end subroutine </span><span class="n">readinitfiles</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2021 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> uDALES was developed by The uDALES Team</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>