<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
    <meta name="description" content="Documentation for uDALES">
   
    <meta name="author" content="The uDALES Team" >
    <link rel="icon" href="../favicon.png">

    <title>modfields.f90 &ndash; uDALES</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">uDALES </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/dalesurban.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/dalesurban.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>modfields.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 6.4% of total for source files.">904 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/modfields.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">modfields.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/modfields.html">modfields</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/modfields.f90.html#src">modfields.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~modfields.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilemodfieldsf90EfferentGraph" width="305pt" height="32pt"
 viewBox="0.00 0.00 305.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~modfields.f90~~EfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>sourcefile~~modfields.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 301,-28 301,4 -4,4"/>
<!-- sourcefile~modfields.f90 -->
<g id="sourcefile~~modfields.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~modfields.f90</title>
<polygon fill="none" stroke="#000000" points="297,-24 221,-24 221,0 297,0 297,-24"/>
<text text-anchor="middle" x="259" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">modfields.f90</text>
</g>
<!-- sourcefile~modglobal.f90 -->
<g id="sourcefile~~modfields.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~modglobal.f90</title>
<g id="a_sourcefile~~modfields.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/modglobal.f90.html" xlink:title="modglobal.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="185,-24 105,-24 105,0 185,0 185,-24"/>
<text text-anchor="middle" x="145" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modglobal.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modfields.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modfields.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~modfields.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M220.7225,-12C212.6289,-12 203.9688,-12 195.5024,-12"/>
<polygon fill="#ff0000" stroke="#ff0000" points="195.3225,-8.5001 185.3225,-12 195.3224,-15.5001 195.3225,-8.5001"/>
</g>
<!-- sourcefile~modmpi.f90 -->
<g id="sourcefile~~modfields.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~modmpi.f90</title>
<g id="a_sourcefile~~modfields.f90~~EfferentGraph_node3"><a xlink:href=".././sourcefile/modmpi.f90.html" xlink:title="modmpi.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="69,-24 0,-24 0,0 69,0 69,-24"/>
<text text-anchor="middle" x="34.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modmpi.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modglobal.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modfields.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~modglobal.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M104.7944,-12C96.4589,-12 87.6289,-12 79.1455,-12"/>
<polygon fill="#ff0000" stroke="#ff0000" points="79.0261,-8.5001 69.0261,-12 79.0261,-15.5001 79.0261,-8.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="190pt" height="32pt"
 viewBox="0.00 0.00 190.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 186,-28 186,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="67,-24 0,-24 0,0 67,0 67,-24"/>
<text text-anchor="middle" x="33.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="182,-24 85,-24 85,0 182,0 182,-24"/>
<text text-anchor="middle" x="133.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~modfields.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilemodfieldsf90AfferentGraph" width="641pt" height="467pt"
 viewBox="0.00 0.00 641.00 466.85" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~modfields.f90~~AfferentGraph" class="graph" transform="scale(.7317 .7317) rotate(0) translate(4 634)">
<title>sourcefile~~modfields.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-634 872,-634 872,4 -4,4"/>
<!-- sourcefile~modfields.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~modfields.f90</title>
<polygon fill="none" stroke="#000000" points="76,-230 0,-230 0,-206 76,-206 76,-230"/>
<text text-anchor="middle" x="38" y="-215.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">modfields.f90</text>
</g>
<!-- sourcefile~modpois.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~modpois.f90</title>
<g id="a_sourcefile~~modfields.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/modpois.f90.html" xlink:title="modpois.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="594.5,-548 523.5,-548 523.5,-524 594.5,-524 594.5,-548"/>
<text text-anchor="middle" x="559" y="-533.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modpois.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modpois.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~modpois.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M523.2421,-547.1362C482.7593,-559.5705 420.9241,-577.9745 409.5,-578"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M409.5,-578C353.5001,-578.1249 339.4996,-577.7778 283.5,-578"/>
</g>
<!-- sourcefile~modboundary.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_node7" class="node">
<title>sourcefile~modboundary.f90</title>
<g id="a_sourcefile~~modfields.f90~~AfferentGraph_node7"><a xlink:href=".././sourcefile/modboundary.f90.html" xlink:title="modboundary.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="458,-547 361,-547 361,-523 458,-523 458,-547"/>
<text text-anchor="middle" x="409.5" y="-532.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modboundary.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modpois.f90&#45;&gt;sourcefile~modboundary.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge29" class="edge">
<title>sourcefile~modpois.f90&#45;&gt;sourcefile~modboundary.f90</title>
<path fill="none" stroke="#91ff00" stroke-dasharray="5,2" d="M523.191,-535.7605C506.7188,-535.6503 486.7463,-535.5167 468.1657,-535.3924"/>
<polygon fill="#91ff00" stroke="#91ff00" points="468.0406,-531.8916 458.0174,-535.3245 467.9937,-538.8914 468.0406,-531.8916"/>
</g>
<!-- sourcefile~modibm.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~modibm.f90</title>
<g id="a_sourcefile~~modfields.f90~~AfferentGraph_node3"><a xlink:href=".././sourcefile/modibm.f90.html" xlink:title="modibm.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="193.5,-310 124.5,-310 124.5,-286 193.5,-286 193.5,-310"/>
<text text-anchor="middle" x="159" y="-295.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modibm.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modibm.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~modibm.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M135.7154,-285.8686C128.0433,-281.6744 119.5471,-276.8146 112,-272 94.6783,-260.9499 75.9942,-247.3008 61.7338,-236.4898"/>
<polygon fill="#ff0000" stroke="#ff0000" points="63.5471,-233.4702 53.4781,-230.1738 59.2937,-239.0298 63.5471,-233.4702"/>
</g>
<!-- sourcefile~modsubgrid.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~modsubgrid.f90</title>
<g id="a_sourcefile~~modfields.f90~~AfferentGraph_node4"><a xlink:href=".././sourcefile/modsubgrid.f90.html" xlink:title="modsubgrid.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="602.5,-590 515.5,-590 515.5,-566 602.5,-566 602.5,-590"/>
<text text-anchor="middle" x="559" y="-575.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modsubgrid.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modsubgrid.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~modsubgrid.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M515.4968,-577.9489C485.6679,-577.9263 445.1878,-577.9204 409.5,-578"/>
</g>
<!-- sourcefile~modsubgrid.f90&#45;&gt;sourcefile~modboundary.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge32" class="edge">
<title>sourcefile~modsubgrid.f90&#45;&gt;sourcefile~modboundary.f90</title>
<path fill="none" stroke="#91ff00" stroke-dasharray="5,2" d="M516.9581,-565.9077C499.5348,-560.8963 479.1583,-555.0355 460.861,-549.7727"/>
<polygon fill="#91ff00" stroke="#91ff00" points="461.8042,-546.4022 451.2264,-547.0016 459.8693,-553.1295 461.8042,-546.4022"/>
</g>
<!-- sourcefile~advection.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~advection.f90</title>
<g id="a_sourcefile~~modfields.f90~~AfferentGraph_node5"><a xlink:href=".././sourcefile/advection.f90.html" xlink:title="advection.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="197,-230 121,-230 121,-206 197,-206 197,-230"/>
<text text-anchor="middle" x="159" y="-215.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">advection.f90</text>
</a>
</g>
</g>
<!-- sourcefile~advection.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~advection.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M120.7148,-218C109.7949,-218 97.7537,-218 86.3182,-218"/>
<polygon fill="#ff0000" stroke="#ff0000" points="86.0361,-214.5001 76.0361,-218 86.0361,-221.5001 86.0361,-214.5001"/>
</g>
<!-- sourcefile~advec_2nd.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~advec_2nd.f90</title>
<g id="a_sourcefile~~modfields.f90~~AfferentGraph_node6"><a xlink:href=".././sourcefile/advec_2nd.f90.html" xlink:title="advec_2nd.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="325,-350 242,-350 242,-326 325,-326 325,-350"/>
<text text-anchor="middle" x="283.5" y="-335.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">advec_2nd.f90</text>
</a>
</g>
</g>
<!-- sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M263.0381,-350.0024C230.1943,-368.9231 168.4255,-402.9608 159,-397"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M159,-397C98.7251,-358.8816 61.24,-278.6519 45.9394,-239.8858"/>
<polygon fill="#ff0000" stroke="#ff0000" points="49.048,-238.2149 42.2117,-230.1208 42.5083,-240.7115 49.048,-238.2149"/>
</g>
<!-- sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modibm.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge25" class="edge">
<title>sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modibm.f90</title>
<path fill="none" stroke="#ff4800" stroke-dasharray="5,2" d="M246.1459,-325.9987C232.7743,-321.7026 217.5678,-316.817 203.6423,-312.3429"/>
<polygon fill="#ff4800" stroke="#ff4800" points="204.3646,-308.8988 193.7733,-309.1721 202.2234,-315.5633 204.3646,-308.8988"/>
</g>
<!-- sourcefile~modboundary.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~modboundary.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M387.9571,-547.1506C363.4573,-559.8127 321.8685,-577.8477 283.5,-578"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M283.5,-578C228.1671,-578.2196 206.4678,-606.4357 159,-578"/>
</g>
<!-- sourcefile~moddriver.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_node13" class="node">
<title>sourcefile~moddriver.f90</title>
<g id="a_sourcefile~~modfields.f90~~AfferentGraph_node13"><a xlink:href=".././sourcefile/moddriver.f90.html" xlink:title="moddriver.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="323,-548 244,-548 244,-524 323,-524 323,-548"/>
<text text-anchor="middle" x="283.5" y="-533.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">moddriver.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modboundary.f90&#45;&gt;sourcefile~moddriver.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge41" class="edge">
<title>sourcefile~modboundary.f90&#45;&gt;sourcefile~moddriver.f90</title>
<path fill="none" stroke="#00daff" stroke-dasharray="5,2" d="M360.7851,-535.3866C351.7284,-535.4585 342.2559,-535.5337 333.171,-535.6058"/>
<polygon fill="#00daff" stroke="#00daff" points="333.0932,-532.1062 323.1213,-535.6855 333.1488,-539.106 333.0932,-532.1062"/>
</g>
<!-- sourcefile~modinlet.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_node15" class="node">
<title>sourcefile~modinlet.f90</title>
<g id="a_sourcefile~~modfields.f90~~AfferentGraph_node15"><a xlink:href=".././sourcefile/modinlet.f90.html" xlink:title="modinlet.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="319,-506 248,-506 248,-482 319,-482 319,-506"/>
<text text-anchor="middle" x="283.5" y="-491.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modinlet.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modboundary.f90&#45;&gt;sourcefile~modinlet.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge45" class="edge">
<title>sourcefile~modboundary.f90&#45;&gt;sourcefile~modinlet.f90</title>
<path fill="none" stroke="#0048ff" stroke-dasharray="5,2" d="M372.3773,-522.9204C358.6938,-518.4678 343.039,-513.3738 328.7191,-508.7142"/>
<polygon fill="#0048ff" stroke="#0048ff" points="329.6516,-505.337 319.0593,-505.5709 327.4855,-511.9935 329.6516,-505.337"/>
</g>
<!-- sourcefile~modsave.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_node8" class="node">
<title>sourcefile~modsave.f90</title>
<g id="a_sourcefile~~modfields.f90~~AfferentGraph_node8"><a xlink:href=".././sourcefile/modsave.f90.html" xlink:title="modsave.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="196,-487 122,-487 122,-463 196,-463 196,-487"/>
<text text-anchor="middle" x="159" y="-472.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modsave.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modsave.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~modsave.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M148.5882,-462.917C138.2871,-450.5192 122.5703,-430.3589 112,-411 79.9127,-352.2336 55.2892,-276.6074 44.2946,-239.9142"/>
<polygon fill="#ff0000" stroke="#ff0000" points="47.6276,-238.8422 41.443,-230.2398 40.9132,-240.8214 47.6276,-238.8422"/>
</g>
<!-- sourcefile~modstatsdump.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_node9" class="node">
<title>sourcefile~modstatsdump.f90</title>
<g id="a_sourcefile~~modfields.f90~~AfferentGraph_node9"><a xlink:href=".././sourcefile/modstatsdump.f90.html" xlink:title="modstatsdump.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="761,-590 660,-590 660,-566 761,-566 761,-590"/>
<text text-anchor="middle" x="710.5" y="-575.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modstatsdump.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge8" class="edge">
<title>sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M679.4652,-590.0184C649.2511,-600.7977 601.7615,-615.3208 559,-618"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M559,-618C490.353,-622.3011 478.2815,-577.8466 409.5,-578"/>
</g>
<!-- sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modsubgrid.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge28" class="edge">
<title>sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modsubgrid.f90</title>
<path fill="none" stroke="#ff9100" stroke-dasharray="5,2" d="M659.6312,-578C644.6847,-578 628.2842,-578 613.1411,-578"/>
<polygon fill="#ff9100" stroke="#ff9100" points="612.8916,-574.5001 602.8916,-578 612.8916,-581.5001 612.8916,-574.5001"/>
</g>
<!-- sourcefile~modstatistics.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_node22" class="node">
<title>sourcefile~modstatistics.f90</title>
<g id="a_sourcefile~~modfields.f90~~AfferentGraph_node22"><a xlink:href=".././sourcefile/modstatistics.f90.html" xlink:title="modstatistics.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="455.5,-630 363.5,-630 363.5,-606 455.5,-606 455.5,-630"/>
<text text-anchor="middle" x="409.5" y="-615.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modstatistics.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modstatistics.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge49" class="edge">
<title>sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modstatistics.f90</title>
<path fill="none" stroke="#ff0048" stroke-dasharray="5,2" d="M559,-618C528.2005,-619.9297 493.7616,-620.067 465.7078,-619.6604"/>
<polygon fill="#ff0048" stroke="#ff0048" points="465.7383,-616.1606 455.6797,-619.4884 465.6181,-623.1595 465.7383,-616.1606"/>
</g>
<!-- sourcefile~modchem.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_node10" class="node">
<title>sourcefile~modchem.f90</title>
<g id="a_sourcefile~~modfields.f90~~AfferentGraph_node10"><a xlink:href=".././sourcefile/modchem.f90.html" xlink:title="modchem.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="198,-188 120,-188 120,-164 198,-164 198,-188"/>
<text text-anchor="middle" x="159" y="-173.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modchem.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modchem.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge9" class="edge">
<title>sourcefile~modchem.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M124.3263,-188.0355C111.289,-192.5608 96.282,-197.7699 82.475,-202.5624"/>
<polygon fill="#ff0000" stroke="#ff0000" points="80.9782,-199.377 72.6788,-205.9627 83.2736,-205.99 80.9782,-199.377"/>
</g>
<!-- sourcefile~modstartup.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_node11" class="node">
<title>sourcefile~modstartup.f90</title>
<g id="a_sourcefile~~modfields.f90~~AfferentGraph_node11"><a xlink:href=".././sourcefile/modstartup.f90.html" xlink:title="modstartup.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="753,-469 668,-469 668,-445 753,-445 753,-469"/>
<text text-anchor="middle" x="710.5" y="-454.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modstartup.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge10" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M667.9975,-453.2987C637.4173,-451.5987 595.3316,-451.2397 559,-458"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M559,-458C491.8095,-470.5022 477.3457,-485.7643 409.5,-494"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M409.5,-494C379.8703,-497.5967 184.0055,-413.2966 159,-397"/>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modpois.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge22" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modpois.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M687.0982,-469.0004C678.5619,-473.3905 668.8372,-478.4065 660,-483 636.7926,-495.063 610.6465,-508.7869 590.772,-519.2467"/>
<polygon fill="#ff0000" stroke="#ff0000" points="589.0554,-516.1949 581.8378,-523.951 592.3168,-522.3887 589.0554,-516.1949"/>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modsubgrid.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge27" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modsubgrid.f90</title>
<path fill="none" stroke="#ff9100" stroke-dasharray="5,2" d="M679.2691,-469.1111C672.3396,-472.8208 665.4457,-477.4293 660,-483 634.433,-509.1535 651.6109,-533.0142 624,-557 620.3853,-560.1401 616.2941,-562.812 611.9664,-565.0854"/>
<polygon fill="#ff9100" stroke="#ff9100" points="610.5,-561.9072 602.8282,-569.2144 613.3823,-568.2863 610.5,-561.9072"/>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modboundary.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge30" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modboundary.f90</title>
<path fill="none" stroke="#91ff00" stroke-dasharray="5,2" d="M559,-458C528.7244,-463.6334 521.1775,-467.518 494,-482 476.582,-491.2815 474.651,-497.4039 458,-508 452.7915,-511.3145 447.1526,-514.6609 441.6249,-517.8158"/>
<polygon fill="#91ff00" stroke="#91ff00" points="439.5432,-514.9697 432.5228,-522.9047 442.9593,-521.0796 439.5432,-514.9697"/>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~moddriver.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge40" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~moddriver.f90</title>
<path fill="none" stroke="#00daff" stroke-dasharray="5,2" d="M409.5,-494C377.7738,-497.8512 343.4674,-509.8436 318.6746,-520.0328"/>
<polygon fill="#00daff" stroke="#00daff" points="317.1871,-516.8615 309.3326,-523.9718 319.9068,-523.3116 317.1871,-516.8615"/>
</g>
<!-- sourcefile~modforces.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_node14" class="node">
<title>sourcefile~modforces.f90</title>
<g id="a_sourcefile~~modfields.f90~~AfferentGraph_node14"><a xlink:href=".././sourcefile/modforces.f90.html" xlink:title="modforces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="599.5,-430 518.5,-430 518.5,-406 599.5,-406 599.5,-430"/>
<text text-anchor="middle" x="559" y="-415.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modforces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modforces.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge42" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modforces.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M667.8956,-446.0325C649.7942,-441.3728 628.5472,-435.9032 609.6499,-431.0386"/>
<polygon fill="#0091ff" stroke="#0091ff" points="610.2775,-427.5861 599.7206,-428.4825 608.5323,-434.3651 610.2775,-427.5861"/>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modinlet.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge44" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modinlet.f90</title>
<path fill="none" stroke="#0048ff" stroke-dasharray="5,2" d="M409.5,-494C383.1117,-497.2032 353.3851,-497.3655 329.4352,-496.6519"/>
<polygon fill="#0048ff" stroke="#0048ff" points="329.331,-493.146 319.2118,-496.2846 329.0796,-500.1415 329.331,-493.146"/>
</g>
<!-- sourcefile~modthermodynamics.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_node21" class="node">
<title>sourcefile~modthermodynamics.f90</title>
<g id="a_sourcefile~~modfields.f90~~AfferentGraph_node21"><a xlink:href=".././sourcefile/modthermodynamics.f90.html" xlink:title="modthermodynamics.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="624,-350 494,-350 494,-326 624,-326 624,-350"/>
<text text-anchor="middle" x="559" y="-335.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modthermodynamics.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modthermodynamics.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge47" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modthermodynamics.f90</title>
<path fill="none" stroke="#ff0091" stroke-dasharray="5,2" d="M695.1396,-444.9348C668.5978,-424.0867 613.9865,-381.1907 582.5963,-356.5344"/>
<polygon fill="#ff0091" stroke="#ff0091" points="584.4271,-353.5218 574.401,-350.0972 580.1031,-359.0267 584.4271,-353.5218"/>
</g>
<!-- sourcefile~modchecksim.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_node12" class="node">
<title>sourcefile~modchecksim.f90</title>
<g id="a_sourcefile~~modfields.f90~~AfferentGraph_node12"><a xlink:href=".././sourcefile/modchecksim.f90.html" xlink:title="modchecksim.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="457.5,-270 361.5,-270 361.5,-246 457.5,-246 457.5,-270"/>
<text text-anchor="middle" x="409.5" y="-255.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modchecksim.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modchecksim.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge11" class="edge">
<title>sourcefile~modchecksim.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M361.2653,-256.2254C337.7695,-255.8133 309.1236,-255.979 283.5,-258"/>
</g>
<!-- sourcefile~moddriver.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge12" class="edge">
<title>sourcefile~moddriver.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M260.9799,-548.0937C230.1039,-563.9152 176.4651,-588.4625 159,-578"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M159,-578C98.2045,-541.5803 54.1918,-312.4858 41.644,-239.9769"/>
<polygon fill="#ff0000" stroke="#ff0000" points="45.0905,-239.3664 39.9623,-230.0954 38.1897,-240.5408 45.0905,-239.3664"/>
</g>
<!-- sourcefile~moddriver.f90&#45;&gt;sourcefile~modsave.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge33" class="edge">
<title>sourcefile~moddriver.f90&#45;&gt;sourcefile~modsave.f90</title>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M258.9028,-523.9484C239.9751,-514.6745 213.6081,-501.7558 192.7144,-491.5187"/>
<polygon fill="#48ff00" stroke="#48ff00" points="194.0661,-488.2835 183.5461,-487.0266 190.9862,-494.5695 194.0661,-488.2835"/>
</g>
<!-- sourcefile~modforces.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge13" class="edge">
<title>sourcefile~modforces.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M533.6004,-405.9581C504.2705,-393.2968 454.3006,-375.5187 409.5,-378"/>
</g>
<!-- sourcefile~modinlet.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge14" class="edge">
<title>sourcefile~modinlet.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M262.8388,-481.8899C256.0578,-477.6971 248.5775,-472.8327 242,-468 202.8798,-439.2571 200.0283,-422.9466 159,-397"/>
</g>
<!-- sourcefile~modinlet.f90&#45;&gt;sourcefile~modsave.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge34" class="edge">
<title>sourcefile~modinlet.f90&#45;&gt;sourcefile~modsave.f90</title>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M247.8233,-488.5554C234.9973,-486.598 220.3184,-484.3578 206.6375,-482.27"/>
<polygon fill="#48ff00" stroke="#48ff00" points="206.831,-478.7591 196.4174,-480.7103 205.7749,-485.6789 206.831,-478.7591"/>
</g>
<!-- sourcefile~tstep.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_node16" class="node">
<title>sourcefile~tstep.f90</title>
<g id="a_sourcefile~~modfields.f90~~AfferentGraph_node16"><a xlink:href=".././sourcefile/tstep.f90.html" xlink:title="tstep.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="310.5,-168 256.5,-168 256.5,-144 310.5,-144 310.5,-168"/>
<text text-anchor="middle" x="283.5" y="-153.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">tstep.f90</text>
</a>
</g>
</g>
<!-- sourcefile~tstep.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge15" class="edge">
<title>sourcefile~tstep.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M256.3511,-150.1425C221.6666,-143.9207 160.3407,-137.2096 112,-155 88.7534,-163.5553 67.8324,-183.0177 54.2151,-198.0634"/>
<polygon fill="#ff0000" stroke="#ff0000" points="51.349,-196.0258 47.433,-205.8704 56.6334,-200.6166 51.349,-196.0258"/>
</g>
<!-- sourcefile~tstep.f90&#45;&gt;sourcefile~modchem.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge37" class="edge">
<title>sourcefile~tstep.f90&#45;&gt;sourcefile~modchem.f90</title>
<path fill="none" stroke="#00ff48" stroke-dasharray="5,2" d="M256.4854,-160.3397C242.3899,-162.604 224.7006,-165.4457 208.273,-168.0847"/>
<polygon fill="#00ff48" stroke="#00ff48" points="207.5693,-164.6527 198.2511,-169.6946 208.6796,-171.5641 207.5693,-164.6527"/>
</g>
<!-- sourcefile~scalsource.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_node17" class="node">
<title>sourcefile~scalsource.f90</title>
<g id="a_sourcefile~~modfields.f90~~AfferentGraph_node17"><a xlink:href=".././sourcefile/scalsource.f90.html" xlink:title="scalsource.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="200,-108 118,-108 118,-84 200,-84 200,-108"/>
<text text-anchor="middle" x="159" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">scalsource.f90</text>
</a>
</g>
</g>
<!-- sourcefile~scalsource.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge16" class="edge">
<title>sourcefile~scalsource.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M132.3965,-108.2558C125.3835,-112.1256 118.0833,-116.7745 112,-122 86.3909,-143.998 63.8174,-176.1264 50.5322,-197.0489"/>
<polygon fill="#ff0000" stroke="#ff0000" points="47.4027,-195.4543 45.1043,-205.7968 53.3507,-199.145 47.4027,-195.4543"/>
</g>
<!-- sourcefile~advec_upw.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_node18" class="node">
<title>sourcefile~advec_upw.f90</title>
<g id="a_sourcefile~~modfields.f90~~AfferentGraph_node18"><a xlink:href=".././sourcefile/advec_upw.f90.html" xlink:title="advec_upw.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="201.5,-66 116.5,-66 116.5,-42 201.5,-42 201.5,-66"/>
<text text-anchor="middle" x="159" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">advec_upw.f90</text>
</a>
</g>
</g>
<!-- sourcefile~advec_upw.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge17" class="edge">
<title>sourcefile~advec_upw.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M124.4262,-66.1334C119.9349,-68.6263 115.6389,-71.564 112,-75 75.638,-109.3346 53.9581,-165.52 44.1981,-196.2464"/>
<polygon fill="#ff0000" stroke="#ff0000" points="40.8004,-195.3896 41.2385,-205.9754 47.4974,-197.427 40.8004,-195.3896"/>
</g>
<!-- sourcefile~modfielddump.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_node19" class="node">
<title>sourcefile~modfielddump.f90</title>
<g id="a_sourcefile~~modfields.f90~~AfferentGraph_node19"><a xlink:href=".././sourcefile/modfielddump.f90.html" xlink:title="modfielddump.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="759.5,-290 661.5,-290 661.5,-266 759.5,-266 759.5,-290"/>
<text text-anchor="middle" x="710.5" y="-275.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modfielddump.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modfielddump.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge18" class="edge">
<title>sourcefile~modfielddump.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M667.1294,-265.9569C601.0107,-249.1688 471.0664,-222.3519 361,-237 325.6253,-241.7078 319.0761,-255.1941 283.5,-258"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M283.5,-258C206.8978,-261.6395 187.2584,-253.7412 112,-239 103.335,-237.3028 94.2098,-235.0814 85.44,-232.7199"/>
<polygon fill="#ff0000" stroke="#ff0000" points="86.3058,-229.3279 75.7332,-230.0147 84.4265,-236.0709 86.3058,-229.3279"/>
</g>
<!-- sourcefile~advec_kappa.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_node20" class="node">
<title>sourcefile~advec_kappa.f90</title>
<g id="a_sourcefile~~modfields.f90~~AfferentGraph_node20"><a xlink:href=".././sourcefile/advec_kappa.f90.html" xlink:title="advec_kappa.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="206,-24 112,-24 112,0 206,0 206,-24"/>
<text text-anchor="middle" x="159" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">advec_kappa.f90</text>
</a>
</g>
</g>
<!-- sourcefile~advec_kappa.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge19" class="edge">
<title>sourcefile~advec_kappa.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M123.6379,-24.0916C119.3688,-26.5744 115.3442,-29.5204 112,-33 66.8396,-79.9893 48.0708,-158.0146 41.3076,-195.944"/>
<polygon fill="#ff0000" stroke="#ff0000" points="37.834,-195.4963 39.6419,-205.9358 44.7388,-196.6475 37.834,-195.4963"/>
</g>
<!-- sourcefile~modthermodynamics.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge20" class="edge">
<title>sourcefile~modthermodynamics.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M531.4842,-350.0013C501.9284,-361.7836 453.2946,-378 409.5,-378"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M409.5,-378C381.5867,-378 182.5915,-411.9195 159,-397"/>
</g>
<!-- sourcefile~modstatistics.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge21" class="edge">
<title>sourcefile~modstatistics.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M386.507,-605.9399C361.7621,-594.1086 320.9096,-577.8516 283.5,-578"/>
</g>
<!-- sourcefile~program.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_node23" class="node">
<title>sourcefile~program.f90</title>
<g id="a_sourcefile~~modfields.f90~~AfferentGraph_node23"><a xlink:href=".././sourcefile/program.f90.html" xlink:title="program.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="868,-469 797,-469 797,-445 868,-445 868,-469"/>
<text text-anchor="middle" x="832.5" y="-454.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">program.f90</text>
</a>
</g>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modpois.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge23" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modpois.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M710.5,-497C675.1556,-507.4108 634.7255,-517.74 604.5258,-525.1503"/>
<polygon fill="#ff0000" stroke="#ff0000" points="603.5842,-521.7773 594.6985,-527.5474 605.2431,-528.5779 603.5842,-521.7773"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modibm.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge24" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modibm.f90</title>
<path fill="none" stroke="#ff4800" stroke-dasharray="5,2" d="M559,-298C494.1796,-277.2781 294.1616,-288.285 203.9495,-294.584"/>
<polygon fill="#ff4800" stroke="#ff4800" points="203.4922,-291.1076 193.7656,-295.3078 203.9886,-298.09 203.4922,-291.1076"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modsubgrid.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge26" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modsubgrid.f90</title>
<path fill="none" stroke="#ff9100" stroke-dasharray="5,2" d="M710.5,-497C665.6188,-510.2198 665.9352,-536.251 624,-557 620.1735,-558.8933 616.1378,-560.6694 612.0274,-562.3238"/>
<polygon fill="#ff9100" stroke="#ff9100" points="610.4902,-559.1626 602.3643,-565.9611 612.9562,-565.7139 610.4902,-559.1626"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modboundary.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge31" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modboundary.f90</title>
<path fill="none" stroke="#91ff00" stroke-dasharray="5,2" d="M797.7048,-469.0318C773.3935,-477.2849 740.1136,-488.2772 710.5,-497"/>
<path fill="none" stroke="#91ff00" stroke-dasharray="5,2" d="M710.5,-497C617.8801,-524.2814 589.3564,-499.8384 494,-515 484.497,-516.511 474.4798,-518.5118 464.7956,-520.6642"/>
<polygon fill="#91ff00" stroke="#91ff00" points="463.8215,-517.2968 454.8597,-522.9481 465.3896,-524.1189 463.8215,-517.2968"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modsave.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge35" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modsave.f90</title>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M710.5,-378C617.3171,-343.6738 321.636,-425.9089 205.9996,-460.5272"/>
<polygon fill="#48ff00" stroke="#48ff00" points="204.9243,-457.1956 196.3569,-463.4287 206.9414,-463.8987 204.9243,-457.1956"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modstatsdump.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge36" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modstatsdump.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M820.3561,-469.0443C799.2728,-489.9549 755.7181,-533.1526 730.2398,-558.422"/>
<polygon fill="#00ff00" stroke="#00ff00" points="727.5934,-556.1172 722.958,-565.6442 732.5228,-561.0873 727.5934,-556.1172"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modstartup.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge38" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modstartup.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M796.8846,-457C786.4381,-457 774.7827,-457 763.499,-457"/>
<polygon fill="#00ff91" stroke="#00ff91" points="763.2862,-453.5001 753.2862,-457 763.2861,-460.5001 763.2862,-453.5001"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modchecksim.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge39" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modchecksim.f90</title>
<path fill="none" stroke="#00ffda" stroke-dasharray="5,2" d="M818.6139,-444.9925C797.0764,-427.1067 753.5939,-393.8747 710.5,-378"/>
<path fill="none" stroke="#00ffda" stroke-dasharray="5,2" d="M710.5,-378C666.3574,-361.739 666.3736,-337.432 624,-317 596.8893,-303.9276 587.6685,-307.1648 559,-298"/>
<path fill="none" stroke="#00ffda" stroke-dasharray="5,2" d="M559,-298C529.1414,-288.4548 495.4466,-279.3017 467.6141,-272.166"/>
<polygon fill="#00ffda" stroke="#00ffda" points="468.1974,-268.703 457.6433,-269.6313 466.4727,-275.4872 468.1974,-268.703"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modforces.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge43" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modforces.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M710.5,-378C690.0551,-370.4686 635.8789,-388.0236 598.1893,-402.2195"/>
<polygon fill="#0091ff" stroke="#0091ff" points="596.6027,-399.0792 588.5161,-405.9244 599.1064,-405.6161 596.6027,-399.0792"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modfielddump.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge46" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modfielddump.f90</title>
<path fill="none" stroke="#da00ff" stroke-dasharray="5,2" d="M824.3058,-444.9774C803.9156,-415.0606 750.6873,-336.9633 724.9073,-299.1386"/>
<polygon fill="#da00ff" stroke="#da00ff" points="727.5053,-296.7358 718.9812,-290.4437 721.721,-300.6782 727.5053,-296.7358"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modthermodynamics.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge48" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modthermodynamics.f90</title>
<path fill="none" stroke="#ff0091" stroke-dasharray="5,2" d="M710.5,-378C682.8775,-367.8246 651.5379,-359.1045 624.5589,-352.4274"/>
<polygon fill="#ff0091" stroke="#ff0091" points="625.3756,-349.0241 614.8316,-350.061 623.7208,-355.8257 625.3756,-349.0241"/>
</g>
</g>
</svg>
</div><script>var pansourcefilemodfieldsf90AfferentGraph = svgPanZoom('#sourcefilemodfieldsf90AfferentGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="190pt" height="32pt"
 viewBox="0.00 0.00 190.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 186,-28 186,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="67,-24 0,-24 0,0 67,0 67,-24"/>
<text text-anchor="middle" x="33.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="182,-24 85,-24 85,0 182,0 182,-24"/>
<text text-anchor="middle" x="133.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/modfields.html">modfields</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/modfields.f90.html#src">modfields.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="c">!&gt; \file modfields.f90</span>
<a name="ln-2"></a><span class="c">!!  Declares, allocates and initializes the 3D fields</span>
<a name="ln-3"></a>
<a name="ln-4"></a><span class="c">!&gt;</span>
<a name="ln-5"></a><span class="c">!!  Declares, allocates and initializes the 3D fields</span>
<a name="ln-6"></a><span class="c">!&gt;</span>
<a name="ln-7"></a>
<a name="ln-8"></a>
<a name="ln-9"></a><span class="k">module </span><span class="n">modfields</span>
<a name="ln-10"></a>
<a name="ln-11"></a>  <span class="k">implicit none</span>
<a name="ln-12"></a><span class="k">  save</span>
<a name="ln-13"></a>
<a name="ln-14"></a>  <span class="c">! Prognostic variables</span>
<a name="ln-15"></a>
<a name="ln-16"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">worksave</span><span class="p">(:)</span>      <span class="c">!&lt;   Used in POISR!</span>
<a name="ln-17"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">um</span><span class="p">(:,:,:)</span>        <span class="c">!&lt;   x-component of velocity at time step t-1</span>
<a name="ln-18"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">vm</span><span class="p">(:,:,:)</span>        <span class="c">!&lt;   y-component of velocity at time step t-1</span>
<a name="ln-19"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">wm</span><span class="p">(:,:,:)</span>        <span class="c">!&lt;   z-component of velocity at time step t-1</span>
<a name="ln-20"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thlm</span><span class="p">(:,:,:)</span>      <span class="c">!&lt;   liq. water pot. temperature at time step t-1</span>
<a name="ln-21"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">e12m</span><span class="p">(:,:,:)</span>      <span class="c">!&lt;   turb. kin. energy at time step t-1</span>
<a name="ln-22"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qtm</span><span class="p">(:,:,:)</span>       <span class="c">!&lt;   total specific humidity at time step t</span>
<a name="ln-23"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span><span class="p">,</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">u0</span><span class="p">(:,:,:)</span>        <span class="c">!&lt;   x-component of velocity at time step t</span>
<a name="ln-24"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span><span class="p">,</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">v0</span><span class="p">(:,:,:)</span>        <span class="c">!&lt;   y-component of velocity at time step t</span>
<a name="ln-25"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span><span class="p">,</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">w0</span><span class="p">(:,:,:)</span>        <span class="c">!&lt;   z-component of velocity at time step t</span>
<a name="ln-26"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span><span class="p">,</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">pres0</span><span class="p">(:,:,:)</span>     <span class="c">!&lt;   pressure at time step t</span>
<a name="ln-27"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span><span class="p">,</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">thl0</span><span class="p">(:,:,:)</span>      <span class="c">!&lt;   liq. water pot. temperature at time step t</span>
<a name="ln-28"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thl0h</span><span class="p">(:,:,:)</span>     <span class="c">!&lt;   3d-field of theta_l at half levels for kappa scheme</span>
<a name="ln-29"></a>
<a name="ln-30"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qt0h</span><span class="p">(:,:,:)</span>      <span class="c">!&lt;  3d-field of q_tot   at half levels for kappa scheme</span>
<a name="ln-31"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">e120</span><span class="p">(:,:,:)</span>      <span class="c">!&lt;   turb. kin. energy at time step t</span>
<a name="ln-32"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span><span class="p">,</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">qt0</span><span class="p">(:,:,:)</span>       <span class="c">!&lt;   total specific humidity at time step t</span>
<a name="ln-33"></a>
<a name="ln-34"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">up</span><span class="p">(:,:,:)</span>        <span class="c">!&lt;   tendency of um</span>
<a name="ln-35"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">vp</span><span class="p">(:,:,:)</span>        <span class="c">!&lt;   tendency of vm</span>
<a name="ln-36"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">wp</span><span class="p">(:,:,:)</span>        <span class="c">!&lt;   tendency of wm</span>
<a name="ln-37"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thlp</span><span class="p">(:,:,:)</span>      <span class="c">!&lt;   tendency of thlm</span>
<a name="ln-38"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">e12p</span><span class="p">(:,:,:)</span>      <span class="c">!&lt;   tendency of e12m</span>
<a name="ln-39"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qtp</span><span class="p">(:,:,:)</span>       <span class="c">!&lt;   tendency of qtm</span>
<a name="ln-40"></a>
<a name="ln-41"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">svm</span><span class="p">(:,:,:,:)</span>     <span class="c">!&lt;  scalar sv(n) at time step t-1</span>
<a name="ln-42"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span><span class="p">,</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">sv0</span><span class="p">(:,:,:,:)</span>     <span class="c">!&lt;  scalar sv(n) at time step t</span>
<a name="ln-43"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">svp</span><span class="p">(:,:,:,:)</span>     <span class="c">!&lt;  tendency of sv(n)</span>
<a name="ln-44"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">svpp</span><span class="p">(:,:,:,:)</span>
<a name="ln-45"></a> 
<a name="ln-46"></a>  <span class="c">! Diagnostic variables</span>
<a name="ln-47"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">mindist</span><span class="p">(:,:,:)</span>   <span class="c">!&lt; minimal distance of cell center to a wall</span>
<a name="ln-48"></a>
<a name="ln-49"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">shear</span><span class="p">(:,:,:,:)</span>   <span class="c">!&lt;   wall shear (last rank indicates the type of shear componenten (uym, uyp, etc.)</span>
<a name="ln-50"></a>
<a name="ln-51"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">momfluxb</span><span class="p">(:,:,:)</span> <span class="c">!&lt; fields for the wallfluxes of total momentum  </span>
<a name="ln-52"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">tfluxb</span><span class="p">(:,:,:)</span>  <span class="c">!&lt; heat</span>
<a name="ln-53"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qfluxb</span><span class="p">(:,:,:)</span>  <span class="c">!&lt; and moisture</span>
<a name="ln-54"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">cth</span><span class="p">(:,:,:)</span>     <span class="c">!&lt; heat transfer coefficient</span>
<a name="ln-55"></a>
<a name="ln-56"></a>  <span class="c">!tg3315 added variables (statistics, masking and others) </span>
<a name="ln-57"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">IIc</span><span class="p">(:,:,:)</span>        <span class="c">!&lt; Masking matrix for blocks at cell centres</span>
<a name="ln-58"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">IIu</span><span class="p">(:,:,:)</span>        <span class="c">!&lt; Masking matrix for blocks at x-direction half cells</span>
<a name="ln-59"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">IIv</span><span class="p">(:,:,:)</span>        <span class="c">!&lt; Masking matrix for blocks at y-direction half cells</span>
<a name="ln-60"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">IIw</span><span class="p">(:,:,:)</span>        <span class="c">!&lt; Masking matrix for blocks at z-direction half cells</span>
<a name="ln-61"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">IIuw</span><span class="p">(:,:,:)</span>       <span class="c">!&lt; Masking matrix for blocks at x-and z-direction half cells</span>
<a name="ln-62"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">IIvw</span><span class="p">(:,:,:)</span>       <span class="c">!&lt; Masking matrix for blocks at y- and z-direction half cells</span>
<a name="ln-63"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">IIuv</span><span class="p">(:,:,:)</span>       <span class="c">!&lt; Masking matrix for blocks at x- and y-direction half cells  </span>
<a name="ln-64"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">IIct</span><span class="p">(:,:)</span>         <span class="c">!&lt; 2-D Masking matrix for blocks at cell centre that span 1:jtot</span>
<a name="ln-65"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">IIwt</span><span class="p">(:,:)</span>         <span class="c">!&lt; 2-D Masking matrix for blocks at z-direction half cells that span 1:jtot</span>
<a name="ln-66"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">IIuwt</span><span class="p">(:,:)</span>        <span class="c">!&lt; 2-D Masking matrix for blocks at x- and z-direction half cells that span 1:jtot</span>
<a name="ln-67"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">IIut</span><span class="p">(:,:)</span>         <span class="c">!&lt; 2-D Masking matrix for blocks at x-direction half cells that span 1:jtot</span>
<a name="ln-68"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">IIvt</span><span class="p">(:,:)</span>         <span class="c">!&lt; 2-D Masking matrix for blocks at y-direction half cells that span 1:jtot</span>
<a name="ln-69"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">IIcs</span><span class="p">(:)</span>           <span class="c">!&lt; 1-D Masking matrix for blocks at cell centres that span ib:ie and 1:jtot</span>
<a name="ln-70"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">IIus</span><span class="p">(:)</span>           <span class="c">!&lt; 1-D Masking matrix for blocks at x-direction half cells that span ib:ie and 1:jtot</span>
<a name="ln-71"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">IIvs</span><span class="p">(:)</span>           <span class="c">!&lt; 1-D Masking matrix for blocks at y-direction half cells that span ib:ie and 1:jtot</span>
<a name="ln-72"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">IIws</span><span class="p">(:)</span>           <span class="c">!&lt; 1-D Masking matrix for blocks at z-direction half cells that span ib:ie and 1:jtot</span>
<a name="ln-73"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">IIuws</span><span class="p">(:)</span>          <span class="c">!&lt; 1-D Masking matrix for blocks at x- and z-direction half cells that span ib:ie and 1:jtot</span>
<a name="ln-74"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">IIvws</span><span class="p">(:)</span>          <span class="c">!&lt; 1-D Masking matrix for blocks at y- and z-direction half cells that span ib:ie and 1:jtot</span>
<a name="ln-75"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">IIuvs</span><span class="p">(:)</span>          <span class="c">!&lt; 1-D Masking matrix for blocks at x- and y-direction half cells that span ib:ie and 1:jtot</span>
<a name="ln-76"></a>
<a name="ln-77"></a><span class="c">!  integer              :: IIbl = 1          !&lt; Switch for if layer at kb is all blocks</span>
<a name="ln-78"></a>
<a name="ln-79"></a>  <span class="c">! statistical fields following notation &quot;[statistical name][averaging directions - x,y,z,t][position in grid - i,j,k]&quot;</span>
<a name="ln-80"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">uyt</span><span class="p">(:,:)</span> 
<a name="ln-81"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">uytik</span><span class="p">(:,:)</span>
<a name="ln-82"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">vyt</span><span class="p">(:,:)</span>        
<a name="ln-83"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">wyt</span><span class="p">(:,:)</span>        
<a name="ln-84"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">wytik</span><span class="p">(:,:)</span>
<a name="ln-85"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thlyt</span><span class="p">(:,:)</span>      
<a name="ln-86"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qtyt</span><span class="p">(:,:)</span>      
<a name="ln-87"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thlytk</span><span class="p">(:,:)</span>      
<a name="ln-88"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">sca1yt</span><span class="p">(:,:)</span>     
<a name="ln-89"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">sca2yt</span><span class="p">(:,:)</span>     
<a name="ln-90"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">sca3yt</span><span class="p">(:,:)</span>     
<a name="ln-91"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thlsgsyt</span><span class="p">(:,:)</span>     
<a name="ln-92"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qtsgsyt</span><span class="p">(:,:)</span>
<a name="ln-93"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">usgsyt</span><span class="p">(:,:)</span> 
<a name="ln-94"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">wsgsyt</span><span class="p">(:,:)</span>    
<a name="ln-95"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">sv1sgsyt</span><span class="p">(:,:)</span>
<a name="ln-96"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">sv2sgsyt</span><span class="p">(:,:)</span>
<a name="ln-97"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">sv3sgsyt</span><span class="p">(:,:)</span>
<a name="ln-98"></a>
<a name="ln-99"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">uxyt</span><span class="p">(:)</span>        
<a name="ln-100"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">vxyt</span><span class="p">(:)</span>        
<a name="ln-101"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">wxyt</span><span class="p">(:)</span>        
<a name="ln-102"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thlxyt</span><span class="p">(:)</span>        
<a name="ln-103"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qtxyt</span><span class="p">(:)</span>
<a name="ln-104"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">pxyt</span><span class="p">(:)</span>  <span class="c">! bss116      </span>
<a name="ln-105"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">usgsxyt</span><span class="p">(:)</span>
<a name="ln-106"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thlsgsxyt</span><span class="p">(:)</span>
<a name="ln-107"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">vsgsxyt</span><span class="p">(:)</span>
<a name="ln-108"></a>
<a name="ln-109"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">uwtik</span><span class="p">(:,:,:)</span>
<a name="ln-110"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">wthltk</span><span class="p">(:,:,:)</span>
<a name="ln-111"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">wqttk</span><span class="p">(:,:,:)</span>
<a name="ln-112"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thlthlt</span><span class="p">(:,:,:)</span>
<a name="ln-113"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qtqtt</span><span class="p">(:,:,:)</span>
<a name="ln-114"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">sv1sv1t</span><span class="p">(:,:,:)</span>
<a name="ln-115"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">sv2sv2t</span><span class="p">(:,:,:)</span>
<a name="ln-116"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">sv3sv3t</span><span class="p">(:,:,:)</span>
<a name="ln-117"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">sv4sv4t</span><span class="p">(:,:,:)</span>
<a name="ln-118"></a>  <span class="c">! real, allocatable :: sv1max(:,:,:)</span>
<a name="ln-119"></a>  <span class="c">! real, allocatable :: sv2max(:,:,:)</span>
<a name="ln-120"></a>  <span class="c">! real, allocatable :: sv3max(:,:,:)</span>
<a name="ln-121"></a>  <span class="c">! real, allocatable :: sv4max(:,:,:)</span>
<a name="ln-122"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">PSSt</span><span class="p">(:,:,:)</span>
<a name="ln-123"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">uutc</span><span class="p">(:,:,:)</span>
<a name="ln-124"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">vvtc</span><span class="p">(:,:,:)</span>
<a name="ln-125"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">wwtc</span><span class="p">(:,:,:)</span>
<a name="ln-126"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">vwtjk</span><span class="p">(:,:,:)</span>
<a name="ln-127"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">uvtij</span><span class="p">(:,:,:)</span>
<a name="ln-128"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">utik</span><span class="p">(:,:,:)</span>
<a name="ln-129"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">wtik</span><span class="p">(:,:,:)</span>
<a name="ln-130"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">vtjk</span><span class="p">(:,:,:)</span>
<a name="ln-131"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">wtjk</span><span class="p">(:,:,:)</span>
<a name="ln-132"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">utij</span><span class="p">(:,:,:)</span>
<a name="ln-133"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">vtij</span><span class="p">(:,:,:)</span>
<a name="ln-134"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">wmt</span><span class="p">(:,:,:)</span>
<a name="ln-135"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thltk</span><span class="p">(:,:,:)</span>
<a name="ln-136"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qttk</span><span class="p">(:,:,:)</span>
<a name="ln-137"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thlt</span><span class="p">(:,:,:)</span>
<a name="ln-138"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">utc</span><span class="p">(:,:,:)</span>
<a name="ln-139"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">vtc</span><span class="p">(:,:,:)</span>
<a name="ln-140"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">wtc</span><span class="p">(:,:,:)</span>
<a name="ln-141"></a>
<a name="ln-142"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">vmt</span><span class="p">(:,:,:)</span>
<a name="ln-143"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">umt</span><span class="p">(:,:,:)</span>
<a name="ln-144"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">sv1t</span><span class="p">(:,:,:)</span>
<a name="ln-145"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">sv2t</span><span class="p">(:,:,:)</span>
<a name="ln-146"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">sv3t</span><span class="p">(:,:,:)</span>
<a name="ln-147"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">sv4t</span><span class="p">(:,:,:)</span>
<a name="ln-148"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">sv1tk</span><span class="p">(:,:,:)</span>
<a name="ln-149"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">sv2tk</span><span class="p">(:,:,:)</span>
<a name="ln-150"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">sv3tk</span><span class="p">(:,:,:)</span>
<a name="ln-151"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">sv4tk</span><span class="p">(:,:,:)</span>
<a name="ln-152"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">wsv1tk</span><span class="p">(:,:,:)</span>
<a name="ln-153"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">wsv2tk</span><span class="p">(:,:,:)</span>
<a name="ln-154"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">wsv3tk</span><span class="p">(:,:,:)</span> 
<a name="ln-155"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">wsv4tk</span><span class="p">(:,:,:)</span>
<a name="ln-156"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">sv1sgst</span><span class="p">(:,:,:)</span>
<a name="ln-157"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">sv2sgst</span><span class="p">(:,:,:)</span>
<a name="ln-158"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">sv3sgst</span><span class="p">(:,:,:)</span>
<a name="ln-159"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">sv4sgst</span><span class="p">(:,:,:)</span>
<a name="ln-160"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qtt</span><span class="p">(:,:,:)</span> <span class="c">! bss116</span>
<a name="ln-161"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">pt</span><span class="p">(:,:,:)</span>  <span class="c">! bss116</span>
<a name="ln-162"></a>
<a name="ln-163"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">slice</span><span class="p">(:,:)</span> 
<a name="ln-164"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">slice2</span><span class="p">(:,:)</span> 
<a name="ln-165"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">slice3</span><span class="p">(:,:)</span> 
<a name="ln-166"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">slice4</span><span class="p">(:,:)</span> 
<a name="ln-167"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">slice5</span><span class="p">(:,:)</span> 
<a name="ln-168"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">slice6</span><span class="p">(:,:)</span> 
<a name="ln-169"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">slice7</span><span class="p">(:,:)</span> 
<a name="ln-170"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">slice8</span><span class="p">(:,:)</span>
<a name="ln-171"></a>
<a name="ln-172"></a>  <span class="c">! fields for scalar sources</span>
<a name="ln-173"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">scar</span><span class="p">(:,:)</span>
<a name="ln-174"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">scarl</span><span class="p">(:,:)</span>
<a name="ln-175"></a>
<a name="ln-176"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">uav</span><span class="p">(:,:,:)</span>       <span class="c">!&lt;   time-averaged u-velocity</span>
<a name="ln-177"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">vav</span><span class="p">(:,:,:)</span>       <span class="c">!&lt;   time-averaged u-velocity</span>
<a name="ln-178"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">wav</span><span class="p">(:,:,:)</span>       <span class="c">!&lt;   time-averaged u-velocity </span>
<a name="ln-179"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thlav</span><span class="p">(:,:,:)</span>     <span class="c">!&lt;   time-averaged liquid temperature</span>
<a name="ln-180"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qtav</span><span class="p">(:,:,:)</span>      <span class="c">!&lt;   time-averaged specific humidity</span>
<a name="ln-181"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qlav</span><span class="p">(:,:,:)</span>      <span class="c">!&lt;   time-averaged liquid water</span>
<a name="ln-182"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">presav</span><span class="p">(:,:,:)</span>    <span class="c">!&lt;   time-averaged pressure</span>
<a name="ln-183"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">svav</span><span class="p">(:,:,:,:)</span>    <span class="c">!&lt;   time-averaged scalar concentration </span>
<a name="ln-184"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">viscratioav</span><span class="p">(:,:,:)</span>    <span class="c">!&lt;   time-averaged viscosity ratio; turb viscosity / molecular viscosity</span>
<a name="ln-185"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">umint</span><span class="p">(:,:,:)</span>     <span class="c">!&lt;   um interpolated to cell-center</span>
<a name="ln-186"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">vmint</span><span class="p">(:,:,:)</span>     <span class="c">!&lt;   vm interpolated to cell-center</span>
<a name="ln-187"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">wmint</span><span class="p">(:,:,:)</span>     <span class="c">!&lt;   wm interpolated to cell-center</span>
<a name="ln-188"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thl2av</span><span class="p">(:,:,:)</span>    <span class="c">!&lt;   time-average: liquid temperature squared</span>
<a name="ln-189"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">ql2av</span><span class="p">(:,:,:)</span>    <span class="c">!&lt;   time-average: liquid temperature squared</span>
<a name="ln-190"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qt2av</span><span class="p">(:,:,:)</span>    <span class="c">!&lt;   time-average: liquid temperature squared</span>
<a name="ln-191"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">sv2av</span><span class="p">(:,:,:,:)</span>   <span class="c">!&lt;   time-average: scalar concentration squared</span>
<a name="ln-192"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">uuav</span><span class="p">(:,:,:)</span>      <span class="c">!&lt;   time-average: u-velocity squared</span>
<a name="ln-193"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">vvav</span><span class="p">(:,:,:)</span>      <span class="c">!&lt;   time-average: v-velocity squared</span>
<a name="ln-194"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">wwav</span><span class="p">(:,:,:)</span>      <span class="c">!&lt;   time-average: w-velocity squared</span>
<a name="ln-195"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">uvav</span><span class="p">(:,:,:)</span>      <span class="c">!&lt;   time-average: u-velocity times v-velocity</span>
<a name="ln-196"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">uwav</span><span class="p">(:,:,:)</span>      <span class="c">!&lt;   time-average: u-velocity times fluctuation</span>
<a name="ln-197"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">vwav</span><span class="p">(:,:,:)</span>      <span class="c">!&lt;   time-average: v-velocity times w-velocity</span>
<a name="ln-198"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thluav</span><span class="p">(:,:,:)</span>    <span class="c">!&lt;   time-average: thl times u-velocity</span>
<a name="ln-199"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thlvav</span><span class="p">(:,:,:)</span>    <span class="c">!&lt;   time-average: thl times v-velocity</span>
<a name="ln-200"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thlwav</span><span class="p">(:,:,:)</span>    <span class="c">!&lt;   time-average: thl times w-velocity</span>
<a name="ln-201"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thlthlav</span><span class="p">(:,:,:)</span>  <span class="c">!&lt;   time-average: thl times thl</span>
<a name="ln-202"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qluav</span><span class="p">(:,:,:)</span>    <span class="c">!&lt;   time-average: ql times u-velocity</span>
<a name="ln-203"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qlvav</span><span class="p">(:,:,:)</span>    <span class="c">!&lt;   time-average: ql times v-velocity</span>
<a name="ln-204"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qlwav</span><span class="p">(:,:,:)</span>    <span class="c">!&lt;   time-average: ql times w-velocity</span>
<a name="ln-205"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qtuav</span><span class="p">(:,:,:)</span>    <span class="c">!&lt;   time-average: qt times u-velocity</span>
<a name="ln-206"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qtvav</span><span class="p">(:,:,:)</span>    <span class="c">!&lt;   time-average: qt times v-velocity</span>
<a name="ln-207"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qtwav</span><span class="p">(:,:,:)</span>    <span class="c">!&lt;   time-average: qt times w-velocity</span>
<a name="ln-208"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">svuav</span><span class="p">(:,:,:,:)</span>   <span class="c">!&lt;   time-average: sv times u-velocity</span>
<a name="ln-209"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">svvav</span><span class="p">(:,:,:,:)</span>   <span class="c">!&lt;   time-average: sv times v-velocity</span>
<a name="ln-210"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">svwav</span><span class="p">(:,:,:,:)</span>   <span class="c">!&lt;   time-average: sv times w-velocity</span>
<a name="ln-211"></a><span class="c">!  real, allocatable :: tekm(:,:,:)     !tekm = ekm - numol !tg3315</span>
<a name="ln-212"></a>
<a name="ln-213"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">upupav</span><span class="p">(:,:,:)</span>    <span class="c">!&lt;   time-average: u&#39;u&#39;</span>
<a name="ln-214"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">vpvpav</span><span class="p">(:,:,:)</span>    <span class="c">!&lt;   time-average: v&#39;v&#39;</span>
<a name="ln-215"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">wpwpav</span><span class="p">(:,:,:)</span>    <span class="c">!&lt;   time-average: w&#39;w&#39;</span>
<a name="ln-216"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thlpthlpav</span><span class="p">(:,:,:)</span><span class="c">!&lt;   time-average: thl&#39;thl&#39;</span>
<a name="ln-217"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qlpqlpav</span><span class="p">(:,:,:)</span>  <span class="c">!&lt;   time-average: ql&#39;ql&#39;</span>
<a name="ln-218"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qtpqtpav</span><span class="p">(:,:,:)</span><span class="c">!&lt;   time-average: thl&#39;thl&#39;</span>
<a name="ln-219"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">svpsvpav</span><span class="p">(:,:,:,:)</span><span class="c">!&lt;   time-average: sv&#39;sv&#39;</span>
<a name="ln-220"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">upvpav</span><span class="p">(:,:,:)</span>    <span class="c">!&lt;   time-average: u&#39;v&#39;</span>
<a name="ln-221"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">upwpav</span><span class="p">(:,:,:)</span>    <span class="c">!&lt;   time-average: u&#39;w&#39;</span>
<a name="ln-222"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">vpwpav</span><span class="p">(:,:,:)</span>    <span class="c">!&lt;   time-average: v&#39;w&#39;</span>
<a name="ln-223"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thlpupav</span><span class="p">(:,:,:)</span>  <span class="c">!&lt;   time-average: thl&#39;u&#39;</span>
<a name="ln-224"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thlpvpav</span><span class="p">(:,:,:)</span>  <span class="c">!&lt;   time-average: thl&#39;v&#39;</span>
<a name="ln-225"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thlpwpav</span><span class="p">(:,:,:)</span>  <span class="c">!&lt;   time-average: thl&#39;w&#39;</span>
<a name="ln-226"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qlpupav</span><span class="p">(:,:,:)</span>  <span class="c">!&lt;   time-average: ql&#39;u&#39;</span>
<a name="ln-227"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qlpvpav</span><span class="p">(:,:,:)</span>  <span class="c">!&lt;   time-average: ql&#39;v&#39;</span>
<a name="ln-228"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qlpwpav</span><span class="p">(:,:,:)</span>  <span class="c">!&lt;   time-average: ql&#39;w&#39;</span>
<a name="ln-229"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qtpupav</span><span class="p">(:,:,:)</span>  <span class="c">!&lt;   time-average: qt&#39;u&#39;</span>
<a name="ln-230"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qtpvpav</span><span class="p">(:,:,:)</span>  <span class="c">!&lt;   time-average: qt&#39;v&#39;</span>
<a name="ln-231"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qtpwpav</span><span class="p">(:,:,:)</span>  <span class="c">!&lt;   time-average: qt&#39;w&#39;</span>
<a name="ln-232"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">svpupav</span><span class="p">(:,:,:,:)</span> <span class="c">!&lt;   time-average: sv&#39;u&#39;</span>
<a name="ln-233"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">svpvpav</span><span class="p">(:,:,:,:)</span> <span class="c">!&lt;   time-average: sv&#39;v&#39;</span>
<a name="ln-234"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">svpwpav</span><span class="p">(:,:,:,:)</span> <span class="c">!&lt;   time-average: sv&#39;w&#39;</span>
<a name="ln-235"></a>
<a name="ln-236"></a><span class="c">! SGS fields</span>
<a name="ln-237"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">uusgsav</span><span class="p">(:,:,:)</span>    <span class="c">!&lt;   time-average subgrid contribution (estimate)</span>
<a name="ln-238"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">vvsgsav</span><span class="p">(:,:,:)</span>    <span class="c">!&lt;   time-average subgrid contribution (estimate)</span>
<a name="ln-239"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">wwsgsav</span><span class="p">(:,:,:)</span>    <span class="c">!&lt;   time-average subgrid contribution (estimate)</span>
<a name="ln-240"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">uwsgsav</span><span class="p">(:,:,:)</span>    <span class="c">!&lt;   time-average subgrid contribution (estimate)</span>
<a name="ln-241"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thlusgsav</span><span class="p">(:,:,:)</span>  <span class="c">!&lt;   time-average subgrid contribution (estimate)</span>
<a name="ln-242"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thlwsgsav</span><span class="p">(:,:,:)</span>  <span class="c">!&lt;   time-average subgrid contribution (estimate)</span>
<a name="ln-243"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qlusgsav</span><span class="p">(:,:,:)</span>  <span class="c">!&lt;   time-average subgrid contribution (estimate)</span>
<a name="ln-244"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qlwsgsav</span><span class="p">(:,:,:)</span>  <span class="c">!&lt;   time-average subgrid contribution (estimate)</span>
<a name="ln-245"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qtusgsav</span><span class="p">(:,:,:)</span>  <span class="c">!&lt;   time-average subgrid contribution (estimate)</span>
<a name="ln-246"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qtwsgsav</span><span class="p">(:,:,:)</span>  <span class="c">!&lt;   time-average subgrid contribution (estimate)</span>
<a name="ln-247"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">svusgsav</span><span class="p">(:,:,:,:)</span> <span class="c">!&lt;   time-average subgrid contribution (estimate)</span>
<a name="ln-248"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">svwsgsav</span><span class="p">(:,:,:,:)</span> <span class="c">!&lt;   time-average subgrid contribution (estimate)</span>
<a name="ln-249"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">tkesgsav</span><span class="p">(:,:,:)</span>   <span class="c">!&lt;   time-average subgrid turbulence kinetic energy</span>
<a name="ln-250"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">nusgsav</span><span class="p">(:,:,:)</span>    <span class="c">!&lt;   time-average subgrid viscosity</span>
<a name="ln-251"></a>
<a name="ln-252"></a><span class="c">! Resolved dissipation &#39;terms&#39;</span>
<a name="ln-253"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">strain2av</span><span class="p">(:,:,:)</span>  <span class="c">!&lt;   &lt;Sij*Sij&gt; used to compute &lt;Sij&#39;*Sij&#39;&gt; = &lt;Sij*Sij&gt; - &lt;S&gt;ij*&lt;S&gt;ij</span>
<a name="ln-254"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">disssgsav</span><span class="p">(:,:,:)</span>  <span class="c">!&lt;   mean subgrid dissipation: &lt;nu_sgs*2.*Sij*Sij&gt;</span>
<a name="ln-255"></a>                                         <span class="c">!&lt;   which is used for resolved dissipation = nu*2*&lt;Sij&#39;*Sij&#39;&gt; </span>
<a name="ln-256"></a><span class="c">! TKE budget terms:</span>
<a name="ln-257"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">tvmx</span><span class="p">(:,:,:)</span>        <span class="c">!&lt;   needed for viscous transport: &lt;u*d/dxj(2*nu*S1j)&gt;</span>
<a name="ln-258"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">tvmy</span><span class="p">(:,:,:)</span>        <span class="c">!&lt;   needed for viscous transport: &lt;v*d/dxj(2*nu*S2j)&gt;</span>
<a name="ln-259"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">tvmz</span><span class="p">(:,:,:)</span>        <span class="c">!&lt;   needed for viscous transport: &lt;w*d/dxj(2*nu*S3j)&gt;</span>
<a name="ln-260"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">tpm</span> <span class="p">(:,:,:)</span>        <span class="c">!&lt;   needed for transport by pressure fluctuations</span>
<a name="ln-261"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">ttmx</span><span class="p">(:,:,:)</span>        <span class="c">!&lt;   needed for transport by turb. vel. fluctuations</span>
<a name="ln-262"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">ttmy</span><span class="p">(:,:,:)</span>        <span class="c">!&lt;   needed for transport by turb. vel. fluctuations</span>
<a name="ln-263"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">ttmz</span><span class="p">(:,:,:)</span>        <span class="c">!&lt;   needed for transport by turb. vel. fluctuations</span>
<a name="ln-264"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">tsgsmx1</span><span class="p">(:,:,:)</span>     <span class="c">!&lt;   needed for transport by subgrid x = &lt;u*d/dxj(2*nu_t*S1j)&gt;</span>
<a name="ln-265"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">tsgsmy1</span><span class="p">(:,:,:)</span>     <span class="c">!&lt;   needed for transport by subgrid y = &lt;v*d/dxj(2*nu_t*S2j)&gt;</span>
<a name="ln-266"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">tsgsmz1</span><span class="p">(:,:,:)</span>     <span class="c">!&lt;   needed for transport by subgrid z = &lt;w*d/dxj(2*nu_t*S3j)&gt;</span>
<a name="ln-267"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">tsgsmx2</span><span class="p">(:,:,:)</span>     <span class="c">!&lt;   needed for transport by subgrid x = &lt;d/dxj(2*nu_t*S1j)&gt;</span>
<a name="ln-268"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">tsgsmy2</span><span class="p">(:,:,:)</span>     <span class="c">!&lt;   needed for transport by subgrid y = &lt;d/dxj(2*nu_t*S2j)&gt;</span>
<a name="ln-269"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">tsgsmz2</span><span class="p">(:,:,:)</span>     <span class="c">!&lt;   needed for transport by subgrid z = &lt;d/dxj(2*nu_t*S3j)&gt;</span>
<a name="ln-270"></a><span class="c">! TKE budget results (written to files):</span>
<a name="ln-271"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">t_vav</span><span class="p">(:,:,:)</span>        <span class="c">!&lt;   viscous transport</span>
<a name="ln-272"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">t_sgsav</span><span class="p">(:,:,:)</span>      <span class="c">!&lt;   transport by subgrid</span>
<a name="ln-273"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">t_pav</span><span class="p">(:,:,:)</span>        <span class="c">!&lt;   transport by pressure fluctuations</span>
<a name="ln-274"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">t_tav</span><span class="p">(:,:,:)</span>        <span class="c">!&lt;   transport by by turb. vel. fluctuations</span>
<a name="ln-275"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">p_tav</span><span class="p">(:,:,:)</span>        <span class="c">!&lt;   production by shear</span>
<a name="ln-276"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">p_bav</span><span class="p">(:,:,:)</span>        <span class="c">!&lt;   production/destruction by buoyancy</span>
<a name="ln-277"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">d_sgsav</span><span class="p">(:,:,:)</span>      <span class="c">!&lt;   dissipation by subgrid</span>
<a name="ln-278"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">tkeadv</span><span class="p">(:,:,:)</span>       <span class="c">!&lt;   advection of tke </span>
<a name="ln-279"></a>  
<a name="ln-280"></a><span class="c">! TKE budget results (written to tkedump): !tg3315</span>
<a name="ln-281"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">t_v</span><span class="p">(:)</span>            <span class="c">!&lt;   viscous transport</span>
<a name="ln-282"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">t_sgs</span><span class="p">(:)</span>          <span class="c">!&lt;   transport by subgrid</span>
<a name="ln-283"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">t_p</span><span class="p">(:)</span>            <span class="c">!&lt;   transport by pressurefluctuations</span>
<a name="ln-284"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">t_t</span><span class="p">(:)</span>            <span class="c">!&lt;   transport by by turb. vel. fluctuations</span>
<a name="ln-285"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">p_t</span><span class="p">(:)</span>            <span class="c">!&lt;   production by shear</span>
<a name="ln-286"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">p_b</span><span class="p">(:)</span>            <span class="c">!&lt;   production/destruction by buoyancy</span>
<a name="ln-287"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">d_sgs</span><span class="p">(:)</span>          <span class="c">!&lt;   dissipation by subgrid</span>
<a name="ln-288"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">adv</span><span class="p">(:)</span>            <span class="c">!&lt;   advection of tke</span>
<a name="ln-289"></a>
<a name="ln-290"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span><span class="p">,</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">ql0</span><span class="p">(:,:,:)</span>       <span class="c">!&lt;   liquid water content</span>
<a name="ln-291"></a>
<a name="ln-292"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thv0h</span><span class="p">(:,:,:)</span>     <span class="c">!&lt;   theta_v at half level</span>
<a name="ln-293"></a>
<a name="ln-294"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">whls</span><span class="p">(:)</span>          <span class="c">!&lt;   large scale vert velocity at half levels</span>
<a name="ln-295"></a>
<a name="ln-296"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">presf</span><span class="p">(:)</span>         <span class="c">!&lt;   hydrostatic pressure at full level</span>
<a name="ln-297"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">presh</span><span class="p">(:)</span>         <span class="c">!&lt;   hydrostatic pressure at half level</span>
<a name="ln-298"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">exnf</span><span class="p">(:)</span>          <span class="c">!&lt;   hydrostatic exner function at full level</span>
<a name="ln-299"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">exnh</span><span class="p">(:)</span>          <span class="c">!&lt;   hydrostatic exner function at half level</span>
<a name="ln-300"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thvf</span><span class="p">(:)</span>          <span class="c">!&lt;   hydrostatic exner function at full level</span>
<a name="ln-301"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thvh</span><span class="p">(:)</span>          <span class="c">!&lt;   hydrostatic exner function at half level</span>
<a name="ln-302"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">rhof</span><span class="p">(:)</span>          <span class="c">!&lt;   slab averaged density at full level</span>
<a name="ln-303"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qt0av</span><span class="p">(:)</span>         <span class="c">!&lt;   slab averaged q_tot</span>
<a name="ln-304"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">ql0av</span><span class="p">(:)</span>         <span class="c">!&lt;   slab averaged q_liq</span>
<a name="ln-305"></a>
<a name="ln-306"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thl0av</span><span class="p">(:)</span>        <span class="c">!&lt;   slab averaged th_liq</span>
<a name="ln-307"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">u0av</span><span class="p">(:)</span>          <span class="c">!&lt;   slab averaged u</span>
<a name="ln-308"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">v0av</span><span class="p">(:)</span>          <span class="c">!&lt;   slab averaged v</span>
<a name="ln-309"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">ug</span><span class="p">(:)</span>            <span class="c">!&lt;   geostrophic u-wind</span>
<a name="ln-310"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">vg</span><span class="p">(:)</span>            <span class="c">!&lt;   geostrophic v-wind</span>
<a name="ln-311"></a>
<a name="ln-312"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">pgx</span><span class="p">(:)</span>            <span class="c">!&lt;   driving pressure gradient in x, this is dp/dx [(\Delta p) / (\Delta x)] across one cell, already divided by \rho -&gt; in units of [m/s^2]</span>
<a name="ln-313"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">pgy</span><span class="p">(:)</span>            <span class="c">!&lt;   driving pressure gradient in y [m/s^2]</span>
<a name="ln-314"></a>
<a name="ln-315"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dpdxl</span><span class="p">(:)</span>                      <span class="c">!&lt;   large scale pressure x-gradient [m/s^2]</span>
<a name="ln-316"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dpdyl</span><span class="p">(:)</span>                      <span class="c">!&lt;   large scale pressure y-gradient [m/s^2]</span>
<a name="ln-317"></a>
<a name="ln-318"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dthldxls</span><span class="p">(:)</span>                   <span class="c">!&lt;   large scale x-gradient of th_liq</span>
<a name="ln-319"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dthldyls</span><span class="p">(:)</span>                   <span class="c">!&lt;   large scale y-gradient of th_liq</span>
<a name="ln-320"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dqtdxls</span><span class="p">(:)</span>                    <span class="c">!&lt;   large scale x-gradient of q_tot</span>
<a name="ln-321"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dqtdyls</span><span class="p">(:)</span>                    <span class="c">!&lt;   large scale y-gradient of q_tot</span>
<a name="ln-322"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dqtdtls</span><span class="p">(:)</span>                    <span class="c">!&lt;   large scale y-gradient of q_tot</span>
<a name="ln-323"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dudxls</span><span class="p">(:)</span>                     <span class="c">!&lt;   large scale x-gradient of u</span>
<a name="ln-324"></a>
<a name="ln-325"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dudyls</span><span class="p">(:)</span>                     <span class="c">!&lt;   large scale y-gradient of u</span>
<a name="ln-326"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dvdxls</span><span class="p">(:)</span>                     <span class="c">!&lt;   large scale x-gradient of v</span>
<a name="ln-327"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dvdyls</span><span class="p">(:)</span>                     <span class="c">!&lt;   large scale y-gradient of v</span>
<a name="ln-328"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">wfls</span>  <span class="p">(:)</span>                     <span class="c">!&lt;   large scale y-gradient of v</span>
<a name="ln-329"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">ql0h</span><span class="p">(:,:,:)</span>
<a name="ln-330"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dthvdz</span><span class="p">(:,:,:)</span>                 <span class="c">!&lt;   theta_v at half level</span>
<a name="ln-331"></a>
<a name="ln-332"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thlprof</span><span class="p">(:)</span>                    <span class="c">!&lt;   initial thl-profile</span>
<a name="ln-333"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qtprof</span><span class="p">(:)</span>                     <span class="c">!&lt;   initial qt-profile</span>
<a name="ln-334"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">uprof</span><span class="p">(:)</span>                      <span class="c">!&lt;   initial u-profile</span>
<a name="ln-335"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">vprof</span><span class="p">(:)</span>                      <span class="c">!&lt;   initial v-profile</span>
<a name="ln-336"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">e12prof</span><span class="p">(:)</span>                    <span class="c">!&lt;   initial subgrid TKE profile</span>
<a name="ln-337"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">sv0av</span><span class="p">(:,:)</span>                    <span class="c">!&lt;   slab average of sv(n)</span>
<a name="ln-338"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">svprof</span><span class="p">(:,:)</span>                   <span class="c">!&lt;   initial sv(n)-profile</span>
<a name="ln-339"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qlprof</span><span class="p">(:)</span>
<a name="ln-340"></a>
<a name="ln-341"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thlpcar</span><span class="p">(:)</span>                    <span class="c">!&lt; prescribed radiatively forced thl tendency</span>
<a name="ln-342"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">SW_up_TOA</span><span class="p">(:,:),</span> <span class="n">SW_dn_TOA</span><span class="p">(:,:),</span> <span class="n">LW_up_TOA</span><span class="p">(:,:),</span> <span class="n">LW_dn_TOA</span><span class="p">(:,:)</span>
<a name="ln-343"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">uout</span><span class="p">(:)</span>                      <span class="c">!&lt; height average outlet velocity (used in convective outflow BC)</span>
<a name="ln-344"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">wout</span><span class="p">(:)</span>                      <span class="c">!&lt; j-averaged top velocity</span>
<a name="ln-345"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">friction</span><span class="p">(:)</span>                  <span class="c">!&lt; skin-friction coeff: from y-line-averaged shear </span>
<a name="ln-346"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">momthick</span><span class="p">(:)</span>                  <span class="c">!&lt; momentum thickness: y-line average </span>
<a name="ln-347"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">displthick</span><span class="p">(:)</span>                <span class="c">!&lt; displacement thickness: y-line average </span>
<a name="ln-348"></a>  <span class="kt">real</span>              <span class="kd">::</span> <span class="n">uouttot</span>                      <span class="c">!&lt; area-averaged outflow velocity (used in convective outflow BC) </span>
<a name="ln-349"></a>  <span class="kt">real</span>              <span class="kd">::</span> <span class="n">wouttot</span>                      <span class="c">!&lt; area-averaveraged top velocity</span>
<a name="ln-350"></a>  <span class="kt">real</span>              <span class="kd">::</span> <span class="n">udef</span>
<a name="ln-351"></a>  <span class="kt">real</span>              <span class="kd">::</span> <span class="n">vdef</span>
<a name="ln-352"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">vout</span><span class="p">(:)</span>
<a name="ln-353"></a>  <span class="kt">real</span>              <span class="kd">::</span> <span class="n">vouttot</span>
<a name="ln-354"></a>
<a name="ln-355"></a>  <span class="kt">real</span>              <span class="kd">::</span> <span class="n">thlsrcdt</span>                     <span class="c">! thlsrc -&gt; thlsrcdt is used to solve 1-order ODE for thlsrc </span>
<a name="ln-356"></a>  <span class="kt">real</span>              <span class="kd">::</span> <span class="n">dgdt</span>                         <span class="c">! g = dp/dx -&gt; dgdt is used to solve 1-order ODE for dpdx </span>
<a name="ln-357"></a>  <span class="kt">real</span>              <span class="kd">::</span> <span class="n">dpdx</span> <span class="o">=</span> <span class="mf">0.</span>                   <span class="c">! dpdx given in namoptions</span>
<a name="ln-358"></a>
<a name="ln-359"></a>  <span class="kt">real</span>              <span class="kd">::</span> <span class="n">uoutarea</span>                     <span class="c">!&lt; area of domain u-outlet</span>
<a name="ln-360"></a>  <span class="kt">real</span>              <span class="kd">::</span> <span class="n">voutarea</span>                     <span class="c">!&lt; area of domain v-outlet</span>
<a name="ln-361"></a>  <span class="kt">real</span>              <span class="kd">::</span> <span class="n">fluidvol</span>                     <span class="c">!&lt; fluid volume (excluding blocks)</span>
<a name="ln-362"></a>
<a name="ln-363"></a>  <span class="kt">character</span><span class="p">(</span><span class="mi">80</span><span class="p">),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">ncname</span><span class="p">(:,:)</span>
<a name="ln-364"></a>  <span class="kt">character</span><span class="p">(</span><span class="mi">80</span><span class="p">),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">ncstaty</span><span class="p">(:,:)</span>
<a name="ln-365"></a>  <span class="kt">character</span><span class="p">(</span><span class="mi">80</span><span class="p">),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">ncstatyt</span><span class="p">(:,:)</span>
<a name="ln-366"></a>  <span class="kt">character</span><span class="p">(</span><span class="mi">80</span><span class="p">),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">ncstattke</span><span class="p">(:,:)</span>
<a name="ln-367"></a>  <span class="kt">character</span><span class="p">(</span><span class="mi">80</span><span class="p">),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">ncstatxy</span><span class="p">(:,:)</span>
<a name="ln-368"></a>  <span class="kt">character</span><span class="p">(</span><span class="mi">80</span><span class="p">),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">ncstatxyt</span><span class="p">(:,:)</span>
<a name="ln-369"></a>  <span class="kt">character</span><span class="p">(</span><span class="mi">80</span><span class="p">),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">ncstatslice</span><span class="p">(:,:)</span>
<a name="ln-370"></a>  <span class="kt">character</span><span class="p">(</span><span class="mi">80</span><span class="p">),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">ncstatt</span><span class="p">(:,:)</span>
<a name="ln-371"></a>
<a name="ln-372"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">wall</span><span class="p">(:,:,:,:)</span>             <span class="c">!&lt; wall(ic,jc,kc,1-5) gives the global indices of the wall closest to cell center ic,jc,kc. The 4th and 5th integer gives the corresponding shear components</span>
<a name="ln-373"></a>
<a name="ln-374"></a><span class="k">contains</span>
<a name="ln-375"></a>  <span class="c">!&gt; Allocate and initialize the prognostic variables</span>
<a name="ln-376"></a>  <span class="k">subroutine </span><span class="n">initfields</span>
<a name="ln-377"></a>
<a name="ln-378"></a>    <span class="k">use </span><span class="n">modglobal</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">ib</span><span class="p">,</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">,</span><span class="n">je</span><span class="p">,</span><span class="n">ih</span><span class="p">,</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="p">,</span><span class="n">kh</span><span class="p">,</span><span class="n">nsv</span><span class="p">,</span><span class="n">jtot</span><span class="p">,</span><span class="n">imax</span><span class="p">,</span><span class="n">jmax</span><span class="p">,</span><span class="n">kmax</span><span class="p">,&amp;</span>
<a name="ln-379"></a>         <span class="n">ihc</span><span class="p">,</span><span class="n">jhc</span><span class="p">,</span><span class="n">khc</span><span class="c">!, iadv_kappa,iadv_sv</span>
<a name="ln-380"></a>    <span class="c">! Allocation of prognostic variables</span>
<a name="ln-381"></a>    <span class="k">implicit none</span>
<a name="ln-382"></a>
<a name="ln-383"></a><span class="k">    allocate</span><span class="p">(</span><span class="n">worksave</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">imax</span><span class="o">*</span><span class="n">jmax</span><span class="o">*</span><span class="n">kmax</span><span class="p">))</span>
<a name="ln-384"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">um</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-385"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">vm</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-386"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">wm</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-387"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thlm</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-388"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">e12m</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-389"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qtm</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-390"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">u0</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-391"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">v0</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-392"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">w0</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-393"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">pres0</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-394"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thl0</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-395"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thl0h</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-396"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qt0h</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-397"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">e120</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-398"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qt0</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-399"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">ql0</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-400"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">up</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-401"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">vp</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-402"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">wp</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-403"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thlp</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-404"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">e12p</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-405"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qtp</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-406"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">svm</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ihc</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ihc</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jhc</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jhc</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">khc</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">khc</span><span class="p">,</span><span class="n">nsv</span><span class="p">))</span>
<a name="ln-407"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">sv0</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ihc</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ihc</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jhc</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jhc</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">khc</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">khc</span><span class="p">,</span><span class="n">nsv</span><span class="p">))</span>
<a name="ln-408"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">svp</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ihc</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ihc</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jhc</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jhc</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">khc</span><span class="p">,</span><span class="n">nsv</span><span class="p">))</span>
<a name="ln-409"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">svpp</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ihc</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ihc</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jhc</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jhc</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">khc</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span> 
<a name="ln-410"></a>
<a name="ln-411"></a>    <span class="c">! Allocation of diagnostic variables</span>
<a name="ln-412"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">mindist</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-413"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thv0h</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-414"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">whls</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-415"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">presf</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-416"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">presh</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-417"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">exnf</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-418"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">exnh</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-419"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thvf</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-420"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thvh</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-421"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">rhof</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-422"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qt0av</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-423"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">ql0av</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-424"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thl0av</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-425"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">u0av</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-426"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">v0av</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-427"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">ug</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-428"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">vg</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-429"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">pgx</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-430"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">pgy</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-431"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">dpdxl</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-432"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">dpdyl</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-433"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">dthldxls</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-434"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">dthldyls</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-435"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">dqtdxls</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-436"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">dqtdyls</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-437"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">dqtdtls</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-438"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">dudxls</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-439"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">dudyls</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-440"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">dvdxls</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-441"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">dvdyls</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-442"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">wfls</span>  <span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-443"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">ql0h</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-444"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">dthvdz</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-445"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thlprof</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-446"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qtprof</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-447"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qlprof</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-448"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">uprof</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-449"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">vprof</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-450"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">e12prof</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-451"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">sv0av</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">khc</span><span class="p">,</span><span class="n">nsv</span><span class="p">))</span>
<a name="ln-452"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">svprof</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">,</span><span class="n">nsv</span><span class="p">))</span>
<a name="ln-453"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thlpcar</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-454"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">uout</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>         <span class="c">! height average outlet velocity (used in convective outflow BC)</span>
<a name="ln-455"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">vout</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-456"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">wout</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">))</span>         <span class="c">! j -averaged top velocity</span>
<a name="ln-457"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">friction</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">))</span>     <span class="c">! line-averaged (along j) skin friction </span>
<a name="ln-458"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">momthick</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">))</span>     <span class="c">! line-averaged (along j) momentum thickness </span>
<a name="ln-459"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">displthick</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">))</span>   <span class="c">! line-averaged (along j) displacement thickness </span>
<a name="ln-460"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">SW_up_TOA</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">))</span>
<a name="ln-461"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">SW_dn_TOA</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">))</span>
<a name="ln-462"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">LW_up_TOA</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">))</span>
<a name="ln-463"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">LW_dn_TOA</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">))</span>
<a name="ln-464"></a>
<a name="ln-465"></a>    <span class="c">! allocate averaged variables</span>
<a name="ln-466"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">uav</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-467"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">vav</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-468"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">wav</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-469"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thlav</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-470"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qtav</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-471"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qlav</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-472"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">presav</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-473"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">svav</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">nsv</span><span class="p">))</span>
<a name="ln-474"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">viscratioav</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-475"></a>
<a name="ln-476"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">IIc</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ihc</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ihc</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jhc</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jhc</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">khc</span><span class="p">))</span>
<a name="ln-477"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">IIu</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ihc</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ihc</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jhc</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jhc</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">khc</span><span class="p">))</span>
<a name="ln-478"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">IIv</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ihc</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ihc</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jhc</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jhc</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">khc</span><span class="p">))</span>
<a name="ln-479"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">IIw</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ihc</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ihc</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jhc</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jhc</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">khc</span><span class="p">))</span>
<a name="ln-480"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">IIuw</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ihc</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ihc</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jhc</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jhc</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">khc</span><span class="p">))</span>
<a name="ln-481"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">IIvw</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ihc</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ihc</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jhc</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jhc</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">khc</span><span class="p">))</span>
<a name="ln-482"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">IIuv</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ihc</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ihc</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jhc</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jhc</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">khc</span><span class="p">))</span>
<a name="ln-483"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">IIct</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-484"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">IIwt</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-485"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">IIuwt</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-486"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">IIut</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-487"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">IIvt</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-488"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">IIcs</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">khc</span><span class="p">))</span>
<a name="ln-489"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">IIus</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">khc</span><span class="p">))</span>
<a name="ln-490"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">IIvs</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">khc</span><span class="p">))</span>
<a name="ln-491"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">IIws</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">khc</span><span class="p">))</span>
<a name="ln-492"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">IIuws</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">khc</span><span class="p">))</span>
<a name="ln-493"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">IIvws</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">khc</span><span class="p">))</span>
<a name="ln-494"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">IIuvs</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">khc</span><span class="p">))</span>
<a name="ln-495"></a>
<a name="ln-496"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">uyt</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-497"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">uytik</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-498"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">vyt</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-499"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">wyt</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-500"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">wytik</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-501"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thlyt</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-502"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qtyt</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-503"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thlytk</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-504"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">sca1yt</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-505"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">sca2yt</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-506"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">sca3yt</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-507"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">usgsyt</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-508"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thlsgsyt</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-509"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qtsgsyt</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-510"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">wsgsyt</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-511"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">sv1sgsyt</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-512"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">sv2sgsyt</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-513"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">sv3sgsyt</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-514"></a>
<a name="ln-515"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">uxyt</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-516"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">vxyt</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-517"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">wxyt</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-518"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thlxyt</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-519"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qtxyt</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-520"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">pxyt</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-521"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">usgsxyt</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-522"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thlsgsxyt</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-523"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">vsgsxyt</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-524"></a>
<a name="ln-525"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">uwtik</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-526"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">wthltk</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-527"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">wqttk</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-528"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thlthlt</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-529"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qtqtt</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-530"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">sv1sv1t</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-531"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">sv2sv2t</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-532"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">sv3sv3t</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-533"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">sv4sv4t</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-534"></a>    <span class="c">! allocate(sv1max(ib:ie,jb:je,kb:ke+kh))</span>
<a name="ln-535"></a>    <span class="c">! allocate(sv2max(ib:ie,jb:je,kb:ke+kh))</span>
<a name="ln-536"></a>    <span class="c">! allocate(sv3max(ib:ie,jb:je,kb:ke+kh))</span>
<a name="ln-537"></a>    <span class="c">! allocate(sv4max(ib:ie,jb:je,kb:ke+kh))</span>
<a name="ln-538"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">PSSt</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-539"></a>
<a name="ln-540"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">uutc</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-541"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">vvtc</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-542"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">wwtc</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-543"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">vwtjk</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-544"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">uvtij</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-545"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">utik</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-546"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">wtik</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-547"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">vtjk</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-548"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">wtjk</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-549"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">utij</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-550"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">vtij</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-551"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">wmt</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-552"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thltk</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-553"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qttk</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-554"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thlt</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-555"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">utc</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-556"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">vtc</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-557"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">wtc</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-558"></a>
<a name="ln-559"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">umt</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-560"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">vmt</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-561"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">sv1t</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-562"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">sv2t</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-563"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">sv3t</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-564"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">sv4t</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-565"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">sv1tk</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-566"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">sv2tk</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-567"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">sv3tk</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-568"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">sv4tk</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-569"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">wsv1tk</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-570"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">wsv2tk</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-571"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">wsv3tk</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-572"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">wsv4tk</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-573"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">sv1sgst</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-574"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">sv2sgst</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-575"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">sv3sgst</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-576"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">sv4sgst</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-577"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qtt</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-578"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">pt</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-579"></a>
<a name="ln-580"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">slice</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">))</span>
<a name="ln-581"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">slice2</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">))</span>
<a name="ln-582"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">slice3</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">))</span>  
<a name="ln-583"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">slice4</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">))</span>
<a name="ln-584"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">slice5</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">))</span> 
<a name="ln-585"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">slice6</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">))</span>  
<a name="ln-586"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">slice7</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">))</span>
<a name="ln-587"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">slice8</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">))</span>
<a name="ln-588"></a>
<a name="ln-589"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">scar</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">jtot</span><span class="p">))</span>
<a name="ln-590"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">scarl</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">))</span>
<a name="ln-591"></a>
<a name="ln-592"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thl2av</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-593"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">ql2av</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-594"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qt2av</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-595"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">sv2av</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">nsv</span><span class="p">))</span>
<a name="ln-596"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">umint</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-597"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">vmint</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-598"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">wmint</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-599"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">uuav</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-600"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">vvav</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-601"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">wwav</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-602"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">uvav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span>   <span class="p">))</span>
<a name="ln-603"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">uwav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span>   <span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-604"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">vwav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span>   <span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-605"></a>
<a name="ln-606"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thluav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span>   <span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span>   <span class="p">))</span>
<a name="ln-607"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thlvav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span>   <span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span>   <span class="p">))</span>
<a name="ln-608"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thlwav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span>   <span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span>   <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-609"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thlthlav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span>   <span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span>   <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-610"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qluav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span>   <span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span>   <span class="p">))</span>
<a name="ln-611"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qlvav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span>   <span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span>   <span class="p">))</span>
<a name="ln-612"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qlwav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span>   <span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span>   <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-613"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qtuav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span>   <span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span>   <span class="p">))</span>
<a name="ln-614"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qtvav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span>   <span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span>   <span class="p">))</span>
<a name="ln-615"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qtwav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span>   <span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span>   <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-616"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">svuav</span> <span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span>   <span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span>   <span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">nsv</span><span class="p">))</span>
<a name="ln-617"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">svvav</span> <span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span>   <span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span>   <span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">nsv</span><span class="p">))</span>
<a name="ln-618"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">svwav</span> <span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span>   <span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span>   <span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">nsv</span><span class="p">))</span>
<a name="ln-619"></a>
<a name="ln-620"></a>    <span class="c">! &lt;x&#39;x&gt; ( = &lt;xx&gt; -&lt;x&gt;&lt;x&gt; )</span>
<a name="ln-621"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">upupav</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-622"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">vpvpav</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-623"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">wpwpav</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-624"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">upvpav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span>   <span class="p">))</span>
<a name="ln-625"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">upwpav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span>   <span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-626"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">vpwpav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span>   <span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-627"></a>
<a name="ln-628"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thlpthlpav</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-629"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thlpupav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span>   <span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span>   <span class="p">))</span>
<a name="ln-630"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thlpvpav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span>   <span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span>   <span class="p">))</span>
<a name="ln-631"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thlpwpav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span>   <span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span>   <span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-632"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qlpqlpav</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-633"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qlpupav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span>   <span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span>   <span class="p">))</span>
<a name="ln-634"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qlpvpav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span>   <span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span>   <span class="p">))</span>
<a name="ln-635"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qlpwpav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span>   <span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span>   <span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-636"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qtpqtpav</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-637"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qtpupav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span>   <span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span>   <span class="p">))</span>
<a name="ln-638"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qtpvpav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span>   <span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span>   <span class="p">))</span>
<a name="ln-639"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qtpwpav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span>   <span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span>   <span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-640"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">svpsvpav</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">nsv</span><span class="p">))</span>
<a name="ln-641"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">svpupav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span>   <span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span>   <span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">nsv</span><span class="p">))</span>
<a name="ln-642"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">svpvpav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span>   <span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span>   <span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">nsv</span><span class="p">))</span>
<a name="ln-643"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">svpwpav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span>   <span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span>   <span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">nsv</span><span class="p">))</span>
<a name="ln-644"></a> 
<a name="ln-645"></a><span class="c">! Subgrid</span>
<a name="ln-646"></a>
<a name="ln-647"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">uusgsav</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-648"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">vvsgsav</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-649"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">wwsgsav</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-650"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">uwsgsav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span>   <span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-651"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thlusgsav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span>   <span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span>   <span class="p">))</span>
<a name="ln-652"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thlwsgsav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span>   <span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span>   <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-653"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qlusgsav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span>   <span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span>   <span class="p">))</span>
<a name="ln-654"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qlwsgsav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span>   <span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span>   <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-655"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qtusgsav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span>   <span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span>   <span class="p">))</span>
<a name="ln-656"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qtwsgsav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span>   <span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span>   <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-657"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">tkesgsav</span> <span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span>   <span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span>   <span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span>   <span class="p">))</span>
<a name="ln-658"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">svusgsav</span> <span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span>   <span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span>   <span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">nsv</span><span class="p">))</span>
<a name="ln-659"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">svwsgsav</span> <span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span>   <span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span>   <span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">nsv</span><span class="p">))</span>
<a name="ln-660"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">nusgsav</span>  <span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span>   <span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span>   <span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span>   <span class="p">))</span>
<a name="ln-661"></a>
<a name="ln-662"></a><span class="c">! resolved dissipation</span>
<a name="ln-663"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">strain2av</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-664"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">disssgsav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-665"></a>
<a name="ln-666"></a><span class="c">! TKE budget terms</span>
<a name="ln-667"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">tvmx</span>  <span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-668"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">tvmy</span>  <span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-669"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">tvmz</span>  <span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-670"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">tpm</span>   <span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-671"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">ttmx</span>  <span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span>    <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-672"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">ttmy</span>  <span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span>  <span class="n">jb</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-673"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">ttmz</span>  <span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span>  <span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span>    <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-674"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">tsgsmx1</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-675"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">tsgsmy1</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-676"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">tsgsmz1</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-677"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">tsgsmx2</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-678"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">tsgsmy2</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-679"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">tsgsmz2</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-680"></a>    
<a name="ln-681"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">t_pav</span>  <span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-682"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">t_vav</span>  <span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-683"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">t_tav</span>  <span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-684"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">t_sgsav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-685"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">p_tav</span>  <span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-686"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">p_bav</span>  <span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-687"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">d_sgsav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-688"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">tkeadv</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-689"></a>
<a name="ln-690"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">t_p</span>    <span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-691"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">t_v</span>    <span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-692"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">t_t</span>    <span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-693"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">t_sgs</span>  <span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-694"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">p_t</span>    <span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-695"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">p_b</span>    <span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-696"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">d_sgs</span>  <span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-697"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">adv</span>    <span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-698"></a>
<a name="ln-699"></a>    <span class="c">! allocate wall shear-stress terms (immersed boundaries)</span>
<a name="ln-700"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">shear</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">12</span><span class="p">))</span>    <span class="c">! halo is set to 1</span>
<a name="ln-701"></a><span class="c">!     allocate(shear(ib:ie,jb-1:je+1,kb:ke,12)</span>
<a name="ln-702"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">momfluxb</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-703"></a>  <span class="c">!  write(*,*) &quot;allocate momfluxb, indeces:&quot;,ib-ih,ie+ih,jb-jh,je+jh,kb,ke+kh </span>
<a name="ln-704"></a>   <span class="k">allocate</span><span class="p">(</span><span class="n">tfluxb</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-705"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qfluxb</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-706"></a>   <span class="k">allocate</span><span class="p">(</span><span class="n">cth</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-707"></a>
<a name="ln-708"></a>
<a name="ln-709"></a>    <span class="n">momfluxb</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">tfluxb</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">qfluxb</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">cth</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-710"></a>
<a name="ln-711"></a>
<a name="ln-712"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">wall</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>              <span class="c">! </span>
<a name="ln-713"></a>
<a name="ln-714"></a>    <span class="n">um</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">u0</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">up</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-715"></a>    <span class="n">vm</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">v0</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">vp</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-716"></a>    <span class="n">wm</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">w0</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">wp</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-717"></a>    <span class="n">pres0</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span>
<a name="ln-718"></a>    <span class="n">thlm</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">thl0</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">thlp</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-719"></a>    <span class="n">qtm</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">qt0</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">qtp</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-720"></a>    <span class="n">e12m</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">e120</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">e12p</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-721"></a>    <span class="n">svm</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">sv0</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">svp</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">svpp</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-722"></a>
<a name="ln-723"></a>    <span class="n">ql0</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">qt0h</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span>
<a name="ln-724"></a>    <span class="n">thv0h</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">thl0h</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span>
<a name="ln-725"></a>    <span class="n">mindist</span><span class="o">=</span><span class="mf">1.0e10</span><span class="p">;</span>
<a name="ln-726"></a>    <span class="n">presf</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">presh</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">exnf</span><span class="o">=</span><span class="mf">1.</span><span class="p">;</span><span class="n">exnh</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">thvf</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">thvh</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">rhof</span><span class="o">=</span><span class="mf">0.</span>    <span class="c">! OG   </span>
<a name="ln-727"></a>    <span class="c">!Exner function should be called in startup and just be initialised here</span>
<a name="ln-728"></a>    <span class="n">qt0av</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">ql0av</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">thl0av</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">u0av</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">v0av</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">sv0av</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-729"></a>    <span class="n">thlprof</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">qtprof</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">qlprof</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">uprof</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">vprof</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">e12prof</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">svprof</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-730"></a>    <span class="n">ug</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">vg</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">pgx</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">pgy</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">dpdxl</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">dpdyl</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">wfls</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">whls</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">thlpcar</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span><span class="n">uout</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">vout</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">wout</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">udef</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">vdef</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">uouttot</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">wouttot</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">vouttot</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-731"></a>    <span class="n">dthldxls</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">dthldyls</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">dqtdxls</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">dqtdyls</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">dudxls</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">dudyls</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">dvdxls</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">dvdyls</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-732"></a>    <span class="n">dthvdz</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-733"></a>    <span class="n">SW_up_TOA</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">SW_dn_TOA</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">LW_up_TOA</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">LW_dn_TOA</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-734"></a>
<a name="ln-735"></a>    <span class="n">uyt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">uytik</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">vyt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">wyt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">wytik</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">thlyt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">qtyt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">thlytk</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">sca1yt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">sca2yt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">sca3yt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">thlsgsyt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">wsgsyt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">qtsgsyt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">sv1sgsyt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">sv2sgsyt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">sv3sgsyt</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-736"></a>    <span class="n">usgsyt</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-737"></a>    <span class="n">uxyt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">vxyt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">wxyt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">thlxyt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">qtxyt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">pxyt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">usgsxyt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">vsgsxyt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">thlsgsxyt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span>
<a name="ln-738"></a>    <span class="n">uwtik</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">wthltk</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">wqttk</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">thlthlt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">qtqtt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">sv1sv1t</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">sv2sv2t</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">sv3sv3t</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">sv4sv4t</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">uutc</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">vvtc</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">wwtc</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">vwtjk</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">uvtij</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">utik</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">wtik</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">wtjk</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">vtjk</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">utij</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">vtij</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span>
<a name="ln-739"></a>    <span class="n">wmt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">thltk</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">qttk</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">thlt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">slice</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">slice2</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">slice3</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">slice4</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">slice5</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">utc</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">vtc</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">wtc</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-740"></a>    <span class="n">slice6</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">slice7</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">slice8</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">umt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">vmt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">sv1t</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">sv2t</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">sv3t</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">sv4t</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">sv1tk</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">sv2tk</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">sv3tk</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">sv4tk</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-741"></a>    <span class="n">wsv1tk</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">wsv2tk</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">wsv3tk</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">wsv4tk</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">sv1sgst</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">sv2sgst</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">sv3sgst</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">sv4sgst</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">qtt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">pt</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-742"></a>    <span class="n">PSSt</span> <span class="o">=</span> <span class="mf">0.</span> <span class="c">!sv1max = 0.; sv2max = 0.; sv3max = 0.; sv4max = 0.</span>
<a name="ln-743"></a>
<a name="ln-744"></a>    <span class="n">scar</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">scarl</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-745"></a>
<a name="ln-746"></a>    <span class="n">IIc</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">IIu</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">IIv</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">IIct</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">IIw</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">IIuw</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">IIvw</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">IIuwt</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">IIut</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">IIvt</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">IIwt</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">IIcs</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">IIus</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">IIvs</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">IIws</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">IIuws</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">IIvws</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">IIuw</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">IIuvs</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-747"></a>
<a name="ln-748"></a>    <span class="n">uav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">vav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">wav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">thlav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">qtav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">svav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">viscratioav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">uuav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">vvav</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-749"></a>    <span class="n">wwav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">uvav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">uwav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">vwav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">sv2av</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">thl2av</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">ql2av</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">qt2av</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">presav</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-750"></a>    <span class="n">thluav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">thlvav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">thlwav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">thlthlav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">svuav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">svvav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">svwav</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-751"></a>    <span class="n">shear</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-752"></a>    <span class="n">upupav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">vpvpav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">wpwpav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">thlpthlpav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">qlpqlpav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">qtpqtpav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">svpsvpav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">upvpav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">upwpav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">vpwpav</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-753"></a>    <span class="n">thlpupav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">thlpvpav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">thlpwpav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">qlpupav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">qlpvpav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">qlpwpav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">qtpwpav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">qtpvpav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">qtpupav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">svpupav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">svpvpav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">svpwpav</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-754"></a>    <span class="n">umint</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">vmint</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">wmint</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-755"></a><span class="c">! SGS</span>
<a name="ln-756"></a>    <span class="n">uusgsav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">vvsgsav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">wwsgsav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">uwsgsav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">thlusgsav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">thlwsgsav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">qlusgsav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">qlwsgsav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">qtwsgsav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">qtusgsav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span>
<a name="ln-757"></a>    <span class="n">svusgsav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">svwsgsav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">tkesgsav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">nusgsav</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-758"></a><span class="c">! Resolved dissipation </span>
<a name="ln-759"></a>    <span class="n">strain2av</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-760"></a><span class="c">! Subgrid dissipation </span>
<a name="ln-761"></a>    <span class="n">disssgsav</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-762"></a><span class="c">! TKE budget</span>
<a name="ln-763"></a>    <span class="n">t_vav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">tvmx</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">tvmy</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">tvmz</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">tpm</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">ttmx</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">ttmy</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">ttmz</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">t_sgsav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">p_tav</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-764"></a>    <span class="n">tsgsmx1</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">tsgsmy1</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">tsgsmz1</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">tsgsmx2</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">tsgsmy2</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">tsgsmz2</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-765"></a>    <span class="n">t_pav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">t_tav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">p_bav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">d_sgsav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">tkeadv</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">t_p</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">t_v</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">t_t</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">t_sgs</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">p_t</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">p_b</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">d_sgs</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">adv</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-766"></a>    <span class="c">! domain fluid volume and area calculations</span>
<a name="ln-767"></a>    <span class="n">uoutarea</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">voutarea</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">fluidvol</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-768"></a>  <span class="k">end subroutine </span><span class="n">initfields</span>
<a name="ln-769"></a>
<a name="ln-770"></a>  <span class="c">!&gt; Deallocate the fields</span>
<a name="ln-771"></a>  <span class="k">subroutine </span><span class="n">exitfields</span>
<a name="ln-772"></a>    <span class="k">implicit none</span>
<a name="ln-773"></a>
<a name="ln-774"></a><span class="k">    deallocate</span><span class="p">(</span><span class="n">um</span><span class="p">,</span><span class="n">vm</span><span class="p">,</span><span class="n">wm</span><span class="p">,</span><span class="n">thlm</span><span class="p">,</span><span class="n">e12m</span><span class="p">,</span><span class="n">qtm</span><span class="p">,</span><span class="n">u0</span><span class="p">,</span><span class="n">v0</span><span class="p">,</span><span class="n">w0</span><span class="p">,</span><span class="n">pres0</span><span class="p">,</span><span class="n">thl0</span><span class="p">,</span><span class="n">thl0h</span><span class="p">,</span><span class="n">qt0h</span><span class="p">,</span><span class="n">e120</span><span class="p">,</span><span class="n">qt0</span><span class="p">)</span>
<a name="ln-775"></a>    <span class="k">deallocate</span><span class="p">(</span><span class="n">up</span><span class="p">,</span><span class="n">vp</span><span class="p">,</span><span class="n">wp</span><span class="p">,</span><span class="n">thlp</span><span class="p">,</span><span class="n">e12p</span><span class="p">,</span><span class="n">qtp</span><span class="p">)</span>
<a name="ln-776"></a>    <span class="k">deallocate</span><span class="p">(</span><span class="n">svm</span><span class="p">,</span><span class="n">sv0</span><span class="p">,</span><span class="n">svp</span><span class="p">,</span><span class="n">svpp</span><span class="p">)</span>
<a name="ln-777"></a>    <span class="k">deallocate</span><span class="p">(</span><span class="n">ql0</span><span class="p">,</span><span class="n">ql0h</span><span class="p">,</span><span class="n">thv0h</span><span class="p">,</span><span class="n">dthvdz</span><span class="p">,</span><span class="n">whls</span><span class="p">,</span><span class="n">presf</span><span class="p">,</span><span class="n">presh</span><span class="p">,</span><span class="n">exnf</span><span class="p">,</span><span class="n">exnh</span><span class="p">,</span><span class="n">thvf</span><span class="p">,</span><span class="n">thvh</span><span class="p">,</span><span class="n">rhof</span><span class="p">,</span><span class="n">qt0av</span><span class="p">,</span><span class="n">ql0av</span><span class="p">,</span><span class="n">thl0av</span><span class="p">,</span><span class="n">u0av</span><span class="p">,</span><span class="n">v0av</span><span class="p">)</span>
<a name="ln-778"></a>    <span class="k">deallocate</span><span class="p">(</span><span class="n">ug</span><span class="p">,</span><span class="n">vg</span><span class="p">,</span><span class="n">pgx</span><span class="p">,</span><span class="n">pgy</span><span class="p">,</span><span class="n">dpdxl</span><span class="p">,</span><span class="n">dpdyl</span><span class="p">,</span><span class="n">dthldxls</span><span class="p">,</span><span class="n">dthldyls</span><span class="p">,</span><span class="n">dqtdxls</span><span class="p">,</span><span class="n">dqtdyls</span><span class="p">,</span><span class="n">dqtdtls</span><span class="p">,</span><span class="n">dudxls</span><span class="p">,</span><span class="n">dudyls</span><span class="p">,</span><span class="n">dvdxls</span><span class="p">,</span><span class="n">dvdyls</span><span class="p">,</span><span class="n">wfls</span><span class="p">)</span>
<a name="ln-779"></a>    <span class="k">deallocate</span><span class="p">(</span><span class="n">thlprof</span><span class="p">,</span><span class="n">qtprof</span><span class="p">,</span><span class="n">uprof</span><span class="p">,</span><span class="n">vprof</span><span class="p">,</span><span class="n">e12prof</span><span class="p">,</span><span class="n">sv0av</span><span class="p">,</span><span class="n">svprof</span><span class="p">)</span>
<a name="ln-780"></a>    <span class="k">deallocate</span><span class="p">(</span><span class="n">thlpcar</span><span class="p">)</span>
<a name="ln-781"></a>    <span class="k">deallocate</span><span class="p">(</span><span class="n">momfluxb</span><span class="p">,</span><span class="n">tfluxb</span><span class="p">,</span><span class="n">qfluxb</span><span class="p">,</span><span class="n">cth</span><span class="p">)</span>
<a name="ln-782"></a>    <span class="k">deallocate</span><span class="p">(</span><span class="n">SW_up_TOA</span><span class="p">,</span><span class="n">SW_dn_TOA</span><span class="p">,</span><span class="n">LW_up_TOA</span><span class="p">,</span><span class="n">LW_dn_TOA</span><span class="p">)</span>
<a name="ln-783"></a>
<a name="ln-784"></a>  <span class="k">end subroutine </span><span class="n">exitfields</span>
<a name="ln-785"></a>
<a name="ln-786"></a><span class="k">end module </span><span class="n">modfields</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2021 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> uDALES was developed by The uDALES Team</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>