<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
    <meta name="description" content="Documentation for uDALES">
   
    <meta name="author" content="The uDALES Team" >
    <link rel="icon" href="../favicon.png">

    <title>advec_2nd.f90 &ndash; uDALES</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">uDALES </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/dalesurban.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/dalesurban.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>advec_2nd.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.9% of total for source files.">132 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/advec_2nd.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">advec_2nd.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 














<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#subs-0">Subroutines</a></h3></div>
  <div class="list-group">
    <div id="subs-0" class="panel-collapse collapse">
      
      <a class="list-group-item" href="../proc/advecc_2nd.html">advecc_2nd</a>
      
      <a class="list-group-item" href="../proc/advecu_2nd.html">advecu_2nd</a>
      
      <a class="list-group-item" href="../proc/advecv_2nd.html">advecv_2nd</a>
      
      <a class="list-group-item" href="../proc/advecw_2nd.html">advecw_2nd</a>
      
    </div>
  </div>
</div>









<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/advec_2nd.f90.html#src">advec_2nd.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~advec_2nd.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefileadvec_2ndf90EfferentGraph" width="561pt" height="276pt"
 viewBox="0.00 0.00 561.00 275.72" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~advec_2nd.f90~~EfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 271.7162)">
<title>sourcefile~~advec_2nd.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-271.7162 557,-271.7162 557,4 -4,4"/>
<!-- sourcefile~advec_2nd.f90 -->
<g id="sourcefile~~advec_2nd.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~advec_2nd.f90</title>
<polygon fill="none" stroke="#000000" points="553,-126 470,-126 470,-102 553,-102 553,-126"/>
<text text-anchor="middle" x="511.5" y="-111.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">advec_2nd.f90</text>
</g>
<!-- sourcefile~modibm.f90 -->
<g id="sourcefile~~advec_2nd.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~modibm.f90</title>
<g id="a_sourcefile~~advec_2nd.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/modibm.f90.html" xlink:title="modibm.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="434,-126 365,-126 365,-102 434,-102 434,-126"/>
<text text-anchor="middle" x="399.5" y="-111.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modibm.f90</text>
</a>
</g>
</g>
<!-- sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modibm.f90 -->
<g id="sourcefile~~advec_2nd.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modibm.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M469.7953,-114C461.4828,-114 452.7198,-114 444.3081,-114"/>
<polygon fill="#ff0000" stroke="#ff0000" points="444.2757,-110.5001 434.2757,-114 444.2757,-117.5001 444.2757,-110.5001"/>
</g>
<!-- sourcefile~modmpi.f90 -->
<g id="sourcefile~~advec_2nd.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~modmpi.f90</title>
<g id="a_sourcefile~~advec_2nd.f90~~EfferentGraph_node3"><a xlink:href=".././sourcefile/modmpi.f90.html" xlink:title="modmpi.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="69,-188 0,-188 0,-164 69,-164 69,-188"/>
<text text-anchor="middle" x="34.5" y="-173.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modmpi.f90</text>
</a>
</g>
</g>
<!-- sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~advec_2nd.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M275,-258C217.895,-249.2084 201.0819,-271.8956 145,-258"/>
</g>
<!-- sourcefile~modfields.f90 -->
<g id="sourcefile~~advec_2nd.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~modfields.f90</title>
<g id="a_sourcefile~~advec_2nd.f90~~EfferentGraph_node4"><a xlink:href=".././sourcefile/modfields.f90.html" xlink:title="modfields.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="313,-188 237,-188 237,-164 313,-164 313,-188"/>
<text text-anchor="middle" x="275" y="-173.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modfields.f90</text>
</a>
</g>
</g>
<!-- sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~advec_2nd.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M507.4911,-126.1485C496.3922,-157.2979 461.8866,-238.9051 399.5,-258"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.5,-258C359.8801,-270.1266 364.4939,-218.3769 329,-197 326.2426,-195.3393 323.3308,-193.7657 320.3463,-192.2833"/>
<polygon fill="#ff0000" stroke="#ff0000" points="321.805,-189.1018 311.2563,-188.1139 318.8866,-195.4644 321.805,-189.1018"/>
</g>
<!-- sourcefile~initfac.f90 -->
<g id="sourcefile~~advec_2nd.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~initfac.f90</title>
<g id="a_sourcefile~~advec_2nd.f90~~EfferentGraph_node5"><a xlink:href=".././sourcefile/initfac.f90.html" xlink:title="initfac.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="304,-230 246,-230 246,-206 304,-206 304,-230"/>
<text text-anchor="middle" x="275" y="-215.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">initfac.f90</text>
</a>
</g>
</g>
<!-- sourcefile~advec_2nd.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~advec_2nd.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~advec_2nd.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.5,-258C382.7027,-263.1412 340.7185,-247.4499 310.1365,-234.2339"/>
<polygon fill="#ff0000" stroke="#ff0000" points="311.2169,-230.8854 300.6543,-230.0595 308.3964,-237.292 311.2169,-230.8854"/>
</g>
<!-- sourcefile~modglobal.f90 -->
<g id="sourcefile~~advec_2nd.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~modglobal.f90</title>
<g id="a_sourcefile~~advec_2nd.f90~~EfferentGraph_node6"><a xlink:href=".././sourcefile/modglobal.f90.html" xlink:title="modglobal.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="185,-188 105,-188 105,-164 185,-164 185,-188"/>
<text text-anchor="middle" x="145" y="-173.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modglobal.f90</text>
</a>
</g>
</g>
<!-- sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~advec_2nd.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.5,-258C346.5895,-274.1945 329.689,-266.4196 275,-258"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M275,-258C249.854,-254.1287 243.1393,-251.5364 221,-239 199.8603,-227.0296 178.8299,-209 164.2691,-195.2913"/>
<polygon fill="#ff0000" stroke="#ff0000" points="166.5181,-192.5981 156.8857,-188.1858 161.6641,-197.6419 166.5181,-192.5981"/>
</g>
<!-- sourcefile~modibmdata.f90 -->
<g id="sourcefile~~advec_2nd.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~modibmdata.f90</title>
<g id="a_sourcefile~~advec_2nd.f90~~EfferentGraph_node7"><a xlink:href=".././sourcefile/modibmdata.f90.html" xlink:title="modibmdata.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="320,-24 230,-24 230,0 320,0 320,-24"/>
<text text-anchor="middle" x="275" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modibmdata.f90</text>
</a>
</g>
</g>
<!-- sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modibmdata.f90 -->
<g id="sourcefile~~advec_2nd.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modibmdata.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M485.3737,-101.942C450.0947,-85.7662 385.168,-56.3712 329,-33 324.8658,-31.2798 320.5366,-29.5228 316.2051,-27.7939"/>
<polygon fill="#ff0000" stroke="#ff0000" points="317.3809,-24.4953 306.7942,-24.0791 314.8106,-31.0064 317.3809,-24.4953"/>
</g>
<!-- sourcefile~modibm.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~advec_2nd.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~modibm.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M364.8062,-104.0231C339.9354,-97.9525 305.5665,-91.7612 275,-94"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M275,-94C196.7536,-99.7312 111.151,-137.0759 66.1784,-159.3426"/>
<polygon fill="#ff0000" stroke="#ff0000" points="64.5781,-156.2296 57.2157,-163.8484 67.7223,-162.4838 64.5781,-156.2296"/>
</g>
<!-- sourcefile~modibm.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~advec_2nd.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~modibm.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M380.4907,-126.1435C366.5469,-134.7796 346.9868,-146.3375 329,-155 325.4316,-156.7186 321.6833,-158.4053 317.8951,-160.0293"/>
<polygon fill="#ff0000" stroke="#ff0000" points="316.3824,-156.8672 308.4755,-163.9193 319.0544,-163.3372 316.3824,-156.8672"/>
</g>
<!-- sourcefile~modibm.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~advec_2nd.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~modibm.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M392.0701,-126.0867C380.5758,-143.8786 356.8756,-177.151 329,-197 324.2232,-200.4014 318.8216,-203.3426 313.3276,-205.8569"/>
<polygon fill="#ff0000" stroke="#ff0000" points="311.983,-202.6254 304.0882,-209.691 314.6661,-209.0908 311.983,-202.6254"/>
</g>
<!-- sourcefile~modibm.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~advec_2nd.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~modibm.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M275,-94C229.0927,-97.3625 186.0269,-133.4251 162.8172,-156.5926"/>
<polygon fill="#ff0000" stroke="#ff0000" points="160.1874,-154.2768 155.7319,-163.8892 165.2093,-159.1533 160.1874,-154.2768"/>
</g>
<!-- sourcefile~modibm.f90&#45;&gt;sourcefile~modibmdata.f90 -->
<g id="sourcefile~~advec_2nd.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~modibm.f90&#45;&gt;sourcefile~modibmdata.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M391.8073,-101.9248C380.154,-84.5041 356.4524,-52.2993 329,-33 326.8759,-31.5067 324.6311,-30.1011 322.3117,-28.7806"/>
<polygon fill="#ff0000" stroke="#ff0000" points="323.5937,-25.5064 313.0921,-24.1042 320.4272,-31.7493 323.5937,-25.5064"/>
</g>
<!-- sourcefile~modsubgriddata.f90 -->
<g id="sourcefile~~advec_2nd.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~modsubgriddata.f90</title>
<g id="a_sourcefile~~advec_2nd.f90~~EfferentGraph_node8"><a xlink:href=".././sourcefile/modsubgriddata.f90.html" xlink:title="modsubgriddata.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="329,-66 221,-66 221,-42 329,-42 329,-66"/>
<text text-anchor="middle" x="275" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modsubgriddata.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modibm.f90&#45;&gt;sourcefile~modsubgriddata.f90 -->
<g id="sourcefile~~advec_2nd.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~modibm.f90&#45;&gt;sourcefile~modsubgriddata.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M374.3779,-101.8796C360.9201,-95.3879 344.057,-87.2556 329,-80 322.6392,-76.9349 315.8562,-73.6678 309.3219,-70.5213"/>
<polygon fill="#ff0000" stroke="#ff0000" points="310.5327,-67.2198 300.0044,-66.035 307.496,-73.5268 310.5327,-67.2198"/>
</g>
<!-- sourcefile~modsurfdata.f90 -->
<g id="sourcefile~~advec_2nd.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~modsurfdata.f90</title>
<g id="a_sourcefile~~advec_2nd.f90~~EfferentGraph_node9"><a xlink:href=".././sourcefile/modsurfdata.f90.html" xlink:title="modsurfdata.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="320.5,-146 229.5,-146 229.5,-122 320.5,-122 320.5,-146"/>
<text text-anchor="middle" x="275" y="-131.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modsurfdata.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modibm.f90&#45;&gt;sourcefile~modsurfdata.f90 -->
<g id="sourcefile~~advec_2nd.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~modibm.f90&#45;&gt;sourcefile~modsurfdata.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M364.8198,-119.5711C354.2465,-121.2696 342.3433,-123.1818 330.7448,-125.045"/>
<polygon fill="#ff0000" stroke="#ff0000" points="329.9898,-121.6213 320.6716,-126.6632 331.1001,-128.5327 329.9898,-121.6213"/>
</g>
<!-- sourcefile~modfields.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~advec_2nd.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~modfields.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M236.6988,-176C223.8074,-176 209.22,-176 195.534,-176"/>
<polygon fill="#00ff00" stroke="#00ff00" points="195.287,-172.5001 185.2869,-176 195.2869,-179.5001 195.287,-172.5001"/>
</g>
<!-- sourcefile~initfac.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~advec_2nd.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~initfac.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M247.7221,-230.0252C215.717,-243.4909 164.5398,-262.8414 145,-258"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M145,-258C106.5505,-248.4732 71.5507,-216.8854 51.6629,-195.8122"/>
<polygon fill="#00ffff" stroke="#00ffff" points="54.1381,-193.3326 44.8049,-188.3184 48.9741,-198.0585 54.1381,-193.3326"/>
</g>
<!-- sourcefile~initfac.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~advec_2nd.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~initfac.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M245.8255,-208.5744C230.0347,-203.4727 210.1416,-197.0458 192.2067,-191.2514"/>
<polygon fill="#00ffff" stroke="#00ffff" points="193.0746,-187.8537 182.4828,-188.1098 190.9225,-194.5147 193.0746,-187.8537"/>
</g>
<!-- sourcefile~modglobal.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~advec_2nd.f90~~EfferentGraph_edge17" class="edge">
<title>sourcefile~modglobal.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M104.7944,-176C96.4589,-176 87.6289,-176 79.1455,-176"/>
<polygon fill="#0000ff" stroke="#0000ff" points="79.0261,-172.5001 69.0261,-176 79.0261,-179.5001 79.0261,-172.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="190pt" height="32pt"
 viewBox="0.00 0.00 190.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 186,-28 186,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="67,-24 0,-24 0,0 67,0 67,-24"/>
<text text-anchor="middle" x="33.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="182,-24 85,-24 85,0 182,0 182,-24"/>
<text text-anchor="middle" x="133.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 














<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#subs-1">Subroutines</a></h3></div>
  <div class="list-group">
    <div id="subs-1" class="panel-collapse collapse">
      
      <a class="list-group-item" href="../proc/advecc_2nd.html">advecc_2nd</a>
      
      <a class="list-group-item" href="../proc/advecu_2nd.html">advecu_2nd</a>
      
      <a class="list-group-item" href="../proc/advecv_2nd.html">advecv_2nd</a>
      
      <a class="list-group-item" href="../proc/advecw_2nd.html">advecw_2nd</a>
      
    </div>
  </div>
</div>









<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/advec_2nd.f90.html#src">advec_2nd.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="c">!&gt; \file advec_2nd.f90</span>
<a name="ln-2"></a><span class="c">!!  Does advection with a 2nd order central differencing scheme.</span>
<a name="ln-3"></a><span class="c">!!</span>
<a name="ln-4"></a><span class="c">!! Second order central differencing can be used for variables where neither very</span>
<a name="ln-5"></a><span class="c">!! high accuracy nor strict monotonicity is necessary.</span>
<a name="ln-6"></a><span class="c">!! \latexonly</span>
<a name="ln-7"></a><span class="c">!!\begin{eqnarray}</span>
<a name="ln-8"></a><span class="c">!! F_{i-\frac{1}{2}}^{2nd} &amp;=&amp;</span>
<a name="ln-9"></a><span class="c">!!\fav{u}_{i-\frac{1}{2}}\frac{\phi_{i}+\phi_{i-1}}{2},</span>
<a name="ln-10"></a><span class="c">!!\end{eqnarray}</span>
<a name="ln-11"></a><span class="c">!! \endlatexonly</span>
<a name="ln-12"></a><span class="c">!!</span>
<a name="ln-13"></a><span class="c">!</span>
<a name="ln-14"></a><span class="c">!&gt; Advection at cell center</span>
<a name="ln-15"></a><span class="k">subroutine </span><span class="n">advecc_2nd</span><span class="p">(</span><span class="n">hi</span><span class="p">,</span> <span class="n">hj</span><span class="p">,</span> <span class="n">hk</span><span class="p">,</span> <span class="n">putin</span><span class="p">,</span> <span class="n">putout</span><span class="p">)</span>
<a name="ln-16"></a>
<a name="ln-17"></a>   <span class="k">use </span><span class="n">modglobal</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span><span class="n">ih</span><span class="p">,</span> <span class="n">jh</span><span class="p">,</span> <span class="n">kh</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span><span class="p">,</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ie</span><span class="p">,</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span><span class="p">,</span> <span class="n">dxf</span><span class="p">,</span> <span class="n">dxhi</span><span class="p">,</span> <span class="n">dxfi5</span><span class="p">,</span> <span class="n">dyi5</span><span class="p">,</span> <span class="n">dzf</span><span class="p">,</span> <span class="n">dzfi5</span><span class="p">,</span> <span class="n">dzhi</span><span class="p">,</span> <span class="n">libm</span><span class="p">,</span> <span class="n">jmax</span><span class="p">,</span> <span class="n">dxfi</span><span class="p">,</span> <span class="n">dzfi</span><span class="p">,</span> <span class="n">dyi</span>
<a name="ln-18"></a>   <span class="k">use </span><span class="n">modfields</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span><span class="n">u0</span><span class="p">,</span> <span class="n">v0</span><span class="p">,</span> <span class="n">w0</span>
<a name="ln-19"></a>   <span class="k">use </span><span class="n">modibm</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span><span class="n">nxwallsnorm</span><span class="p">,</span> <span class="n">nzwallsnorm</span><span class="p">,</span> <span class="n">nywallsm</span><span class="p">,</span> <span class="n">nywallsp</span><span class="p">,</span> <span class="n">ywallsm</span><span class="p">,</span> <span class="n">ywallsp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-20"></a>      <span class="n">xwallsnorm</span><span class="p">,</span> <span class="n">zwallsnorm</span><span class="p">,</span> <span class="n">iypluswall</span><span class="p">,</span> <span class="n">iyminwall</span><span class="p">,</span> <span class="n">nyminwall</span><span class="p">,</span> <span class="n">nypluswall</span>
<a name="ln-21"></a>   <span class="k">use </span><span class="n">modibmdata</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span><span class="n">nxwall</span><span class="p">,</span> <span class="n">ixwall</span>
<a name="ln-22"></a>   <span class="k">use </span><span class="n">initfac</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span><span class="k">block</span>
<a name="ln-23"></a><span class="k">   use </span><span class="n">modmpi</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span><span class="n">myid</span>
<a name="ln-24"></a>   <span class="k">implicit none</span>
<a name="ln-25"></a>
<a name="ln-26"></a><span class="k">   </span><span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hi</span> <span class="c">!&lt; size of halo in i</span>
<a name="ln-27"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hj</span> <span class="c">!&lt; size of halo in j</span>
<a name="ln-28"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hk</span> <span class="c">!&lt; size of halo in k</span>
<a name="ln-29"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="n">hi</span><span class="p">:</span><span class="n">ie</span> <span class="o">+</span> <span class="n">hi</span><span class="p">,</span> <span class="n">jb</span> <span class="o">-</span> <span class="n">hj</span><span class="p">:</span><span class="n">je</span> <span class="o">+</span> <span class="n">hj</span><span class="p">,</span> <span class="n">kb</span> <span class="o">-</span> <span class="n">hk</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">hk</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">putin</span> <span class="c">!&lt; Input: the cell centered field</span>
<a name="ln-30"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="n">hi</span><span class="p">:</span><span class="n">ie</span> <span class="o">+</span> <span class="n">hi</span><span class="p">,</span> <span class="n">jb</span> <span class="o">-</span> <span class="n">hj</span><span class="p">:</span><span class="n">je</span> <span class="o">+</span> <span class="n">hj</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">hk</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">putout</span> <span class="c">!&lt; Output: the tendency</span>
<a name="ln-31"></a>
<a name="ln-32"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">ip</span><span class="p">,</span> <span class="n">im</span><span class="p">,</span> <span class="n">jp</span><span class="p">,</span> <span class="n">jm</span><span class="p">,</span> <span class="n">kp</span><span class="p">,</span> <span class="n">km</span><span class="p">,</span> <span class="n">il</span><span class="p">,</span> <span class="n">iu</span><span class="p">,</span> <span class="n">jl</span><span class="p">,</span> <span class="n">ju</span><span class="p">,</span> <span class="n">kl</span><span class="p">,</span> <span class="n">ku</span><span class="p">,</span> <span class="n">n</span>
<a name="ln-33"></a>   <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
<a name="ln-34"></a>      <span class="n">km</span> <span class="o">=</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-35"></a>      <span class="n">kp</span> <span class="o">=</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-36"></a>      <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span>
<a name="ln-37"></a>         <span class="n">jm</span> <span class="o">=</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-38"></a>         <span class="n">jp</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-39"></a>         <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ie</span>
<a name="ln-40"></a>            <span class="n">im</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-41"></a>            <span class="n">ip</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-42"></a>            <span class="n">putout</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">putout</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-43"></a>                              <span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-44"></a>                              <span class="n">u0</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">putin</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">dxf</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">dxf</span><span class="p">(</span><span class="n">ip</span><span class="p">))</span><span class="o">*</span><span class="n">dxhi</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-45"></a>                              <span class="o">-</span> <span class="n">u0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">putin</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">dxf</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">dxf</span><span class="p">(</span><span class="n">im</span><span class="p">))</span><span class="o">*</span><span class="n">dxhi</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="p">&amp;</span> <span class="c">! d(uc)/dx</span>
<a name="ln-46"></a>                              <span class="p">)</span><span class="o">*</span><span class="n">dxfi5</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-47"></a>                              <span class="o">+</span> <span class="p">(</span> <span class="p">&amp;</span> <span class="c">!</span>
<a name="ln-48"></a>                              <span class="n">v0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">jp</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">jp</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-49"></a>                              <span class="o">-</span> <span class="n">v0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">jm</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span> <span class="p">&amp;</span> <span class="c">! d(vc)/dy</span>
<a name="ln-50"></a>                              <span class="p">)</span><span class="o">*</span><span class="n">dyi5</span><span class="p">)</span>
<a name="ln-51"></a>         <span class="k">end do</span>
<a name="ln-52"></a><span class="k">      end do</span>
<a name="ln-53"></a><span class="k">   end do</span>
<a name="ln-54"></a>
<a name="ln-55"></a><span class="k">   do </span><span class="n">j</span> <span class="o">=</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span>
<a name="ln-56"></a>      <span class="n">jm</span> <span class="o">=</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-57"></a>      <span class="n">jp</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-58"></a>      <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ie</span>
<a name="ln-59"></a>         <span class="n">im</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-60"></a>         <span class="n">ip</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-61"></a>         <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
<a name="ln-62"></a>            <span class="n">km</span> <span class="o">=</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-63"></a>            <span class="n">kp</span> <span class="o">=</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-64"></a>            <span class="n">putout</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">putout</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-65"></a>                              <span class="n">w0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">kp</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">kp</span><span class="p">)</span><span class="o">*</span><span class="n">dzf</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">dzf</span><span class="p">(</span><span class="n">kp</span><span class="p">))</span><span class="o">*</span><span class="n">dzhi</span><span class="p">(</span><span class="n">kp</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-66"></a>                              <span class="o">-</span> <span class="n">w0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">km</span><span class="p">)</span><span class="o">*</span><span class="n">dzf</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">dzf</span><span class="p">(</span><span class="n">km</span><span class="p">))</span><span class="o">*</span><span class="n">dzhi</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-67"></a>                              <span class="p">)</span><span class="o">*</span><span class="n">dzfi5</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<a name="ln-68"></a>         <span class="k">end do</span>
<a name="ln-69"></a><span class="k">      end do</span>
<a name="ln-70"></a><span class="k">   end do</span>
<a name="ln-71"></a>
<a name="ln-72"></a><span class="k">end subroutine </span><span class="n">advecc_2nd</span>
<a name="ln-73"></a>
<a name="ln-74"></a><span class="c">!&gt; Advection at the u point.</span>
<a name="ln-75"></a><span class="k">subroutine </span><span class="n">advecu_2nd</span><span class="p">(</span><span class="n">putin</span><span class="p">,</span> <span class="n">putout</span><span class="p">)</span>
<a name="ln-76"></a>
<a name="ln-77"></a>   <span class="k">use </span><span class="n">modglobal</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span><span class="n">ih</span><span class="p">,</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ie</span><span class="p">,</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span><span class="p">,</span> <span class="n">jh</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span><span class="p">,</span> <span class="n">kh</span><span class="p">,</span> <span class="n">dxhiq</span><span class="p">,</span> <span class="n">dyiq</span><span class="p">,</span> <span class="n">dzf</span><span class="p">,</span> <span class="n">dzfi5</span><span class="p">,</span> <span class="n">dzhi</span><span class="p">,</span> <span class="n">dxhi</span><span class="p">,</span> <span class="n">libm</span>
<a name="ln-78"></a>   <span class="k">use </span><span class="n">modfields</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span><span class="n">u0</span><span class="p">,</span> <span class="n">v0</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">pres0</span>
<a name="ln-79"></a>   <span class="k">use </span><span class="n">modibm</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span><span class="n">nxwallsnorm</span><span class="p">,</span> <span class="n">nzwallsnorm</span><span class="p">,</span> <span class="n">nywallsm</span><span class="p">,</span> <span class="n">nywallsp</span><span class="p">,</span> <span class="n">ywallsm</span><span class="p">,</span> <span class="n">ywallsp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-80"></a>      <span class="n">xwallsnorm</span><span class="p">,</span> <span class="n">zwallsnorm</span>
<a name="ln-81"></a>   <span class="k">use </span><span class="n">modmpi</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span><span class="n">myid</span>
<a name="ln-82"></a>   <span class="k">implicit none</span>
<a name="ln-83"></a>
<a name="ln-84"></a><span class="k">   </span><span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="n">ih</span><span class="p">:</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span><span class="p">,</span> <span class="n">jb</span> <span class="o">-</span> <span class="n">jh</span><span class="p">:</span><span class="n">je</span> <span class="o">+</span> <span class="n">jh</span><span class="p">,</span> <span class="n">kb</span> <span class="o">-</span> <span class="n">kh</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">putin</span> <span class="c">!&lt; Input: the u-field</span>
<a name="ln-85"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="n">ih</span><span class="p">:</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span><span class="p">,</span> <span class="n">jb</span> <span class="o">-</span> <span class="n">jh</span><span class="p">:</span><span class="n">je</span> <span class="o">+</span> <span class="n">jh</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">putout</span> <span class="c">!&lt; Output: the tendency</span>
<a name="ln-86"></a>
<a name="ln-87"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">ip</span><span class="p">,</span> <span class="n">im</span><span class="p">,</span> <span class="n">jp</span><span class="p">,</span> <span class="n">jm</span><span class="p">,</span> <span class="n">kp</span><span class="p">,</span> <span class="n">km</span><span class="p">,</span> <span class="n">il</span><span class="p">,</span> <span class="n">iu</span><span class="p">,</span> <span class="n">jl</span><span class="p">,</span> <span class="n">ju</span><span class="p">,</span> <span class="n">kl</span><span class="p">,</span> <span class="n">ku</span><span class="p">,</span> <span class="n">n</span>
<a name="ln-88"></a>
<a name="ln-89"></a>   <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
<a name="ln-90"></a>      <span class="n">km</span> <span class="o">=</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-91"></a>      <span class="n">kp</span> <span class="o">=</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-92"></a>      <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span>
<a name="ln-93"></a>         <span class="n">jm</span> <span class="o">=</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-94"></a>         <span class="n">jp</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-95"></a>         <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ie</span>
<a name="ln-96"></a>            <span class="n">im</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-97"></a>            <span class="n">ip</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-98"></a>            <span class="n">putout</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">putout</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-99"></a>                              <span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-100"></a>                              <span class="p">(</span><span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">putin</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">u0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">u0</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-101"></a>                              <span class="o">-</span> <span class="p">(</span><span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">putin</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">u0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">u0</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span> <span class="p">&amp;</span> <span class="c">! d(uu)/dx</span>
<a name="ln-102"></a>                              <span class="p">)</span><span class="o">*</span><span class="n">dxhiq</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-103"></a>                              <span class="o">+</span> <span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-104"></a>                              <span class="p">(</span><span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">jp</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">v0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">jp</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">v0</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">jp</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-105"></a>                              <span class="o">-</span> <span class="p">(</span><span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">jm</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">v0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">v0</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span> <span class="p">&amp;</span> <span class="c">! d(vu)/dy</span>
<a name="ln-106"></a>                              <span class="p">)</span><span class="o">*</span><span class="n">dyiq</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-107"></a>                              <span class="o">-</span> <span class="p">((</span><span class="n">pres0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">-</span> <span class="n">pres0</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span><span class="o">*</span><span class="n">dxhi</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="c">! - dp/dx</span>
<a name="ln-108"></a>
<a name="ln-109"></a>         <span class="k">end do</span>
<a name="ln-110"></a><span class="k">      end do</span>
<a name="ln-111"></a><span class="k">   end do</span>
<a name="ln-112"></a>
<a name="ln-113"></a><span class="k">   do </span><span class="n">j</span> <span class="o">=</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span>
<a name="ln-114"></a>      <span class="n">jm</span> <span class="o">=</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-115"></a>      <span class="n">jp</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-116"></a>      <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ie</span>
<a name="ln-117"></a>         <span class="n">im</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-118"></a>         <span class="n">ip</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-119"></a>         <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
<a name="ln-120"></a>            <span class="n">km</span> <span class="o">=</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-121"></a>            <span class="n">kp</span> <span class="o">=</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-122"></a>            <span class="n">putout</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">putout</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-123"></a>                              <span class="p">(</span><span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">kp</span><span class="p">)</span><span class="o">*</span><span class="n">dzf</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">dzf</span><span class="p">(</span><span class="n">kp</span><span class="p">))</span><span class="o">*</span><span class="n">dzhi</span><span class="p">(</span><span class="n">kp</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-124"></a>                              <span class="o">*</span><span class="p">(</span><span class="n">w0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">kp</span><span class="p">)</span> <span class="o">+</span> <span class="n">w0</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">kp</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-125"></a>                              <span class="o">-</span> <span class="p">(</span><span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">dzf</span><span class="p">(</span><span class="n">km</span><span class="p">)</span> <span class="o">+</span> <span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">km</span><span class="p">)</span><span class="o">*</span><span class="n">dzf</span><span class="p">(</span><span class="n">k</span><span class="p">))</span><span class="o">*</span><span class="n">dzhi</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-126"></a>                              <span class="o">*</span><span class="p">(</span><span class="n">w0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">w0</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-127"></a>                              <span class="p">)</span><span class="o">*</span><span class="mf">0.5</span><span class="o">*</span><span class="n">dzfi5</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<a name="ln-128"></a>         <span class="k">end do</span>
<a name="ln-129"></a><span class="k">      end do</span>
<a name="ln-130"></a><span class="k">   end do</span>
<a name="ln-131"></a>
<a name="ln-132"></a><span class="k">end subroutine </span><span class="n">advecu_2nd</span>
<a name="ln-133"></a>
<a name="ln-134"></a><span class="c">!&gt; Advection at the v point.</span>
<a name="ln-135"></a><span class="k">subroutine </span><span class="n">advecv_2nd</span><span class="p">(</span><span class="n">putin</span><span class="p">,</span> <span class="n">putout</span><span class="p">)</span>
<a name="ln-136"></a>
<a name="ln-137"></a>   <span class="k">use </span><span class="n">modglobal</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span><span class="n">ih</span><span class="p">,</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ie</span><span class="p">,</span> <span class="n">jh</span><span class="p">,</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span><span class="p">,</span> <span class="n">kh</span><span class="p">,</span> <span class="n">dxf</span><span class="p">,</span> <span class="n">dxhi</span><span class="p">,</span> <span class="n">dxfiq</span><span class="p">,</span> <span class="n">dyiq</span><span class="p">,</span> <span class="n">dzf</span><span class="p">,</span> <span class="n">dzfi5</span><span class="p">,</span> <span class="n">dzhi</span><span class="p">,</span> <span class="n">dyi</span>
<a name="ln-138"></a>   <span class="k">use </span><span class="n">modfields</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span><span class="n">u0</span><span class="p">,</span> <span class="n">v0</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">pres0</span>
<a name="ln-139"></a>   <span class="k">implicit none</span>
<a name="ln-140"></a>
<a name="ln-141"></a><span class="k">   </span><span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="n">ih</span><span class="p">:</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span><span class="p">,</span> <span class="n">jb</span> <span class="o">-</span> <span class="n">jh</span><span class="p">:</span><span class="n">je</span> <span class="o">+</span> <span class="n">jh</span><span class="p">,</span> <span class="n">kb</span> <span class="o">-</span> <span class="n">kh</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">putin</span> <span class="c">!&lt; Input: the v-field</span>
<a name="ln-142"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="n">ih</span><span class="p">:</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span><span class="p">,</span> <span class="n">jb</span> <span class="o">-</span> <span class="n">jh</span><span class="p">:</span><span class="n">je</span> <span class="o">+</span> <span class="n">jh</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">putout</span> <span class="c">!&lt; Output: the tendency</span>
<a name="ln-143"></a>
<a name="ln-144"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">ip</span><span class="p">,</span> <span class="n">im</span><span class="p">,</span> <span class="n">jp</span><span class="p">,</span> <span class="n">jm</span><span class="p">,</span> <span class="n">kp</span><span class="p">,</span> <span class="n">km</span>
<a name="ln-145"></a>   <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
<a name="ln-146"></a>      <span class="n">km</span> <span class="o">=</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-147"></a>      <span class="n">kp</span> <span class="o">=</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-148"></a>      <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span>
<a name="ln-149"></a>         <span class="n">jm</span> <span class="o">=</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-150"></a>         <span class="n">jp</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-151"></a>         <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ie</span>
<a name="ln-152"></a>            <span class="n">im</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-153"></a>            <span class="n">ip</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-154"></a>
<a name="ln-155"></a>            <span class="n">putout</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">putout</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-156"></a>                              <span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-157"></a>                              <span class="p">(</span><span class="n">u0</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">u0</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">jm</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-158"></a>                              <span class="o">*</span><span class="p">(</span><span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">dxf</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span> <span class="o">+</span> <span class="n">putin</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">dxf</span><span class="p">(</span><span class="n">i</span><span class="p">))</span><span class="o">*</span><span class="n">dxhi</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-159"></a>                              <span class="o">-</span> <span class="p">(</span><span class="n">u0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">u0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">jm</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-160"></a>                              <span class="o">*</span><span class="p">(</span><span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">dxf</span><span class="p">(</span><span class="n">im</span><span class="p">)</span> <span class="o">+</span> <span class="n">putin</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">dxf</span><span class="p">(</span><span class="n">i</span><span class="p">))</span><span class="o">*</span><span class="n">dxhi</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="p">&amp;</span> <span class="c">! d(uv)/dx</span>
<a name="ln-161"></a>                              <span class="p">)</span><span class="o">*</span><span class="n">dxfiq</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-162"></a>                              <span class="o">+</span> <span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-163"></a>                              <span class="p">(</span><span class="n">v0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">jp</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">v0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">jp</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-164"></a>                              <span class="o">-</span> <span class="p">(</span><span class="n">v0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">jm</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">v0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">jm</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span> <span class="p">&amp;</span> <span class="c">! d(vv)/dy</span>
<a name="ln-165"></a>                              <span class="p">)</span><span class="o">*</span><span class="n">dyiq</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-166"></a>                              <span class="o">-</span> <span class="p">((</span><span class="n">pres0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">-</span> <span class="n">pres0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span><span class="o">*</span><span class="n">dyi</span><span class="p">)</span> <span class="c">! - dp/dy</span>
<a name="ln-167"></a>
<a name="ln-168"></a>         <span class="k">end do</span>
<a name="ln-169"></a><span class="k">      end do</span>
<a name="ln-170"></a><span class="k">   end do</span>
<a name="ln-171"></a>
<a name="ln-172"></a><span class="k">   do </span><span class="n">j</span> <span class="o">=</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span>
<a name="ln-173"></a>      <span class="n">jm</span> <span class="o">=</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-174"></a>      <span class="n">jp</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-175"></a>      <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ie</span>
<a name="ln-176"></a>         <span class="n">im</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-177"></a>         <span class="n">ip</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-178"></a>         <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
<a name="ln-179"></a>            <span class="n">km</span> <span class="o">=</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-180"></a>            <span class="n">kp</span> <span class="o">=</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-181"></a>            <span class="n">putout</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">putout</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-182"></a>                              <span class="p">(</span><span class="n">w0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">kp</span><span class="p">)</span> <span class="o">+</span> <span class="n">w0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">jm</span><span class="p">,</span> <span class="n">kp</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-183"></a>                              <span class="o">*</span><span class="p">(</span><span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">kp</span><span class="p">)</span><span class="o">*</span><span class="n">dzf</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">dzf</span><span class="p">(</span><span class="n">kp</span><span class="p">))</span><span class="o">*</span><span class="n">dzhi</span><span class="p">(</span><span class="n">kp</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-184"></a>                              <span class="o">-</span> <span class="p">(</span><span class="n">w0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">w0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">jm</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-185"></a>                              <span class="o">*</span><span class="p">(</span><span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">km</span><span class="p">)</span><span class="o">*</span><span class="n">dzf</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">dzf</span><span class="p">(</span><span class="n">km</span><span class="p">))</span><span class="o">*</span><span class="n">dzhi</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-186"></a>                              <span class="p">)</span><span class="o">*</span><span class="mf">0.5</span><span class="o">*</span><span class="n">dzfi5</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<a name="ln-187"></a>         <span class="k">end do</span>
<a name="ln-188"></a><span class="k">      end do</span>
<a name="ln-189"></a><span class="k">   end do</span>
<a name="ln-190"></a>
<a name="ln-191"></a><span class="k">end subroutine </span><span class="n">advecv_2nd</span>
<a name="ln-192"></a>
<a name="ln-193"></a><span class="c">!&gt; Advection at the w point.</span>
<a name="ln-194"></a><span class="k">subroutine </span><span class="n">advecw_2nd</span><span class="p">(</span><span class="n">putin</span><span class="p">,</span> <span class="n">putout</span><span class="p">)</span>
<a name="ln-195"></a>
<a name="ln-196"></a>   <span class="k">use </span><span class="n">modglobal</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span><span class="n">ih</span><span class="p">,</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ie</span><span class="p">,</span> <span class="n">jh</span><span class="p">,</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span><span class="p">,</span> <span class="n">kh</span><span class="p">,</span> <span class="n">dxf</span><span class="p">,</span> <span class="n">dxhi</span><span class="p">,</span> <span class="n">dxfiq</span><span class="p">,</span> <span class="n">dyiq</span><span class="p">,</span> <span class="n">dzf</span><span class="p">,</span> <span class="n">dzhi</span><span class="p">,</span> <span class="n">dzhiq</span>
<a name="ln-197"></a>   <span class="k">use </span><span class="n">modfields</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span><span class="n">u0</span><span class="p">,</span> <span class="n">v0</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">pres0</span>
<a name="ln-198"></a>   <span class="c">! use modmpi, only : myid</span>
<a name="ln-199"></a>   <span class="k">implicit none</span>
<a name="ln-200"></a>
<a name="ln-201"></a><span class="k">   </span><span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="n">ih</span><span class="p">:</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span><span class="p">,</span> <span class="n">jb</span> <span class="o">-</span> <span class="n">jh</span><span class="p">:</span><span class="n">je</span> <span class="o">+</span> <span class="n">jh</span><span class="p">,</span> <span class="n">kb</span> <span class="o">-</span> <span class="n">kh</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">putin</span> <span class="c">!&lt; Input: the w-field</span>
<a name="ln-202"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="n">ih</span><span class="p">:</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span><span class="p">,</span> <span class="n">jb</span> <span class="o">-</span> <span class="n">jh</span><span class="p">:</span><span class="n">je</span> <span class="o">+</span> <span class="n">jh</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">putout</span> <span class="c">!&lt; Output: the tendency</span>
<a name="ln-203"></a>
<a name="ln-204"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">ip</span><span class="p">,</span> <span class="n">im</span><span class="p">,</span> <span class="n">jp</span><span class="p">,</span> <span class="n">jm</span><span class="p">,</span> <span class="n">kp</span><span class="p">,</span> <span class="n">km</span>
<a name="ln-205"></a>
<a name="ln-206"></a>   <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ke</span>
<a name="ln-207"></a>      <span class="n">km</span> <span class="o">=</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-208"></a>      <span class="n">kp</span> <span class="o">=</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-209"></a>      <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span>
<a name="ln-210"></a>         <span class="n">jm</span> <span class="o">=</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-211"></a>         <span class="n">jp</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-212"></a>         <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ie</span>
<a name="ln-213"></a>            <span class="n">im</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-214"></a>            <span class="n">ip</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-215"></a>
<a name="ln-216"></a>            <span class="n">putout</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-217"></a>                              <span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-218"></a>                              <span class="p">(</span><span class="n">putin</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">dxf</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">dxf</span><span class="p">(</span><span class="n">ip</span><span class="p">))</span><span class="o">*</span><span class="n">dxhi</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span> <span class="p">&amp;</span> <span class="c">! d(uw)/dx</span>
<a name="ln-219"></a>                              <span class="o">*</span><span class="p">(</span><span class="n">dzf</span><span class="p">(</span><span class="n">km</span><span class="p">)</span><span class="o">*</span><span class="n">u0</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">dzf</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">u0</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">km</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-220"></a>                              <span class="o">-</span> <span class="p">(</span><span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">dxf</span><span class="p">(</span><span class="n">im</span><span class="p">)</span> <span class="o">+</span> <span class="n">putin</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">dxf</span><span class="p">(</span><span class="n">i</span><span class="p">))</span><span class="o">*</span><span class="n">dxhi</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-221"></a>                              <span class="o">*</span><span class="p">(</span><span class="n">dzf</span><span class="p">(</span><span class="n">km</span><span class="p">)</span><span class="o">*</span><span class="n">u0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">dzf</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">u0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">km</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-222"></a>                              <span class="p">)</span><span class="o">*</span><span class="n">dxfiq</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">dzhi</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-223"></a>                              <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-224"></a>                              <span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-225"></a>                              <span class="p">(</span><span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">jp</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span> <span class="p">&amp;</span> <span class="c">! d(vw)/dy</span>
<a name="ln-226"></a>                              <span class="o">*</span><span class="p">(</span><span class="n">dzf</span><span class="p">(</span><span class="n">km</span><span class="p">)</span><span class="o">*</span><span class="n">v0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">jp</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">dzf</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">v0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">jp</span><span class="p">,</span> <span class="n">km</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-227"></a>                              <span class="o">-</span> <span class="p">(</span><span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-228"></a>                              <span class="o">*</span><span class="p">(</span><span class="n">dzf</span><span class="p">(</span><span class="n">km</span><span class="p">)</span><span class="o">*</span><span class="n">v0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">dzf</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">v0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">km</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-229"></a>                              <span class="p">)</span><span class="o">*</span><span class="n">dyiq</span><span class="o">*</span><span class="n">dzhi</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-230"></a>                              <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-231"></a>                              <span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-232"></a>                              <span class="p">(</span><span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">kp</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">w0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">w0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">kp</span><span class="p">))</span> <span class="p">&amp;</span> <span class="c">! d(ww)/dz</span>
<a name="ln-233"></a>                              <span class="o">-</span> <span class="p">(</span><span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">km</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">w0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">w0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">km</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-234"></a>                              <span class="p">)</span><span class="o">*</span><span class="n">dzhiq</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-235"></a>                              <span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-236"></a>                              <span class="o">-</span> <span class="p">((</span><span class="n">pres0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">-</span> <span class="n">pres0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">dzhi</span><span class="p">(</span><span class="n">k</span><span class="p">))</span> <span class="c">! - dp/dz</span>
<a name="ln-237"></a>
<a name="ln-238"></a>         <span class="k">end do</span>
<a name="ln-239"></a><span class="k">      end do</span>
<a name="ln-240"></a><span class="k">   end do</span>
<a name="ln-241"></a><span class="k">end subroutine </span><span class="n">advecw_2nd</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2021 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> uDALES was developed by The uDALES Team</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>