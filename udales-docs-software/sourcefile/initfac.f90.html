<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
    <meta name="description" content="Documentation for uDALES">
   
    <meta name="author" content="The uDALES Team" >
    <link rel="icon" href="../favicon.png">

    <title>initfac.f90 &ndash; uDALES</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">uDALES </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/dalesurban.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/dalesurban.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>initfac.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 2.3% of total for source files.">319 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/initfac.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">initfac.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/initfac.html">initfac</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/initfac.f90.html#src">initfac.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~initfac.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefileinitfacf90EfferentGraph" width="287pt" height="52pt"
 viewBox="0.00 0.00 287.00 52.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~initfac.f90~~EfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 48)">
<title>sourcefile~~initfac.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-48 283,-48 283,4 -4,4"/>
<!-- sourcefile~initfac.f90 -->
<g id="sourcefile~~initfac.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~initfac.f90</title>
<polygon fill="none" stroke="#000000" points="279,-24 221,-24 221,0 279,0 279,-24"/>
<text text-anchor="middle" x="250" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">initfac.f90</text>
</g>
<!-- sourcefile~modglobal.f90 -->
<g id="sourcefile~~initfac.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~modglobal.f90</title>
<g id="a_sourcefile~~initfac.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/modglobal.f90.html" xlink:title="modglobal.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="185,-44 105,-44 105,-20 185,-20 185,-44"/>
<text text-anchor="middle" x="145" y="-29.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modglobal.f90</text>
</a>
</g>
</g>
<!-- sourcefile~initfac.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~initfac.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~initfac.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M220.7516,-17.5711C212.7275,-19.0995 203.7953,-20.8009 194.9593,-22.4839"/>
<polygon fill="#ff0000" stroke="#ff0000" points="194.246,-19.0568 185.0775,-24.3662 195.5558,-25.9332 194.246,-19.0568"/>
</g>
<!-- sourcefile~modmpi.f90 -->
<g id="sourcefile~~initfac.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~modmpi.f90</title>
<g id="a_sourcefile~~initfac.f90~~EfferentGraph_node3"><a xlink:href=".././sourcefile/modmpi.f90.html" xlink:title="modmpi.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="69,-24 0,-24 0,0 69,0 69,-24"/>
<text text-anchor="middle" x="34.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modmpi.f90</text>
</a>
</g>
</g>
<!-- sourcefile~initfac.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~initfac.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~initfac.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M220.8799,-11.4565C209.6654,-11.2722 196.7372,-11.0903 185,-11 149.4455,-10.7265 140.5547,-10.7479 105,-11 96.7329,-11.0586 87.9209,-11.1559 79.4269,-11.2674"/>
<polygon fill="#ff0000" stroke="#ff0000" points="79.232,-7.7697 69.2818,-11.4088 79.3296,-14.769 79.232,-7.7697"/>
</g>
<!-- sourcefile~modglobal.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~initfac.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~modglobal.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M104.7944,-24.723C96.4589,-23.2143 87.6289,-21.6161 79.1455,-20.0806"/>
<polygon fill="#ff0000" stroke="#ff0000" points="79.4896,-16.5861 69.0261,-18.2491 78.2428,-23.4742 79.4896,-16.5861"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="190pt" height="32pt"
 viewBox="0.00 0.00 190.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 186,-28 186,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="67,-24 0,-24 0,0 67,0 67,-24"/>
<text text-anchor="middle" x="33.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="182,-24 85,-24 85,0 182,0 182,-24"/>
<text text-anchor="middle" x="133.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~initfac.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefileinitfacf90AfferentGraph" width="641pt" height="269pt"
 viewBox="0.00 0.00 641.00 269.48" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~initfac.f90~~AfferentGraph" class="graph" transform="scale(.7973 .7973) rotate(0) translate(4 334)">
<title>sourcefile~~initfac.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-334 800,-334 800,4 -4,4"/>
<!-- sourcefile~initfac.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~initfac.f90</title>
<polygon fill="none" stroke="#000000" points="58,-186 0,-186 0,-162 58,-162 58,-186"/>
<text text-anchor="middle" x="29" y="-171.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">initfac.f90</text>
</g>
<!-- sourcefile~modibm.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~modibm.f90</title>
<g id="a_sourcefile~~initfac.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/modibm.f90.html" xlink:title="modibm.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="170,-330 101,-330 101,-306 170,-306 170,-330"/>
<text text-anchor="middle" x="135.5" y="-315.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modibm.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modibm.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~modibm.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M105.848,-305.8909C101.5717,-303.3528 97.456,-300.3954 94,-297 64.3408,-267.861 45.1778,-222.2913 35.8064,-195.5652"/>
<polygon fill="#ff0000" stroke="#ff0000" points="39.095,-194.3637 32.5903,-186.0007 32.46,-196.5947 39.095,-194.3637"/>
</g>
<!-- sourcefile~wf_gr.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~wf_gr.f90</title>
<g id="a_sourcefile~~initfac.f90~~AfferentGraph_node3"><a xlink:href=".././sourcefile/wf_gr.f90.html" xlink:title="wf_gr.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="164,-288 107,-288 107,-264 164,-264 164,-288"/>
<text text-anchor="middle" x="135.5" y="-273.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">wf_gr.f90</text>
</a>
</g>
</g>
<!-- sourcefile~wf_gr.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~wf_gr.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M107.2572,-263.775C102.614,-261.1958 98.0135,-258.2556 94,-255 72.6553,-237.6862 53.6843,-212.2734 41.8277,-194.5446"/>
<polygon fill="#ff0000" stroke="#ff0000" points="44.691,-192.5276 36.3011,-186.0576 38.8251,-196.3474 44.691,-192.5276"/>
</g>
<!-- sourcefile~wf_uno.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~wf_uno.f90</title>
<g id="a_sourcefile~~initfac.f90~~AfferentGraph_node4"><a xlink:href=".././sourcefile/wf_uno.f90.html" xlink:title="wf_uno.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="168,-246 103,-246 103,-222 168,-222 168,-246"/>
<text text-anchor="middle" x="135.5" y="-231.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">wf_uno.f90</text>
</a>
</g>
</g>
<!-- sourcefile~wf_uno.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~wf_uno.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M113.9481,-221.8581C98.3579,-213.0749 77.0683,-201.0807 59.7026,-191.2972"/>
<polygon fill="#ff0000" stroke="#ff0000" points="60.9503,-187.983 50.5198,-186.1238 57.5143,-194.0817 60.9503,-187.983"/>
</g>
<!-- sourcefile~program.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~program.f90</title>
<g id="a_sourcefile~~initfac.f90~~AfferentGraph_node5"><a xlink:href=".././sourcefile/program.f90.html" xlink:title="program.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="796,-86 725,-86 725,-62 796,-62 796,-86"/>
<text text-anchor="middle" x="760.5" y="-71.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">program.f90</text>
</a>
</g>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge9" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M508.5,-174C449.0515,-169.7261 439.8594,-208.6287 380.5,-214"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M380.5,-214C357.4436,-216.0863 350.8717,-208.4093 332,-195 311.9587,-180.7596 315.635,-167.7956 296,-153 279.799,-140.792 274.1041,-139.2141 254.5,-134"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modibm.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge10" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modibm.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M380.5,-214C358.4047,-213.9501 232.5628,-272.0293 170.3346,-301.4044"/>
<polygon fill="#ff0000" stroke="#ff0000" points="168.4616,-298.4186 160.9191,-305.8592 171.4554,-304.7461 168.4616,-298.4186"/>
</g>
<!-- sourcefile~modeb.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_node8" class="node">
<title>sourcefile~modeb.f90</title>
<g id="a_sourcefile~~initfac.f90~~AfferentGraph_node8"><a xlink:href=".././sourcefile/modeb.f90.html" xlink:title="modEB.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="413,-186 348,-186 348,-162 413,-162 413,-186"/>
<text text-anchor="middle" x="380.5" y="-171.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modEB.f90</text>
</a>
</g>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modeb.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge12" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modeb.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M508.5,-174C480.1963,-171.8021 448.2659,-171.7978 423.3767,-172.3451"/>
<polygon fill="#0000ff" stroke="#0000ff" points="423.0784,-168.8516 413.1721,-172.6087 423.2592,-175.8492 423.0784,-168.8516"/>
</g>
<!-- sourcefile~modsave.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_node9" class="node">
<title>sourcefile~modsave.f90</title>
<g id="a_sourcefile~~initfac.f90~~AfferentGraph_node9"><a xlink:href=".././sourcefile/modsave.f90.html" xlink:title="modsave.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="172.5,-86 98.5,-86 98.5,-62 172.5,-62 172.5,-86"/>
<text text-anchor="middle" x="135.5" y="-71.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modsave.f90</text>
</a>
</g>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modsave.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge15" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modsave.f90</title>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M508.5,-174C506.4225,-173.8387 282.368,-113.5512 182.5543,-86.6741"/>
<polygon fill="#aa00ff" stroke="#aa00ff" points="183.2902,-83.2477 172.7241,-84.027 181.47,-90.0069 183.2902,-83.2477"/>
</g>
<!-- sourcefile~modboundary.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_node13" class="node">
<title>sourcefile~modboundary.f90</title>
<g id="a_sourcefile~~initfac.f90~~AfferentGraph_node13"><a xlink:href=".././sourcefile/modboundary.f90.html" xlink:title="modboundary.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="429,-106 332,-106 332,-82 429,-82 429,-106"/>
<text text-anchor="middle" x="380.5" y="-91.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modboundary.f90</text>
</a>
</g>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modboundary.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge22" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modboundary.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M638.5,-174C582.2426,-187.167 566.1044,-178.4732 508.5,-174"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M508.5,-174C465.9147,-170.6931 465.5393,-142.1207 429,-120 424.0964,-117.0314 418.8271,-114.026 413.633,-111.1643"/>
<polygon fill="#ff0000" stroke="#ff0000" points="414.9216,-107.8823 404.46,-106.2072 411.5936,-114.0406 414.9216,-107.8823"/>
</g>
<!-- sourcefile~modstartup.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_node14" class="node">
<title>sourcefile~modstartup.f90</title>
<g id="a_sourcefile~~initfac.f90~~AfferentGraph_node14"><a xlink:href=".././sourcefile/modstartup.f90.html" xlink:title="modstartup.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="681,-106 596,-106 596,-82 681,-82 681,-106"/>
<text text-anchor="middle" x="638.5" y="-91.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modstartup.f90</text>
</a>
</g>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modstartup.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge24" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modstartup.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M724.8846,-79.8386C714.4381,-81.5511 702.7827,-83.4619 691.499,-85.3116"/>
<polygon fill="#00ffff" stroke="#00ffff" points="690.5882,-81.9141 681.2862,-86.9859 691.7207,-88.8219 690.5882,-81.9141"/>
</g>
<!-- sourcefile~modpois.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_node15" class="node">
<title>sourcefile~modpois.f90</title>
<g id="a_sourcefile~~initfac.f90~~AfferentGraph_node15"><a xlink:href=".././sourcefile/modpois.f90.html" xlink:title="modpois.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="544,-126 473,-126 473,-102 544,-102 544,-126"/>
<text text-anchor="middle" x="508.5" y="-111.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modpois.f90</text>
</a>
</g>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modpois.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge26" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modpois.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M751.8775,-86.2546C734.0669,-110.1786 690.4986,-161.8297 638.5,-174"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M638.5,-174C597.1843,-183.6699 553.1655,-153.7658 528.4189,-132.7647"/>
<polygon fill="#ff0000" stroke="#ff0000" points="530.6154,-130.0354 520.7971,-126.054 525.9896,-135.2892 530.6154,-130.0354"/>
</g>
<!-- sourcefile~modsubgrid.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_node16" class="node">
<title>sourcefile~modsubgrid.f90</title>
<g id="a_sourcefile~~initfac.f90~~AfferentGraph_node16"><a xlink:href=".././sourcefile/modsubgrid.f90.html" xlink:title="modsubgrid.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="552,-46 465,-46 465,-22 552,-22 552,-46"/>
<text text-anchor="middle" x="508.5" y="-31.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modsubgrid.f90</text>
</a>
</g>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modsubgrid.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge27" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modsubgrid.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M724.929,-68.3538C682.6238,-61.6387 611.5726,-50.3607 562.4809,-42.5684"/>
<polygon fill="#00ffff" stroke="#00ffff" points="562.7819,-39.0724 552.3568,-40.9614 561.6844,-45.9859 562.7819,-39.0724"/>
</g>
<!-- sourcefile~modstatsdump.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_node17" class="node">
<title>sourcefile~modstatsdump.f90</title>
<g id="a_sourcefile~~initfac.f90~~AfferentGraph_node17"><a xlink:href=".././sourcefile/modstatsdump.f90.html" xlink:title="modstatsdump.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="689,-26 588,-26 588,-2 689,-2 689,-26"/>
<text text-anchor="middle" x="638.5" y="-11.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modstatsdump.f90</text>
</a>
</g>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modstatsdump.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge30" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modstatsdump.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M735.8115,-61.8581C717.5389,-52.8716 692.4316,-40.5237 672.297,-30.6215"/>
<polygon fill="#ff0000" stroke="#ff0000" points="673.67,-27.3964 663.1518,-26.1238 670.5807,-33.6778 673.67,-27.3964"/>
</g>
<!-- sourcefile~wfmneutral.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~wfmneutral.f90</title>
<g id="a_sourcefile~~initfac.f90~~AfferentGraph_node6"><a xlink:href=".././sourcefile/wfmneutral.f90.html" xlink:title="wfmneutral.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="177,-166 94,-166 94,-142 177,-142 177,-166"/>
<text text-anchor="middle" x="135.5" y="-151.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">wfmneutral.f90</text>
</a>
</g>
</g>
<!-- sourcefile~wfmneutral.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~wfmneutral.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M93.714,-161.8471C85.2624,-163.4343 76.4063,-165.0974 68.053,-166.6661"/>
<polygon fill="#ff0000" stroke="#ff0000" points="67.3564,-163.2357 58.1742,-168.5213 68.6484,-170.1154 67.3564,-163.2357"/>
</g>
<!-- sourcefile~advec_2nd.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_node7" class="node">
<title>sourcefile~advec_2nd.f90</title>
<g id="a_sourcefile~~initfac.f90~~AfferentGraph_node7"><a xlink:href=".././sourcefile/advec_2nd.f90.html" xlink:title="advec_2nd.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="296,-186 213,-186 213,-162 296,-162 296,-186"/>
<text text-anchor="middle" x="254.5" y="-171.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">advec_2nd.f90</text>
</a>
</g>
</g>
<!-- sourcefile~advec_2nd.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~advec_2nd.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M212.6711,-174.6385C201.1151,-174.788 188.5719,-174.9253 177,-175 140.1119,-175.238 130.8878,-175.2837 94,-175 85.6556,-174.9358 76.7092,-174.8253 68.2046,-174.7005"/>
<polygon fill="#ff0000" stroke="#ff0000" points="68.1734,-171.1997 58.1201,-174.5435 68.0643,-178.1989 68.1734,-171.1997"/>
</g>
<!-- sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modibm.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge11" class="edge">
<title>sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modibm.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M229.1459,-186.2128C223.241,-189.9826 217.4013,-194.5933 213,-200 183.9694,-235.6622 207.6265,-262.6986 177,-297 176.2471,-297.8433 175.4524,-298.6571 174.6228,-299.4422"/>
<polygon fill="#ff0000" stroke="#ff0000" points="172.2017,-296.8882 166.3968,-305.7512 176.4618,-302.4426 172.2017,-296.8882"/>
</g>
<!-- sourcefile~modeb.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~modeb.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M347.8776,-163.6056C322.4457,-155.5116 286.2381,-144.0081 254.5,-134"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M254.5,-134C186.4676,-112.547 162.5296,-113.1924 94,-133 78.3227,-137.5313 62.7881,-147.092 50.8386,-155.8418"/>
<polygon fill="#ff0000" stroke="#ff0000" points="48.629,-153.1255 42.8204,-161.9861 52.8867,-158.6818 48.629,-153.1255"/>
</g>
<!-- sourcefile~modsave.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge8" class="edge">
<title>sourcefile~modsave.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M113.5623,-86.0999C106.9933,-90.1486 99.9579,-94.9319 94,-100 74.988,-116.1725 56.5243,-137.9608 44.1648,-153.7029"/>
<polygon fill="#ff0000" stroke="#ff0000" points="41.2934,-151.695 37.9616,-161.7524 46.8381,-155.9679 41.2934,-151.695"/>
</g>
<!-- sourcefile~scalsource.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_node10" class="node">
<title>sourcefile~scalsource.f90</title>
<g id="a_sourcefile~~initfac.f90~~AfferentGraph_node10"><a xlink:href=".././sourcefile/scalsource.f90.html" xlink:title="scalsource.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="176.5,-44 94.5,-44 94.5,-20 176.5,-20 176.5,-44"/>
<text text-anchor="middle" x="135.5" y="-29.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">scalsource.f90</text>
</a>
</g>
</g>
<!-- sourcefile~scalsource.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~scalsource.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M105.8682,-44.1298C101.5893,-46.6653 97.4675,-49.6164 94,-53 64.77,-81.5225 45.5581,-126.0374 36.0424,-152.3809"/>
<polygon fill="#ff0000" stroke="#ff0000" points="32.7349,-151.2364 32.7648,-161.8312 39.3484,-153.5302 32.7349,-151.2364"/>
</g>
<!-- sourcefile~moddriver.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_node11" class="node">
<title>sourcefile~moddriver.f90</title>
<g id="a_sourcefile~~initfac.f90~~AfferentGraph_node11"><a xlink:href=".././sourcefile/moddriver.f90.html" xlink:title="moddriver.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="294,-66 215,-66 215,-42 294,-42 294,-66"/>
<text text-anchor="middle" x="254.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">moddriver.f90</text>
</a>
</g>
</g>
<!-- sourcefile~moddriver.f90&#45;&gt;sourcefile~modsave.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge13" class="edge">
<title>sourcefile~moddriver.f90&#45;&gt;sourcefile~modsave.f90</title>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M214.8747,-60.6597C204.5249,-62.3992 193.2685,-64.291 182.573,-66.0886"/>
<polygon fill="#aa00ff" stroke="#aa00ff" points="181.8197,-62.666 172.5382,-67.7751 182.98,-69.5692 181.8197,-62.666"/>
</g>
<!-- sourcefile~modinlet.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_node12" class="node">
<title>sourcefile~modinlet.f90</title>
<g id="a_sourcefile~~initfac.f90~~AfferentGraph_node12"><a xlink:href=".././sourcefile/modinlet.f90.html" xlink:title="modinlet.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="290,-24 219,-24 219,0 290,0 290,-24"/>
<text text-anchor="middle" x="254.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modinlet.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modinlet.f90&#45;&gt;sourcefile~modsave.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge14" class="edge">
<title>sourcefile~modinlet.f90&#45;&gt;sourcefile~modsave.f90</title>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M230.2798,-24.0582C224.5898,-26.9456 218.5638,-30.0482 213,-33 196.8312,-41.5781 193.1688,-44.4219 177,-53 174.305,-54.4298 171.5016,-55.8949 168.6805,-57.3539"/>
<polygon fill="#aa00ff" stroke="#aa00ff" points="167.0261,-54.2688 159.7202,-61.9418 170.2164,-60.4995 167.0261,-54.2688"/>
</g>
<!-- sourcefile~modboundary.f90&#45;&gt;sourcefile~moddriver.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge17" class="edge">
<title>sourcefile~modboundary.f90&#45;&gt;sourcefile~moddriver.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M342.6958,-81.9987C329.9798,-77.9618 315.6241,-73.4045 302.245,-69.1571"/>
<polygon fill="#ff0000" stroke="#ff0000" points="303.3033,-65.821 292.713,-66.1311 301.1852,-72.4929 303.3033,-65.821"/>
</g>
<!-- sourcefile~modboundary.f90&#45;&gt;sourcefile~modinlet.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge19" class="edge">
<title>sourcefile~modboundary.f90&#45;&gt;sourcefile~modinlet.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M354.7722,-81.9185C347.1726,-77.9033 339.0162,-73.1339 332,-68 313.991,-54.8223 314.1635,-45.9639 296,-33 294.1844,-31.7041 292.2773,-30.4434 290.3198,-29.2253"/>
<polygon fill="#00ffff" stroke="#00ffff" points="291.9548,-26.1281 281.5404,-24.1811 288.4675,-32.1977 291.9548,-26.1281"/>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~moddriver.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge16" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~moddriver.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M380.5,-54C355.5747,-49.9757 327.5125,-49.5802 304.2086,-50.3594"/>
<polygon fill="#ff0000" stroke="#ff0000" points="304.0475,-46.8629 294.2011,-50.7745 304.3376,-53.8569 304.0475,-46.8629"/>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modinlet.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge18" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modinlet.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M595.9474,-85.7756C570.6517,-81.307 537.8714,-76.2461 508.5,-74"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M508.5,-74C451.0885,-69.6096 437.343,-63.1775 380.5,-54"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M380.5,-54C349.7533,-49.0358 316.3756,-37.618 291.7026,-27.9386"/>
<polygon fill="#00ffff" stroke="#00ffff" points="292.948,-24.6672 282.3637,-24.1951 290.3434,-31.1646 292.948,-24.6672"/>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modboundary.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge21" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modboundary.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M508.5,-74C484.0807,-72.1326 457.2774,-75.472 434.536,-79.9267"/>
<polygon fill="#ff0000" stroke="#ff0000" points="433.8068,-76.5034 424.7278,-81.9644 435.2307,-83.3571 433.8068,-76.5034"/>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modpois.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge25" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modpois.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M595.9331,-100.5487C582.5972,-102.6004 567.8254,-104.873 554.2777,-106.9573"/>
<polygon fill="#ff0000" stroke="#ff0000" points="553.5519,-103.5277 544.2004,-108.5076 554.6163,-110.4463 553.5519,-103.5277"/>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modsubgrid.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge28" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modsubgrid.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M612.1926,-81.8581C592.5456,-72.7903 565.4833,-60.3 543.932,-50.3532"/>
<polygon fill="#00ffff" stroke="#00ffff" points="545.3146,-47.1366 534.7683,-46.1238 542.3812,-53.4923 545.3146,-47.1366"/>
</g>
<!-- sourcefile~modpois.f90&#45;&gt;sourcefile~modboundary.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge20" class="edge">
<title>sourcefile~modpois.f90&#45;&gt;sourcefile~modboundary.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M472.8449,-108.4289C462.432,-106.8019 450.7647,-104.9789 439.3197,-103.1906"/>
<polygon fill="#ff0000" stroke="#ff0000" points="439.7769,-99.7196 429.3564,-101.6338 438.6962,-106.6357 439.7769,-99.7196"/>
</g>
<!-- sourcefile~modsubgrid.f90&#45;&gt;sourcefile~modboundary.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge23" class="edge">
<title>sourcefile~modsubgrid.f90&#45;&gt;sourcefile~modboundary.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M482.5973,-46.1419C463.3393,-55.1691 436.8454,-67.5881 415.6727,-77.5128"/>
<polygon fill="#ff0000" stroke="#ff0000" points="413.9332,-74.4627 406.3642,-81.8762 416.9043,-80.8009 413.9332,-74.4627"/>
</g>
<!-- sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modsubgrid.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge29" class="edge">
<title>sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modsubgrid.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M587.8664,-21.7898C579.3603,-23.0984 570.5086,-24.4602 561.9344,-25.7793"/>
<polygon fill="#00ffff" stroke="#00ffff" points="561.3853,-22.3225 552.0339,-27.3025 562.4498,-29.2411 561.3853,-22.3225"/>
</g>
</g>
</svg>
</div><script>var pansourcefileinitfacf90AfferentGraph = svgPanZoom('#sourcefileinitfacf90AfferentGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="190pt" height="32pt"
 viewBox="0.00 0.00 190.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 186,-28 186,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="67,-24 0,-24 0,0 67,0 67,-24"/>
<text text-anchor="middle" x="33.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="182,-24 85,-24 85,0 182,0 182,-24"/>
<text text-anchor="middle" x="133.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/initfac.html">initfac</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/initfac.f90.html#src">initfac.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="c">!!&gt; \file b2f.f90</span>
<a name="ln-2"></a><span class="c">!!  \author Ivo Suter</span>
<a name="ln-3"></a><span class="c">!</span>
<a name="ln-4"></a><span class="c">!   reads the necessary input files to deal with facets</span>
<a name="ln-5"></a><span class="c">!</span>
<a name="ln-6"></a><span class="c">!   WARNING: if walls with more than 3 layers (4 points) are to be considered, this file needs to be changed</span>
<a name="ln-7"></a><span class="c">!            e.g. walltypes needs to read 7+4*nlayers columns, offsets in reading facet properties also change accordingly</span>
<a name="ln-8"></a>   <span class="k">module </span><span class="n">initfac</span>
<a name="ln-9"></a>      <span class="k">use </span><span class="n">modglobal</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span><span class="n">ifinput</span><span class="p">,</span> <span class="n">nblocks</span><span class="p">,</span> <span class="n">nfcts</span><span class="p">,</span> <span class="n">cexpnr</span><span class="p">,</span> <span class="n">libm</span><span class="p">,</span> <span class="n">bldT</span><span class="p">,</span> <span class="n">rsmin</span><span class="p">,</span> <span class="n">wsoil</span><span class="p">,</span> <span class="n">wfc</span><span class="p">,&amp;</span>
<a name="ln-10"></a>                          <span class="n">nwalllayers</span><span class="p">,</span> <span class="k">block</span><span class="p">,</span><span class="n">lEB</span>
<a name="ln-11"></a>      <span class="k">use </span><span class="n">modmpi</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span><span class="n">myid</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">,</span> <span class="n">MPI_INTEGER</span><span class="p">,</span> <span class="n">MPI_DOUBLE_PRECISION</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="n">nprocs</span><span class="p">,</span> <span class="n">cmyid</span><span class="p">,</span> <span class="n">MPI_REAL8</span><span class="p">,</span> <span class="n">MPI_REAL4</span><span class="p">,</span> <span class="n">MPI_SUM</span><span class="p">,</span> <span class="n">mpi_logical</span>
<a name="ln-12"></a>      <span class="k">use </span><span class="n">netcdf</span>
<a name="ln-13"></a>      <span class="k">implicit none</span>
<a name="ln-14"></a><span class="k">      public</span> <span class="kd">::</span> <span class="n">readfacetfiles</span><span class="p">,</span><span class="n">qsat</span><span class="p">,</span><span class="n">dqsatdT</span>
<a name="ln-15"></a>      <span class="k">save</span>
<a name="ln-16"></a>
<a name="ln-17"></a>      <span class="c">!integer, allocatable :: block(:, :) !block coordinates and facet Nr corresponding to block faces</span>
<a name="ln-18"></a>      <span class="c">!facet properties</span>
<a name="ln-19"></a>      <span class="kt">logical</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">faclGR</span><span class="p">(:)</span> <span class="c">!logic array, is it a green (vegetated) facet?</span>
<a name="ln-20"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">facz0</span><span class="p">(:)</span> <span class="c">!roughness for momentum on facets</span>
<a name="ln-21"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">facz0h</span><span class="p">(:)</span> <span class="c">!roughness for heat and moisture on facets</span>
<a name="ln-22"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">facalb</span><span class="p">(:)</span> <span class="c">!facet shortwave albedo</span>
<a name="ln-23"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">facem</span><span class="p">(:)</span> <span class="c">!facet longwave emissivity of all 5 faces of the blocks</span>
<a name="ln-24"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">facdi</span><span class="p">(:,</span> <span class="p">:)</span> <span class="c">!inverse facet thickness</span>
<a name="ln-25"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">facd</span><span class="p">(:,:)</span> <span class="c">!facet thickness</span>
<a name="ln-26"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">faccp</span><span class="p">(:,</span> <span class="p">:)</span> <span class="c">!facet specific heat capacity</span>
<a name="ln-27"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">faclami</span><span class="p">(:,</span> <span class="p">:)</span> <span class="c">!inverse facet heat conductivity</span>
<a name="ln-28"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">fackappa</span><span class="p">(:,</span> <span class="p">:)</span> <span class="c">!facet heat diffusivity (lambda/(rho cp))</span>
<a name="ln-29"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">faca</span><span class="p">(:)</span> <span class="c">!facet area</span>
<a name="ln-30"></a>      <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">facain</span><span class="p">(:)</span> <span class="c">!facet area as sum of indeces</span>
<a name="ln-31"></a>      <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">facets</span><span class="p">(:,</span> <span class="p">:)</span> <span class="c">!facet orientation, walltype, block and building Nr</span>
<a name="ln-32"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">walltypes</span><span class="p">(:,</span> <span class="p">:)</span> <span class="c">!the defined wall and rooftypes with properties</span>
<a name="ln-33"></a>      <span class="c">!radiation</span>
<a name="ln-34"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">vf</span><span class="p">(:,</span> <span class="p">:)</span> <span class="c">!viewfactors between facets</span>
<a name="ln-35"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">svf</span><span class="p">(:)</span> <span class="c">!sky-viewfactor of facets</span>
<a name="ln-36"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">netsw</span><span class="p">(:)</span> <span class="c">!net shortwave radiation on facets</span>
<a name="ln-37"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">facLWin</span><span class="p">(:)</span> <span class="c">!incoming longwave on facets [W/m2]</span>
<a name="ln-38"></a>      <span class="c">!temperature</span>
<a name="ln-39"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">Tfacinit</span><span class="p">(:)</span> <span class="c">!initial facet temperatures</span>
<a name="ln-40"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">facT</span><span class="p">(:,</span> <span class="p">:)</span> <span class="c">!wall temperatures on surfaces and between layers (1=outdoors,end=indoors)</span>
<a name="ln-41"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">facTdash</span><span class="p">(:,</span> <span class="p">:)</span><span class="c">!temperature gradient dT/dz</span>
<a name="ln-42"></a>      <span class="c">!fluxes</span>
<a name="ln-43"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">facef</span><span class="p">(:)</span> <span class="c">!evaporative flux on facets [W/m2] (single processor)</span>
<a name="ln-44"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">facefi</span><span class="p">(:)</span> <span class="c">!time integrated latent heat flux [J/m2] (used in modEB)</span>
<a name="ln-45"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">facefsum</span><span class="p">(:)</span> <span class="c">!evaporative flux on facets [W/m2] (sum over all processors)</span>
<a name="ln-46"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">fachf</span><span class="p">(:)</span> <span class="c">!heat flux on facets [Km/s] (single processor)</span>
<a name="ln-47"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">fachfi</span><span class="p">(:)</span> <span class="c">!time integrated heat flux [Km]</span>
<a name="ln-48"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">fachfsum</span><span class="p">(:)</span> <span class="c">!heat flux on facets [Km/s] (sum over all processors)</span>
<a name="ln-49"></a>      <span class="c">!GR</span>
<a name="ln-50"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">facf</span><span class="p">(:,</span> <span class="p">:)</span> <span class="c">!dependence of stomatal resistance/soil resistance</span>
<a name="ln-51"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">fachurel</span><span class="p">(:)</span> <span class="c">!relative humidity at ground surface</span>
<a name="ln-52"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">facwsoil</span><span class="p">(:)</span> <span class="c">!soil moisture of facets</span>
<a name="ln-53"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">faccth</span><span class="p">(:)</span> <span class="c">!sum of all transfer coefficients of the facet, used in Penman Moneith, unused</span>
<a name="ln-54"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">facqsat</span><span class="p">(:)</span> <span class="c">!saturation absoulute humidity at facet temperature</span>
<a name="ln-55"></a>
<a name="ln-56"></a>      <span class="c">!misc</span>
<a name="ln-57"></a>      <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">typeloc</span><span class="p">(:)</span> <span class="c">!array to match the walltype to sequential integers for indexing</span>
<a name="ln-58"></a>      <span class="kt">integer</span>              <span class="kd">::</span> <span class="n">nwalltypes</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">!number of different walltypes, will be determined automatically</span>
<a name="ln-59"></a>      <span class="kt">character</span><span class="p">(</span><span class="mi">80</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">chmess</span> <span class="c">!dummy character string</span>
<a name="ln-60"></a>      <span class="kt">integer</span>              <span class="kd">::</span> <span class="n">nwallprops</span>
<a name="ln-61"></a>
<a name="ln-62"></a>   <span class="k">contains</span>
<a name="ln-63"></a>
<a name="ln-64"></a><span class="k">      subroutine </span><span class="n">readfacetfiles</span>
<a name="ln-65"></a>      <span class="k">use </span><span class="n">modglobal</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="k">block</span><span class="p">,</span> <span class="n">cexpnr</span><span class="p">,</span> <span class="n">iwalltemp</span>
<a name="ln-66"></a>      <span class="k">implicit none</span>
<a name="ln-67"></a>
<a name="ln-68"></a>      <span class="c">!use modglobal, only:block</span>
<a name="ln-69"></a>      <span class="c">!read initial&amp;unchangeable facet values from files</span>
<a name="ln-70"></a>      <span class="c">!read blocks and facet Nr corresponding to block faces (Order: Top, West, East, North, South)</span>
<a name="ln-71"></a>      <span class="c">!define facets with properties and initial temperature</span>
<a name="ln-72"></a>      <span class="c">!read facets.inp.xxx facetarea.inp.xxx vf.inp.xxx walltypes.inp.xxx</span>
<a name="ln-73"></a>      <span class="c">!read netsw.inp.xxx (if sun is not constant, K needs to be calculated at every EB-timestep)</span>
<a name="ln-74"></a>      <span class="c">!read tfacinit.inp.xxx</span>
<a name="ln-75"></a>      <span class="c">!use modglobal, only : nblocks, nfcts, cexpnr, ifinput</span>
<a name="ln-76"></a>      <span class="kt">character</span> <span class="p">(</span><span class="nb">len</span> <span class="o">=</span> <span class="mi">13</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FILE_VF</span> <span class="o">=</span> <span class="s1">&#39;vf.nc.inp.xxx&#39;</span>
<a name="ln-77"></a>      <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ncid</span><span class="p">,</span> <span class="n">varid</span>
<a name="ln-78"></a>      <span class="kt">integer</span> <span class="kd">::</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">io</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-79"></a>      <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iret</span>
<a name="ln-80"></a>
<a name="ln-81"></a>      <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.(</span><span class="n">nfcts</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">))</span> <span class="k">return</span>
<a name="ln-82"></a>
<a name="ln-83"></a><span class="k">      </span><span class="n">nwallprops</span> <span class="o">=</span> <span class="mi">6</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">nwalllayers</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-84"></a>      <span class="c">!allocate (block(nblocks, 11))</span>
<a name="ln-85"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">faclGR</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">))</span>
<a name="ln-86"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">facz0</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">))</span> <span class="c">!0 is the default value (e.g. for internal walls)</span>
<a name="ln-87"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">facz0h</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">))</span>
<a name="ln-88"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">facalb</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">))</span>
<a name="ln-89"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">facem</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">))</span>
<a name="ln-90"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">facdi</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">,</span> <span class="n">nwalllayers</span><span class="p">))</span>
<a name="ln-91"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">facd</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">,</span> <span class="n">nwalllayers</span><span class="p">))</span>
<a name="ln-92"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">faccp</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">,</span> <span class="n">nwalllayers</span><span class="p">))</span>
<a name="ln-93"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">faclami</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">,</span> <span class="n">nwalllayers</span><span class="p">))</span>
<a name="ln-94"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">fackappa</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">,</span> <span class="n">nwalllayers</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-95"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">faca</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">))</span>
<a name="ln-96"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">facain</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">))</span>
<a name="ln-97"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">facets</span><span class="p">(</span><span class="n">nfcts</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<a name="ln-98"></a>
<a name="ln-99"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">lEB</span> <span class="p">.</span><span class="n">eqv</span><span class="p">.</span> <span class="p">.</span><span class="n">true</span><span class="p">.)</span> <span class="k">then</span>
<a name="ln-100"></a><span class="k">        allocate</span> <span class="p">(</span><span class="n">vf</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nfcts</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">nfcts</span><span class="p">))</span>
<a name="ln-101"></a>        <span class="k">allocate</span> <span class="p">(</span><span class="n">svf</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nfcts</span><span class="p">))</span>
<a name="ln-102"></a>        <span class="k">allocate</span> <span class="p">(</span><span class="n">netsw</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nfcts</span><span class="p">))</span>
<a name="ln-103"></a>        <span class="k">allocate</span> <span class="p">(</span><span class="n">facLWin</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nfcts</span><span class="p">))</span>
<a name="ln-104"></a>      <span class="k">end if</span>
<a name="ln-105"></a>
<a name="ln-106"></a><span class="k">      allocate</span> <span class="p">(</span><span class="n">Tfacinit</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nfcts</span><span class="p">))</span>
<a name="ln-107"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">facT</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">,</span> <span class="n">nwalllayers</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-108"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">facTdash</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nfcts</span><span class="p">,</span><span class="n">nwalllayers</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-109"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">facef</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nfcts</span><span class="p">))</span>
<a name="ln-110"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">facefi</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nfcts</span><span class="p">))</span>
<a name="ln-111"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">facefsum</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nfcts</span><span class="p">))</span>
<a name="ln-112"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">fachf</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">))</span>
<a name="ln-113"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">fachfi</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">))</span>
<a name="ln-114"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">fachfsum</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nfcts</span><span class="p">))</span>
<a name="ln-115"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">facf</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<a name="ln-116"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">fachurel</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">))</span>
<a name="ln-117"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">facwsoil</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">))</span>
<a name="ln-118"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">faccth</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">))</span>
<a name="ln-119"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">facqsat</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">))</span>
<a name="ln-120"></a>
<a name="ln-121"></a>      <span class="c">!block = 0;</span>
<a name="ln-122"></a>      <span class="n">faclGR</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.;</span> <span class="n">facz0</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span> <span class="n">facz0h</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span> <span class="n">facalb</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span> <span class="n">facem</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span> <span class="n">facd</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span> <span class="n">facdi</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span> <span class="n">faccp</span> <span class="o">=</span> <span class="mf">0.</span>
<a name="ln-123"></a>      <span class="n">faclami</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span> <span class="n">fackappa</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span> <span class="n">faca</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span> <span class="n">facain</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">facets</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-124"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">lEB</span> <span class="p">.</span><span class="n">eqv</span><span class="p">.</span> <span class="p">.</span><span class="n">true</span><span class="p">.)</span> <span class="k">then</span>
<a name="ln-125"></a><span class="k">        </span><span class="n">vf</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span> <span class="n">svf</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span> <span class="n">netsw</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span> <span class="n">facLWin</span> <span class="o">=</span> <span class="mf">0.</span>
<a name="ln-126"></a>      <span class="k">end if</span>
<a name="ln-127"></a><span class="k">      </span><span class="n">Tfacinit</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span> <span class="n">facT</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span> <span class="n">facTdash</span> <span class="o">=</span> <span class="mf">0.</span>
<a name="ln-128"></a>      <span class="n">facef</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span> <span class="n">facefi</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span> <span class="n">facefsum</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span> <span class="n">fachf</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span> <span class="n">fachfi</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span> <span class="n">fachfsum</span> <span class="o">=</span> <span class="mf">0.</span>
<a name="ln-129"></a>      <span class="n">facf</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span> <span class="n">fachurel</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span> <span class="n">facwsoil</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span> <span class="n">faccth</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span> <span class="n">facqsat</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span>
<a name="ln-130"></a>
<a name="ln-131"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">myid</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">libm</span><span class="p">)</span> <span class="k">then</span> <span class="c">! read blocks corner coordinates and facet-Nr correspoinding to the block sides</span>
<a name="ln-132"></a>      <span class="c">!   open (ifinput, file=&#39;blocks.inp.&#39;//cexpnr)</span>
<a name="ln-133"></a>      <span class="c">!   read (ifinput, &#39;(a80)&#39;) chmess</span>
<a name="ln-134"></a>      <span class="c">!   read (ifinput, &#39;(a80)&#39;) chmess</span>
<a name="ln-135"></a>      <span class="c">!   do n = 1, nblocks</span>
<a name="ln-136"></a>      <span class="c">!     blockfile is :ilow iheigh jlow jheigh klow kheigh facTop facWest facEast facNorth facSouth</span>
<a name="ln-137"></a>      <span class="c">!     read (ifinput, *) &amp;</span>
<a name="ln-138"></a>      <span class="c">!         block(n, 1), &amp;</span>
<a name="ln-139"></a>      <span class="c">!         block(n, 2), &amp;</span>
<a name="ln-140"></a>      <span class="c">!         block(n, 3), &amp;</span>
<a name="ln-141"></a>      <span class="c">!         block(n, 4), &amp;</span>
<a name="ln-142"></a>      <span class="c">!         block(n, 5), &amp;</span>
<a name="ln-143"></a>      <span class="c">!         block(n, 6), &amp;</span>
<a name="ln-144"></a>      <span class="c">!         block(n, 7), &amp;</span>
<a name="ln-145"></a>      <span class="c">!         block(n, 8), &amp;</span>
<a name="ln-146"></a>      <span class="c">!         block(n, 9), &amp;</span>
<a name="ln-147"></a>      <span class="c">!         block(n, 10), &amp;</span>
<a name="ln-148"></a>      <span class="c">!         block(n, 11)</span>
<a name="ln-149"></a>      <span class="c">!   end do</span>
<a name="ln-150"></a>      <span class="c">!   close (ifinput)</span>
<a name="ln-151"></a>
<a name="ln-152"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">lEB</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-153"></a>        <span class="c">! read facet areas</span>
<a name="ln-154"></a>          <span class="k">open</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="s1">&#39;facetarea.inp.&#39;</span><span class="o">//</span><span class="n">cexpnr</span><span class="p">)</span>
<a name="ln-155"></a>          <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="s1">&#39;(a80)&#39;</span><span class="p">)</span> <span class="n">chmess</span>
<a name="ln-156"></a>          <span class="k">do </span><span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nfcts</span>
<a name="ln-157"></a>            <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-158"></a>              <span class="n">faca</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a name="ln-159"></a>          <span class="k">end do</span>
<a name="ln-160"></a><span class="k">          close</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">)</span>
<a name="ln-161"></a>          <span class="k">write</span> <span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s2">&quot;faca&quot;</span><span class="p">,</span> <span class="n">faca</span>
<a name="ln-162"></a>        <span class="k">end if</span> <span class="c">!lEB</span>
<a name="ln-163"></a>
<a name="ln-164"></a>        <span class="c">! read wall &amp; (green) roof types</span>
<a name="ln-165"></a>        <span class="c">! read once to determine number of types, allocate, read again</span>
<a name="ln-166"></a>        <span class="n">nwalltypes</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span> <span class="c">!3 lines as headers</span>
<a name="ln-167"></a>        <span class="k">open</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="s1">&#39;walltypes.inp.&#39;</span><span class="o">//</span><span class="n">cexpnr</span><span class="p">)</span>
<a name="ln-168"></a>        <span class="k">do</span>
<a name="ln-169"></a><span class="k">          read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">io</span><span class="p">)</span>
<a name="ln-170"></a>          <span class="k">if</span> <span class="p">(</span><span class="n">io</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">exit</span>
<a name="ln-171"></a><span class="k">          </span><span class="n">nwalltypes</span> <span class="o">=</span> <span class="n">nwalltypes</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-172"></a>        <span class="k">end do</span>
<a name="ln-173"></a><span class="k">        close</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">)</span>
<a name="ln-174"></a>      <span class="k">end if</span> <span class="c">!(myid == 0 .and. libm)</span>
<a name="ln-175"></a>
<a name="ln-176"></a>      <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">nwalltypes</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MPI_Integer</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-177"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">walltypes</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nwalltypes</span><span class="p">,</span> <span class="n">nwallprops</span><span class="p">))</span>
<a name="ln-178"></a>
<a name="ln-179"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">myid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-180"></a><span class="k">        </span><span class="n">walltypes</span> <span class="o">=</span> <span class="mf">0.</span>
<a name="ln-181"></a>        <span class="k">open</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="s1">&#39;walltypes.inp.&#39;</span><span class="o">//</span><span class="n">cexpnr</span><span class="p">)</span>
<a name="ln-182"></a>        <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="s1">&#39;(a80)&#39;</span><span class="p">)</span> <span class="n">chmess</span>
<a name="ln-183"></a>        <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="s1">&#39;(a80)&#39;</span><span class="p">)</span> <span class="n">chmess</span>
<a name="ln-184"></a>        <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="s1">&#39;(a80)&#39;</span><span class="p">)</span> <span class="n">chmess</span>
<a name="ln-185"></a>
<a name="ln-186"></a>        <span class="k">do </span><span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nwalltypes</span>
<a name="ln-187"></a>          <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="p">(</span><span class="n">walltypes</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">),</span> <span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nwallprops</span><span class="p">)</span>
<a name="ln-188"></a>        <span class="k">end do</span>
<a name="ln-189"></a><span class="k">        close</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">)</span>
<a name="ln-190"></a>      <span class="k">end if</span> <span class="c">!myid==0</span>
<a name="ln-191"></a>
<a name="ln-192"></a>        <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">nwalltypes</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MPI_Integer</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-193"></a>        <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">walltypes</span><span class="p">,</span> <span class="n">nwallprops</span><span class="o">*</span><span class="n">nwalltypes</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-194"></a>
<a name="ln-195"></a>        <span class="c">!create an array mapping walltypes to sequential integers for indexing</span>
<a name="ln-196"></a>        <span class="c">!e.g. lets assume walltype -3,-1,1,2,3 and 5 are defined.</span>
<a name="ln-197"></a>        <span class="c">!index: [-3,-2,-1,0,1,2,3,4,5]  -&gt; [-3,-2,-1,0,1,2,3,4,5]</span>
<a name="ln-198"></a>        <span class="c">!value: [ 0, 0, 0,0,0,0,0,0,0]  -&gt; [ 1, 0, 2,0,3,4,5,0,6]</span>
<a name="ln-199"></a>        <span class="k">allocate</span> <span class="p">(</span><span class="n">typeloc</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">minval</span><span class="p">(</span><span class="n">walltypes</span><span class="p">(:,</span> <span class="mi">1</span><span class="p">))):</span><span class="nb">int</span><span class="p">(</span><span class="nb">maxval</span><span class="p">(</span><span class="n">walltypes</span><span class="p">(:,</span> <span class="mi">1</span><span class="p">)))))</span>
<a name="ln-200"></a>
<a name="ln-201"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">myid</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>  <span class="c">!all the read processes just need to be done on one processor</span>
<a name="ln-202"></a>          <span class="n">typeloc</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-203"></a>          <span class="k">do </span><span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nwalltypes</span>
<a name="ln-204"></a>            <span class="n">typeloc</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">walltypes</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span> <span class="o">=</span> <span class="n">n</span>
<a name="ln-205"></a>          <span class="k">end do</span>
<a name="ln-206"></a>
<a name="ln-207"></a>          <span class="c">! read the facets</span>
<a name="ln-208"></a>          <span class="k">open</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="s1">&#39;facets.inp.&#39;</span><span class="o">//</span><span class="n">cexpnr</span><span class="p">)</span>
<a name="ln-209"></a>          <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="s1">&#39;(a80)&#39;</span><span class="p">)</span> <span class="n">chmess</span>
<a name="ln-210"></a>          <span class="c">!orientation, walltype, block in block.inp, original block/building</span>
<a name="ln-211"></a>          <span class="k">do </span><span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nfcts</span>
<a name="ln-212"></a>            <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-213"></a>              <span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-214"></a>              <span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-215"></a>              <span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-216"></a>              <span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<a name="ln-217"></a>          <span class="k">end do</span>
<a name="ln-218"></a><span class="k">          close</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">)</span>
<a name="ln-219"></a>
<a name="ln-220"></a>          <span class="c">! calculate the number of indeces per facet in both dimensions (~area)</span>
<a name="ln-221"></a>          <span class="k">do </span><span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nfcts</span>
<a name="ln-222"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-223"></a><span class="k">              </span><span class="n">facain</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="k">block</span><span class="p">(</span><span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="k">block</span><span class="p">(</span><span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="k">block</span><span class="p">(</span><span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-</span> <span class="k">block</span><span class="p">(</span><span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-224"></a>            <span class="k">else if</span> <span class="p">(</span><span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-225"></a><span class="k">              </span><span class="n">facain</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="k">block</span><span class="p">(</span><span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="k">block</span><span class="p">(</span><span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="k">block</span><span class="p">(</span><span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-</span> <span class="k">block</span><span class="p">(</span><span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-226"></a>            <span class="k">else if</span> <span class="p">(</span><span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">3</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-227"></a><span class="k">              </span><span class="n">facain</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="k">block</span><span class="p">(</span><span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="k">block</span><span class="p">(</span><span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="k">block</span><span class="p">(</span><span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-</span> <span class="k">block</span><span class="p">(</span><span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-228"></a>            <span class="k">else if</span> <span class="p">(</span><span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">4</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-229"></a><span class="k">              </span><span class="n">facain</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="k">block</span><span class="p">(</span><span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="k">block</span><span class="p">(</span><span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="k">block</span><span class="p">(</span><span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="k">block</span><span class="p">(</span><span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-230"></a>            <span class="k">else if</span> <span class="p">(</span><span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">5</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-231"></a><span class="k">              </span><span class="n">facain</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="k">block</span><span class="p">(</span><span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="k">block</span><span class="p">(</span><span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="k">block</span><span class="p">(</span><span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="k">block</span><span class="p">(</span><span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-232"></a>            <span class="k">end if</span>
<a name="ln-233"></a><span class="k">          end do</span>
<a name="ln-234"></a>
<a name="ln-235"></a>          <span class="c">! assign the facet properties to their own arrays</span>
<a name="ln-236"></a>          <span class="k">do </span><span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nfcts</span>
<a name="ln-237"></a>            <span class="n">i</span> <span class="o">=</span> <span class="n">typeloc</span><span class="p">(</span><span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<a name="ln-238"></a>            <span class="n">faclGR</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">walltypes</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1.00</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1.0D-5</span><span class="p">)</span> <span class="c">!logic for green surface, conversion from real to logical</span>
<a name="ln-239"></a>            <span class="n">facz0</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="n">walltypes</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="c">!surface momentum roughness</span>
<a name="ln-240"></a>            <span class="n">facz0h</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="n">walltypes</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="c">!surface heat &amp; moisture roughness</span>
<a name="ln-241"></a>            <span class="n">facalb</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="n">walltypes</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="c">!surface shortwave albedo</span>
<a name="ln-242"></a>            <span class="n">facem</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="n">walltypes</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>  <span class="c">!surface longwave emissivity</span>
<a name="ln-243"></a>
<a name="ln-244"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="o">-</span><span class="mi">100</span><span class="p">)</span> <span class="k">then</span> <span class="c">!it&#39;s a bounding wall</span>
<a name="ln-245"></a>              <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nwalllayers</span> <span class="c">!bounding walls don&#39;t need properties</span>
<a name="ln-246"></a>                <span class="n">facdi</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.</span>   <span class="c">!bounding walls have no energy balance</span>
<a name="ln-247"></a>                <span class="n">facd</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">=</span><span class="mf">0.</span>       <span class="c">!bounding walls have no thickness</span>
<a name="ln-248"></a>                <span class="n">faclami</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.</span> <span class="c">!bounding walls have no energy balance</span>
<a name="ln-249"></a>                <span class="n">faccp</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.</span>   <span class="c">!bounding walls have no heat capacity</span>
<a name="ln-250"></a>              <span class="k">end do</span>
<a name="ln-251"></a><span class="k">            else</span>
<a name="ln-252"></a><span class="k">              do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nwalllayers</span> <span class="c">!for all layers</span>
<a name="ln-253"></a>                <span class="n">facdi</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">walltypes</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">6</span><span class="p">)</span> <span class="c">!inverse of facet thickness of layer j</span>
<a name="ln-254"></a>                <span class="n">facd</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">walltypes</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">6</span><span class="p">)</span> <span class="c">!facet thickness of layer j</span>
<a name="ln-255"></a>                <span class="n">faclami</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">walltypes</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="o">+</span><span class="mi">12</span><span class="p">)</span> <span class="c">!inverse of heat conductivity of layer j</span>
<a name="ln-256"></a>                <span class="n">faccp</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">walltypes</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="o">+</span><span class="mi">9</span><span class="p">)</span> <span class="c">!specific heat capacity of layer j</span>
<a name="ln-257"></a>              <span class="k">end do</span>
<a name="ln-258"></a><span class="k">            end if</span>
<a name="ln-259"></a>
<a name="ln-260"></a><span class="k">            do </span><span class="n">j</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">nwalllayers</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-261"></a>              <span class="n">fackappa</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">walltypes</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="o">+</span><span class="mi">15</span><span class="p">)</span> <span class="c">!heat duffusivity of layer 1</span>
<a name="ln-262"></a>            <span class="k">end do</span>
<a name="ln-263"></a><span class="k">          end do</span>
<a name="ln-264"></a>
<a name="ln-265"></a>          <span class="c">!give some dummy values for block internal facets (i.e. facets with walltype 0)</span>
<a name="ln-266"></a>          <span class="n">facz0</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.00999</span><span class="p">;</span> <span class="n">facz0h</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.00999</span><span class="p">;</span> <span class="n">facalb</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.999</span><span class="p">;</span> <span class="n">facem</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.999</span><span class="p">;</span> <span class="n">facd</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mf">0.999</span><span class="p">;</span> <span class="n">facd</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="mf">0.999</span><span class="p">;</span> <span class="n">facdi</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.999</span><span class="p">;</span> <span class="n">facdi</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.999</span><span class="p">;</span> <span class="n">facdi</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.999</span><span class="p">;</span> <span class="n">faccp</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">99</span><span class="mf">9.</span><span class="p">;</span> <span class="n">faccp</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mi">99</span><span class="mf">9.</span>
<a name="ln-267"></a>          <span class="n">faccp</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mi">99</span><span class="mf">9.</span><span class="p">;</span> <span class="n">faclami</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.999</span><span class="p">;</span> <span class="n">faclami</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.999</span><span class="p">;</span> <span class="n">faclami</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.999</span><span class="p">;</span> <span class="n">fackappa</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.00000999</span><span class="p">;</span> <span class="n">fackappa</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.00000999</span><span class="p">;</span> <span class="n">fackappa</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.00000999</span><span class="p">;</span> <span class="n">faclGR</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-268"></a>
<a name="ln-269"></a>          <span class="k">if</span> <span class="p">(</span><span class="n">lEB</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-270"></a>            <span class="c">! read viewfactors between facets</span>
<a name="ln-271"></a>            <span class="c">! Open the file. NF90_NOWRITE tells netCDF we want read-only access to</span>
<a name="ln-272"></a>            <span class="c">! the file.</span>
<a name="ln-273"></a>            <span class="n">FILE_VF</span> <span class="o">=</span> <span class="s1">&#39;vf.nc.inp.&#39;</span><span class="o">//</span><span class="n">cexpnr</span>
<a name="ln-274"></a>            <span class="n">iret</span> <span class="o">=</span> <span class="n">nf90_open</span><span class="p">(</span><span class="n">FILE_VF</span><span class="p">,</span> <span class="n">NF90_NOWRITE</span><span class="p">,</span> <span class="n">ncid</span><span class="p">)</span> <span class="c">! Get the varid of the data variable, based on its name.</span>
<a name="ln-275"></a>            <span class="n">iret</span> <span class="o">=</span> <span class="n">nf90_inq_varid</span><span class="p">(</span><span class="n">ncid</span><span class="p">,</span> <span class="s2">&quot;view factor&quot;</span><span class="p">,</span> <span class="n">varid</span><span class="p">)</span>
<a name="ln-276"></a>            <span class="c">! Read the data.</span>
<a name="ln-277"></a>            <span class="n">iret</span> <span class="o">=</span> <span class="n">nf90_get_var</span><span class="p">(</span><span class="n">ncid</span><span class="p">,</span> <span class="n">varid</span><span class="p">,</span> <span class="n">vf</span><span class="p">)</span>
<a name="ln-278"></a>            <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s2">&quot;vf(1,6),vf(1,7),vf(6,1),vf(7,1)&quot;</span><span class="p">,</span><span class="n">vf</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span><span class="n">vf</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span><span class="n">vf</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">vf</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-279"></a>
<a name="ln-280"></a>            <span class="c">! read skyviewfactors</span>
<a name="ln-281"></a>            <span class="k">open</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="s1">&#39;svf.inp.&#39;</span><span class="o">//</span><span class="n">cexpnr</span><span class="p">)</span>
<a name="ln-282"></a>            <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="s1">&#39;(a80)&#39;</span><span class="p">)</span> <span class="n">chmess</span>
<a name="ln-283"></a>            <span class="k">do </span><span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nfcts</span>
<a name="ln-284"></a>              <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-285"></a>                <span class="n">svf</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a name="ln-286"></a>              <span class="k">end do</span>
<a name="ln-287"></a><span class="k">              close</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">)</span>
<a name="ln-288"></a>
<a name="ln-289"></a>              <span class="c">! read net shortwave radiation</span>
<a name="ln-290"></a>              <span class="k">open</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="s1">&#39;netsw.inp.&#39;</span><span class="o">//</span><span class="n">cexpnr</span><span class="p">)</span>
<a name="ln-291"></a>              <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="s1">&#39;(a80)&#39;</span><span class="p">)</span> <span class="n">chmess</span>
<a name="ln-292"></a>              <span class="k">do </span><span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nfcts</span>
<a name="ln-293"></a>                <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-294"></a>                  <span class="n">netsw</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a name="ln-295"></a>              <span class="k">end do</span>
<a name="ln-296"></a><span class="k">              close</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">)</span>
<a name="ln-297"></a>            <span class="k">end if</span> <span class="c">!lEB</span>
<a name="ln-298"></a>
<a name="ln-299"></a>            <span class="k">if</span> <span class="p">((</span><span class="n">lEB</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">iwalltemp</span> <span class="o">==</span> <span class="mi">2</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-300"></a>              <span class="c">! read initial facet temepratures</span>
<a name="ln-301"></a>              <span class="k">open</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="s1">&#39;Tfacinit.inp.&#39;</span><span class="o">//</span><span class="n">cexpnr</span><span class="p">)</span>
<a name="ln-302"></a>              <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="s1">&#39;(a80)&#39;</span><span class="p">)</span> <span class="n">chmess</span>
<a name="ln-303"></a>              <span class="k">do </span><span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nfcts</span>
<a name="ln-304"></a>                <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-305"></a>                  <span class="n">Tfacinit</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a name="ln-306"></a>              <span class="k">end do</span>
<a name="ln-307"></a><span class="k">              close</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">)</span>
<a name="ln-308"></a>
<a name="ln-309"></a>              <span class="k">do </span><span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nfcts</span>
<a name="ln-310"></a>                <span class="n">facT</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Tfacinit</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="c">!building surfaces is given an initial temperature</span>
<a name="ln-311"></a>                <span class="n">facT</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">nwalllayers</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">bldT</span> <span class="c">!inner most layer has the same temperature as the building interior</span>
<a name="ln-312"></a>                <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span><span class="n">nwalllayers</span>
<a name="ln-313"></a>                  <span class="n">facT</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">Tfacinit</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">Tfacinit</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">-</span><span class="n">bldT</span><span class="p">)</span><span class="o">/</span><span class="n">nwalllayers</span><span class="o">*</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="c">!scale linearly inside the wall</span>
<a name="ln-314"></a>                <span class="k">end do</span>
<a name="ln-315"></a><span class="k">              end do</span>
<a name="ln-316"></a>
<a name="ln-317"></a><span class="k">              do </span><span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">nwalllayers</span>
<a name="ln-318"></a>                 <span class="n">facT</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="mi">28</span><span class="mf">8.</span>
<a name="ln-319"></a>              <span class="k">end do</span>
<a name="ln-320"></a><span class="k">              </span><span class="n">facT</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nwalllayers</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">29</span><span class="mf">9.</span>
<a name="ln-321"></a>            <span class="k">end if</span> <span class="c">!((lEB) .or. (iwalltemp == 2))</span>
<a name="ln-322"></a>
<a name="ln-323"></a>            <span class="c">! assign initial soil moisture (only outermost layer)</span>
<a name="ln-324"></a>            <span class="k">do </span><span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nfcts</span>
<a name="ln-325"></a>              <span class="k">if</span> <span class="p">(</span><span class="n">faclGR</span><span class="p">(</span><span class="n">n</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-326"></a><span class="k">                </span><span class="n">facwsoil</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="n">wsoil</span>
<a name="ln-327"></a>                <span class="n">fachurel</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="nb">cos</span><span class="p">(</span><span class="mf">3.14159</span><span class="o">*</span><span class="n">wsoil</span><span class="o">/</span><span class="n">wfc</span><span class="p">))</span>
<a name="ln-328"></a>              <span class="k">end if</span>
<a name="ln-329"></a><span class="k">            end do</span>
<a name="ln-330"></a>
<a name="ln-331"></a><span class="k">         end if</span> <span class="c">!(myid .eq. 0)</span>
<a name="ln-332"></a>
<a name="ln-333"></a>         <span class="c">!write (*, *) &quot;starting broadcast of facet properties&quot;</span>
<a name="ln-334"></a>         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="k">block</span><span class="p">,</span> <span class="mi">11</span><span class="o">*</span><span class="n">nblocks</span><span class="p">,</span> <span class="n">MPI_INTEGER</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-335"></a>         <span class="c">!many of these are actually only needed on processor 0...</span>
<a name="ln-336"></a>         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">faclGR</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">),</span> <span class="n">nfcts</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">mpi_logical</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-337"></a>         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">facz0</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">),</span> <span class="n">nfcts</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-338"></a>         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">facz0h</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">),</span> <span class="n">nfcts</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-339"></a>         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">facalb</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">),</span> <span class="n">nfcts</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-340"></a>         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">facem</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">),</span> <span class="n">nfcts</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-341"></a>         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">facd</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">nwalllayers</span><span class="p">),(</span><span class="n">nfcts</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">nwalllayers</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-342"></a>         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">facdi</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">nwalllayers</span><span class="p">),</span> <span class="p">(</span><span class="n">nfcts</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">nwalllayers</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-343"></a>         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">faccp</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">nwalllayers</span><span class="p">),</span> <span class="p">(</span><span class="n">nfcts</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">nwalllayers</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-344"></a>         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">faclami</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">nwalllayers</span><span class="p">),</span> <span class="p">(</span><span class="n">nfcts</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">nwalllayers</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-345"></a>         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">fackappa</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">nwalllayers</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">nfcts</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">nwalllayers</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-346"></a>         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">faca</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">),</span> <span class="n">nfcts</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-347"></a>         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">facain</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">),</span> <span class="n">nfcts</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MPI_Integer</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-348"></a>         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">facets</span><span class="p">,</span> <span class="mi">4</span><span class="o">*</span><span class="n">nfcts</span><span class="p">,</span> <span class="n">MPI_Integer</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-349"></a>         <span class="c">!walltypes is broadcast further up</span>
<a name="ln-350"></a>         <span class="k">if</span> <span class="p">(</span><span class="n">lEB</span> <span class="p">.</span><span class="n">eqv</span><span class="p">.</span> <span class="p">.</span><span class="n">true</span><span class="p">.)</span> <span class="k">then</span>
<a name="ln-351"></a><span class="k">           call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">svf</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nfcts</span><span class="p">),</span> <span class="n">nfcts</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-352"></a>           <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">netsw</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nfcts</span><span class="p">),</span> <span class="n">nfcts</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-353"></a>         <span class="k">end if</span>
<a name="ln-354"></a>         <span class="c">!facLWin currently not being broadcast..</span>
<a name="ln-355"></a>         <span class="c">!vf currently not being broadcast</span>
<a name="ln-356"></a>         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">Tfacinit</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nfcts</span><span class="p">),</span> <span class="n">nfcts</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-357"></a>         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">facT</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">nwalllayers</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">nfcts</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">nwalllayers</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-358"></a>         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">facTdash</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nfcts</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">nwalllayers</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">nfcts</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">nwalllayers</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-359"></a>         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">facef</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nfcts</span><span class="p">),</span> <span class="n">nfcts</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-360"></a>         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">facefi</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nfcts</span><span class="p">),</span> <span class="n">nfcts</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-361"></a>         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">facefsum</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nfcts</span><span class="p">),</span> <span class="n">nfcts</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-362"></a>         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">fachf</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">),</span> <span class="n">nfcts</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-363"></a>         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">fachfi</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">),</span> <span class="n">nfcts</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-364"></a>         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">fachfsum</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nfcts</span><span class="p">),</span> <span class="n">nfcts</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-365"></a>         <span class="c">! standard plant &amp; soil resistance for grass (Manickathan2018) in s/m</span>
<a name="ln-366"></a>         <span class="n">facf</span><span class="p">(:,</span><span class="mi">4</span><span class="p">)</span><span class="o">=</span><span class="mi">20</span><span class="mf">0.</span>
<a name="ln-367"></a>         <span class="n">facf</span><span class="p">(:,</span><span class="mi">5</span><span class="p">)</span><span class="o">=</span><span class="mi">5</span><span class="mf">0.</span>
<a name="ln-368"></a>         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">facf</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="n">nfcts</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">5</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-369"></a>         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">fachurel</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">),</span> <span class="n">nfcts</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-370"></a>         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">facwsoil</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">),</span> <span class="n">nfcts</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-371"></a>         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">faccth</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">),</span> <span class="n">nfcts</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-372"></a>         <span class="k">do </span><span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nfcts</span>
<a name="ln-373"></a>         <span class="n">facqsat</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="n">qsat</span><span class="p">(</span><span class="n">facT</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-374"></a>         <span class="k">end do</span>
<a name="ln-375"></a><span class="k">         call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">facqsat</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">),</span> <span class="n">nfcts</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-376"></a>
<a name="ln-377"></a>
<a name="ln-378"></a>      <span class="k">end subroutine </span><span class="n">readfacetfiles</span>
<a name="ln-379"></a>
<a name="ln-380"></a>      <span class="kt">real </span><span class="k">function </span><span class="n">qsat</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<a name="ln-381"></a>         <span class="k">implicit none</span>
<a name="ln-382"></a><span class="k">         </span><span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">T</span>
<a name="ln-383"></a>         <span class="kt">real</span> <span class="kd">::</span> <span class="n">gres</span>
<a name="ln-384"></a>         <span class="n">gres</span> <span class="o">=</span> <span class="mi">61</span><span class="mf">1.00</span><span class="o">*</span><span class="nb">exp</span><span class="p">(</span><span class="mi">1</span><span class="mf">7.27</span><span class="o">*</span><span class="p">(</span><span class="n">T</span> <span class="o">-</span> <span class="mi">27</span><span class="mf">3.15</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">T</span> <span class="o">-</span> <span class="mi">3</span><span class="mf">5.85</span><span class="p">))</span> <span class="c">![Pa] Bolton 1980</span>
<a name="ln-385"></a>         <span class="n">qsat</span> <span class="o">=</span> <span class="mf">0.62198</span><span class="o">*</span><span class="mf">0.01</span><span class="o">*</span><span class="n">gres</span><span class="o">/</span><span class="p">(</span><span class="mi">1000</span><span class="o">-</span><span class="mf">0.01</span><span class="o">*</span><span class="n">gres</span><span class="p">)</span> <span class="c">![kg/kg] Murphy &amp; Koop 2005 !1000 can be replaced with actual air pressure if desired</span>
<a name="ln-386"></a>      <span class="k">end function </span><span class="n">qsat</span>
<a name="ln-387"></a>
<a name="ln-388"></a>      <span class="kt">real </span><span class="k">function </span><span class="n">dqsatdT</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<a name="ln-389"></a>         <span class="k">implicit none</span>
<a name="ln-390"></a><span class="k">         </span><span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">T</span>
<a name="ln-391"></a>         <span class="n">dqsatdT</span> <span class="o">=</span> <span class="mf">0.1384832710e-2</span> <span class="o">+</span> <span class="mf">0.7708409674e-4</span><span class="o">*</span><span class="p">(</span><span class="n">T</span> <span class="o">-</span> <span class="mi">300</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.2022064593e-5</span><span class="o">*</span><span class="p">(</span><span class="n">T</span> <span class="o">-</span> <span class="mi">300</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">0.000000036561</span><span class="o">*</span><span class="p">(</span><span class="n">T</span> <span class="o">-</span> <span class="mi">300</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span> <span class="c">!expansion of qsat(T)</span>
<a name="ln-392"></a>      <span class="k">end function </span><span class="n">dqsatdt</span>
<a name="ln-393"></a>
<a name="ln-394"></a>   <span class="k">end module </span><span class="n">initfac</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2021 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> uDALES was developed by The uDALES Team</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>