<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
    <meta name="description" content="Documentation for uDALES">
   
    <meta name="author" content="The uDALES Team" >
    <link rel="icon" href="../favicon.png">

    <title>modglobal.f90 &ndash; uDALES</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">uDALES </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/dalesurban.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/dalesurban.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>modglobal.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 3.3% of total for source files.">471 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/modglobal.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">modglobal.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/modglobal.html">modglobal</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/modglobal.f90.html#src">modglobal.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~modglobal.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilemodglobalf90EfferentGraph" width="193pt" height="32pt"
 viewBox="0.00 0.00 193.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~modglobal.f90~~EfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>sourcefile~~modglobal.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 189,-28 189,4 -4,4"/>
<!-- sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~modglobal.f90</title>
<polygon fill="none" stroke="#000000" points="185,-24 105,-24 105,0 185,0 185,-24"/>
<text text-anchor="middle" x="145" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">modglobal.f90</text>
</g>
<!-- sourcefile~modmpi.f90 -->
<g id="sourcefile~~modglobal.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~modmpi.f90</title>
<g id="a_sourcefile~~modglobal.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/modmpi.f90.html" xlink:title="modmpi.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="69,-24 0,-24 0,0 69,0 69,-24"/>
<text text-anchor="middle" x="34.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modmpi.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modglobal.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modglobal.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~modglobal.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M104.7944,-12C96.4589,-12 87.6289,-12 79.1455,-12"/>
<polygon fill="#ff0000" stroke="#ff0000" points="79.0261,-8.5001 69.0261,-12 79.0261,-15.5001 79.0261,-8.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="190pt" height="32pt"
 viewBox="0.00 0.00 190.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 186,-28 186,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="67,-24 0,-24 0,0 67,0 67,-24"/>
<text text-anchor="middle" x="33.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="182,-24 85,-24 85,0 182,0 182,-24"/>
<text text-anchor="middle" x="133.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~modglobal.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilemodglobalf90AfferentGraph" width="641pt" height="685pt"
 viewBox="0.00 0.00 641.00 685.11" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~modglobal.f90~~AfferentGraph" class="graph" transform="scale(.6436 .6436) rotate(0) translate(4 1060.5392)">
<title>sourcefile~~modglobal.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-1060.5392 992,-1060.5392 992,4 -4,4"/>
<!-- sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~modglobal.f90</title>
<polygon fill="none" stroke="#000000" points="80,-521.6696 0,-521.6696 0,-497.6696 80,-497.6696 80,-521.6696"/>
<text text-anchor="middle" x="40" y="-507.2696" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">modglobal.f90</text>
</g>
<!-- sourcefile~modpois.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~modpois.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/modpois.f90.html" xlink:title="modpois.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="736,-737.6696 665,-737.6696 665,-713.6696 736,-713.6696 736,-737.6696"/>
<text text-anchor="middle" x="700.5" y="-723.2696" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modpois.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modpois.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~modpois.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M699.8136,-737.7663C697.0547,-774.7761 683.6451,-887.6029 621,-947.6696 508.7779,-1055.2728 437.1471,-1011.3201 287,-1051.6696"/>
</g>
<!-- sourcefile~modboundary.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node7" class="node">
<title>sourcefile~modboundary.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node7"><a xlink:href=".././sourcefile/modboundary.f90.html" xlink:title="modboundary.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="604.5,-737.6696 507.5,-737.6696 507.5,-713.6696 604.5,-713.6696 604.5,-737.6696"/>
<text text-anchor="middle" x="556" y="-723.2696" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modboundary.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modpois.f90&#45;&gt;sourcefile~modboundary.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge37" class="edge">
<title>sourcefile~modpois.f90&#45;&gt;sourcefile~modboundary.f90</title>
<path fill="none" stroke="#f6ff00" stroke-dasharray="5,2" d="M664.7809,-725.6696C649.7621,-725.6696 631.8854,-725.6696 615.0071,-725.6696"/>
<polygon fill="#f6ff00" stroke="#f6ff00" points="614.6615,-722.1697 604.6615,-725.6696 614.6614,-729.1697 614.6615,-722.1697"/>
</g>
<!-- sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node29" class="node">
<title>sourcefile~modfields.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node29"><a xlink:href=".././sourcefile/modfields.f90.html" xlink:title="modfields.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="197,-521.6696 121,-521.6696 121,-497.6696 197,-497.6696 197,-521.6696"/>
<text text-anchor="middle" x="159" y="-507.2696" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modfields.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modpois.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge73" class="edge">
<title>sourcefile~modpois.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0069" stroke-dasharray="5,2" d="M677.7576,-713.6613C637.7857,-691.9988 553.2727,-643.6773 491,-590.6696 457.6211,-562.2569 457.2259,-526.5909 413.5,-529.6696"/>
</g>
<!-- sourcefile~modibm.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~modibm.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node3"><a xlink:href=".././sourcefile/modibm.f90.html" xlink:title="modibm.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="321.5,-901.6696 252.5,-901.6696 252.5,-877.6696 321.5,-877.6696 321.5,-901.6696"/>
<text text-anchor="middle" x="287" y="-887.2696" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modibm.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modibm.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~modibm.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M276.6227,-901.8088C248.6028,-934.2606 172.6076,-1020.0165 159,-1011.6696"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M159,-1011.6696C74.531,-959.8563 47.1789,-622.5758 41.3123,-532.0183"/>
<polygon fill="#ff0000" stroke="#ff0000" points="44.8041,-531.7758 40.6878,-522.0133 37.8177,-532.212 44.8041,-531.7758"/>
</g>
<!-- sourcefile~initfac.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node20" class="node">
<title>sourcefile~initfac.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node20"><a xlink:href=".././sourcefile/initfac.f90.html" xlink:title="initfac.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="188,-841.6696 130,-841.6696 130,-817.6696 188,-817.6696 188,-841.6696"/>
<text text-anchor="middle" x="159" y="-827.2696" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">initfac.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modibm.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge55" class="edge">
<title>sourcefile~modibm.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#0046ff" stroke-dasharray="5,2" d="M261.0973,-877.5277C241.8393,-868.5005 215.3454,-856.0815 194.1727,-846.1568"/>
<polygon fill="#0046ff" stroke="#0046ff" points="195.4043,-842.8687 184.8642,-841.7935 192.4332,-849.207 195.4043,-842.8687"/>
</g>
<!-- sourcefile~modibm.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge74" class="edge">
<title>sourcefile~modibm.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0069" stroke-dasharray="5,2" d="M273.7393,-877.3577C262.5432,-866.2197 246.9462,-848.8237 238,-830.6696 205.9723,-765.6773 219.2971,-742.03 202,-671.6696 189.634,-621.3679 173.6741,-562.6909 165.0977,-531.6082"/>
<polygon fill="#ff0069" stroke="#ff0069" points="168.4304,-530.528 162.39,-521.8237 161.6839,-532.395 168.4304,-530.528"/>
</g>
<!-- sourcefile~modsubgrid.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~modsubgrid.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node4"><a xlink:href=".././sourcefile/modsubgrid.f90.html" xlink:title="modsubgrid.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="744,-657.6696 657,-657.6696 657,-633.6696 744,-633.6696 744,-657.6696"/>
<text text-anchor="middle" x="700.5" y="-643.2696" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modsubgrid.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modsubgrid.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~modsubgrid.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M656.7856,-650.4214C581.3906,-658.4997 421.9955,-675.0639 287,-685.6696"/>
</g>
<!-- sourcefile~modsubgrid.f90&#45;&gt;sourcefile~modboundary.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge40" class="edge">
<title>sourcefile~modsubgrid.f90&#45;&gt;sourcefile~modboundary.f90</title>
<path fill="none" stroke="#f6ff00" stroke-dasharray="5,2" d="M678.9335,-657.8552C671.8317,-662.0529 663.9716,-666.9013 657,-671.6696 640.2693,-683.1129 638.5827,-689.5843 621,-699.6696 614.6216,-703.3282 607.6277,-706.7097 600.6654,-709.7407"/>
<polygon fill="#f6ff00" stroke="#f6ff00" points="599.1449,-706.5822 591.2518,-713.6497 601.8295,-713.047 599.1449,-706.5822"/>
</g>
<!-- sourcefile~modsubgrid.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge75" class="edge">
<title>sourcefile~modsubgrid.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0069" stroke-dasharray="5,2" d="M678.2489,-633.6455C620.9002,-603.1524 468.6972,-525.4973 413.5,-529.6696"/>
</g>
<!-- sourcefile~advection.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~advection.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node5"><a xlink:href=".././sourcefile/advection.f90.html" xlink:title="advection.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="325,-657.6696 249,-657.6696 249,-633.6696 325,-633.6696 325,-657.6696"/>
<text text-anchor="middle" x="287" y="-643.2696" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">advection.f90</text>
</a>
</g>
</g>
<!-- sourcefile~advection.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~advection.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M262.988,-657.7988C231.0629,-673.1425 176.6177,-696.3545 159,-685.6696"/>
</g>
<!-- sourcefile~advection.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge76" class="edge">
<title>sourcefile~advection.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0069" stroke-dasharray="5,2" d="M258.8714,-633.5729C251.6386,-629.7296 244.1654,-625.0543 238,-619.6696 208.4275,-593.842 183.8206,-554.9034 170.2845,-530.9487"/>
<polygon fill="#ff0069" stroke="#ff0069" points="173.2296,-529.0412 165.336,-521.9743 167.0997,-532.4213 173.2296,-529.0412"/>
</g>
<!-- sourcefile~advec_2nd.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~advec_2nd.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node6"><a xlink:href=".././sourcefile/advec_2nd.f90.html" xlink:title="advec_2nd.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="455,-905.6696 372,-905.6696 372,-881.6696 455,-881.6696 455,-905.6696"/>
<text text-anchor="middle" x="413.5" y="-891.2696" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">advec_2nd.f90</text>
</a>
</g>
</g>
<!-- sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M404.7437,-906.1245C395.988,-918.8116 382.3694,-939.1922 372,-957.6696 353.9048,-989.9136 363.1396,-1007.5588 336,-1032.6696 318.8553,-1048.5328 309.5793,-1045.69 287,-1051.6696"/>
</g>
<!-- sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modibm.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge33" class="edge">
<title>sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modibm.f90</title>
<path fill="none" stroke="#ff3400" stroke-dasharray="5,2" d="M371.7286,-892.3488C358.895,-891.943 344.7227,-891.4949 331.7011,-891.0831"/>
<polygon fill="#ff3400" stroke="#ff3400" points="331.658,-887.5801 321.5523,-890.7622 331.4367,-894.5766 331.658,-887.5801"/>
</g>
<!-- sourcefile~advec_2nd.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge60" class="edge">
<title>sourcefile~advec_2nd.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#0046ff" stroke-dasharray="5,2" d="M378.6034,-881.6328C365.3464,-877.2663 350.0555,-872.4759 336,-868.6696 289.006,-855.9436 234.1602,-844.3541 198.1209,-837.1761"/>
<polygon fill="#0046ff" stroke="#0046ff" points="198.5123,-833.6859 188.0237,-835.1826 197.1564,-840.5533 198.5123,-833.6859"/>
</g>
<!-- sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge77" class="edge">
<title>sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0069" stroke-dasharray="5,2" d="M409.2031,-881.5963C401.326,-859.2617 384.258,-809.9164 372,-767.6696 353.737,-704.727 379.4,-673.7792 336,-624.6696 320.5325,-607.1672 303.8175,-621.8793 287,-605.6696"/>
</g>
<!-- sourcefile~modboundary.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~modboundary.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M550.9961,-737.9015C537.9187,-769.1028 500.559,-853.5045 455,-914.6696 397.4472,-991.9369 380.1354,-1027.0047 287,-1051.6696"/>
</g>
<!-- sourcefile~moddriver.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node15" class="node">
<title>sourcefile~moddriver.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node15"><a xlink:href=".././sourcefile/moddriver.f90.html" xlink:title="moddriver.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="453,-657.6696 374,-657.6696 374,-633.6696 453,-633.6696 453,-657.6696"/>
<text text-anchor="middle" x="413.5" y="-643.2696" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">moddriver.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modboundary.f90&#45;&gt;sourcefile~moddriver.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge50" class="edge">
<title>sourcefile~modboundary.f90&#45;&gt;sourcefile~moddriver.f90</title>
<path fill="none" stroke="#00ffaf" stroke-dasharray="5,2" d="M534.3573,-713.5193C510.2593,-699.9906 471.1313,-678.0241 443.951,-662.7649"/>
<polygon fill="#00ffaf" stroke="#00ffaf" points="445.3127,-659.5156 434.8795,-657.6721 441.8859,-665.6195 445.3127,-659.5156"/>
</g>
<!-- sourcefile~modinlet.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node17" class="node">
<title>sourcefile~modinlet.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node17"><a xlink:href=".././sourcefile/modinlet.f90.html" xlink:title="modinlet.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="449,-758.6696 378,-758.6696 378,-734.6696 449,-734.6696 449,-758.6696"/>
<text text-anchor="middle" x="413.5" y="-744.2696" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modinlet.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modboundary.f90&#45;&gt;sourcefile~modinlet.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge54" class="edge">
<title>sourcefile~modboundary.f90&#45;&gt;sourcefile~modinlet.f90</title>
<path fill="none" stroke="#00e4ff" stroke-dasharray="5,2" d="M507.3581,-732.8379C491.8979,-735.1163 474.8532,-737.6281 459.5794,-739.879"/>
<polygon fill="#00e4ff" stroke="#00e4ff" points="458.7123,-736.4689 449.3294,-741.3895 459.7329,-743.3941 458.7123,-736.4689"/>
</g>
<!-- sourcefile~modboundary.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge78" class="edge">
<title>sourcefile~modboundary.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0069" stroke-dasharray="5,2" d="M544.4666,-713.3283C522.2774,-689.7232 474.1486,-639.2272 455,-624.6696 386.7149,-572.7565 372.7686,-530.9212 287,-529.6696"/>
</g>
<!-- sourcefile~modstatsdump.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node8" class="node">
<title>sourcefile~modstatsdump.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node8"><a xlink:href=".././sourcefile/modstatsdump.f90.html" xlink:title="modstatsdump.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="881,-419.6696 780,-419.6696 780,-395.6696 881,-395.6696 881,-419.6696"/>
<text text-anchor="middle" x="830.5" y="-405.2696" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modstatsdump.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M413.5,-163.6696C381.9128,-140.4086 270.6623,-160.944 238,-182.6696 177.5435,-222.8829 223.0171,-291.4073 159,-325.6696"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M159,-325.6696C94.2515,-360.1069 59.5391,-447.0157 46.3422,-487.8444"/>
<polygon fill="#ff0000" stroke="#ff0000" points="42.9311,-487.0277 43.3137,-497.6157 49.6174,-489.1001 42.9311,-487.0277"/>
</g>
<!-- sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modsubgrid.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge36" class="edge">
<title>sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modsubgrid.f90</title>
<path fill="none" stroke="#ff6900" stroke-dasharray="5,2" d="M823.8746,-419.7993C803.0115,-457.9948 738.4901,-576.1186 712.0154,-624.5875"/>
<polygon fill="#ff6900" stroke="#ff6900" points="708.8342,-623.1104 707.1121,-633.5644 714.9775,-626.466 708.8342,-623.1104"/>
</g>
<!-- sourcefile~modstat_nc.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node25" class="node">
<title>sourcefile~modstat_nc.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node25"><a xlink:href=".././sourcefile/modstat_nc.f90.html" xlink:title="modstat_nc.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="202,-57.6696 116,-57.6696 116,-33.6696 202,-33.6696 202,-57.6696"/>
<text text-anchor="middle" x="159" y="-43.2696" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modstat_nc.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modstat_nc.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge68" class="edge">
<title>sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modstat_nc.f90</title>
<path fill="none" stroke="#c100ff" stroke-dasharray="5,2" d="M779.8469,-398.8756C724.908,-389.7554 634.5293,-375.9663 556,-369.6696"/>
<path fill="none" stroke="#c100ff" stroke-dasharray="5,2" d="M556,-369.6696C445.7939,-353.917 503.0632,-229.7904 413.5,-163.6696"/>
<path fill="none" stroke="#c100ff" stroke-dasharray="5,2" d="M413.5,-163.6696C378.2349,-137.6349 374.6931,-123.2676 336,-102.6696 296.6675,-81.7313 248.296,-66.8018 212.0657,-57.4882"/>
<polygon fill="#c100ff" stroke="#c100ff" points="212.7375,-54.0484 202.1864,-55.0099 211.0342,-60.838 212.7375,-54.0484"/>
</g>
<!-- sourcefile~modstatistics.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node28" class="node">
<title>sourcefile~modstatistics.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node28"><a xlink:href=".././sourcefile/modstatistics.f90.html" xlink:title="modstatistics.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="333,-135.6696 241,-135.6696 241,-111.6696 333,-111.6696 333,-135.6696"/>
<text text-anchor="middle" x="287" y="-121.2696" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modstatistics.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modstatistics.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge72" class="edge">
<title>sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modstatistics.f90</title>
<path fill="none" stroke="#ff009e" stroke-dasharray="5,2" d="M413.5,-163.6696C392.9077,-148.4672 366.3568,-138.9258 342.9006,-132.9954"/>
<polygon fill="#ff009e" stroke="#ff009e" points="343.6009,-129.5646 333.0638,-130.6689 341.9897,-136.3766 343.6009,-129.5646"/>
</g>
<!-- sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge80" class="edge">
<title>sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0069" stroke-dasharray="5,2" d="M556,-369.6696C517.6997,-366.5986 517.1335,-398.5025 491,-426.6696 452.035,-468.6667 470.626,-525.3515 413.5,-529.6696"/>
<path fill="none" stroke="#ff0069" stroke-dasharray="5,2" d="M413.5,-529.6696C357.4377,-533.9073 343.2212,-529.3302 287,-529.6696"/>
</g>
<!-- sourcefile~modsave.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node9" class="node">
<title>sourcefile~modsave.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node9"><a xlink:href=".././sourcefile/modsave.f90.html" xlink:title="modsave.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="324,-779.6696 250,-779.6696 250,-755.6696 324,-755.6696 324,-779.6696"/>
<text text-anchor="middle" x="287" y="-765.2696" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modsave.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modsave.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge8" class="edge">
<title>sourcefile~modsave.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M255.5741,-755.6026C249.6038,-752.9215 243.5061,-749.9047 238,-746.6696 199.7531,-724.1979 196.9293,-708.6733 159,-685.6696"/>
</g>
<!-- sourcefile~modsave.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge62" class="edge">
<title>sourcefile~modsave.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#0046ff" stroke-dasharray="5,2" d="M257.8224,-779.7554C251.2604,-782.5894 244.3586,-785.6621 238,-788.6696 222.0725,-796.2032 204.6609,-805.1596 190.2471,-812.7768"/>
<polygon fill="#0046ff" stroke="#0046ff" points="188.4388,-809.7742 181.2538,-817.5605 191.7262,-815.9543 188.4388,-809.7742"/>
</g>
<!-- sourcefile~modsave.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge79" class="edge">
<title>sourcefile~modsave.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0069" stroke-dasharray="5,2" d="M249.9419,-755.9483C245.5208,-753.4081 241.3841,-750.3475 238,-746.6696 208.1839,-714.2655 175.9646,-584.158 163.9133,-531.7289"/>
<polygon fill="#ff0069" stroke="#ff0069" points="167.2826,-530.7604 161.6559,-521.7832 160.4562,-532.3099 167.2826,-530.7604"/>
</g>
<!-- sourcefile~modchem.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node10" class="node">
<title>sourcefile~modchem.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node10"><a xlink:href=".././sourcefile/modchem.f90.html" xlink:title="modchem.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="326,-459.6696 248,-459.6696 248,-435.6696 326,-435.6696 326,-459.6696"/>
<text text-anchor="middle" x="287" y="-445.2696" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modchem.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modchem.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge9" class="edge">
<title>sourcefile~modchem.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M252.5521,-435.5457C247.4302,-433.0095 242.4007,-430.0566 238,-426.6696 192.8378,-391.9108 209.0814,-298.473 159,-325.6696"/>
</g>
<!-- sourcefile~modchem.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge81" class="edge">
<title>sourcefile~modchem.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0069" stroke-dasharray="5,2" d="M257.8224,-459.7554C251.2604,-462.5894 244.3586,-465.6621 238,-468.6696 222.0725,-476.2032 204.6609,-485.1596 190.2471,-492.7768"/>
<polygon fill="#ff0069" stroke="#ff0069" points="188.4388,-489.7742 181.2538,-497.5605 191.7262,-495.9543 188.4388,-489.7742"/>
</g>
<!-- sourcefile~modstartup.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node11" class="node">
<title>sourcefile~modstartup.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node11"><a xlink:href=".././sourcefile/modstartup.f90.html" xlink:title="modstartup.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="873,-677.6696 788,-677.6696 788,-653.6696 873,-653.6696 873,-677.6696"/>
<text text-anchor="middle" x="830.5" y="-663.2696" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modstartup.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge11" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M556,-529.6696C524.8064,-531.74 324.669,-579.9354 238,-624.6696 198.5812,-645.0157 196.9293,-708.6733 159,-685.6696"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M159,-685.6696C100.2231,-648.0419 63.3239,-569.8912 48.071,-531.6742"/>
<polygon fill="#ff0000" stroke="#ff0000" points="51.2106,-530.0882 44.3427,-522.0208 44.6806,-532.6102 51.2106,-530.0882"/>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modpois.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge30" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modpois.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M804.1926,-677.8115C784.5456,-686.8794 757.4833,-699.3697 735.932,-709.3164"/>
<polygon fill="#ff0000" stroke="#ff0000" points="734.3812,-706.1773 726.7683,-713.5458 737.3146,-712.533 734.3812,-706.1773"/>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modsubgrid.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge35" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modsubgrid.f90</title>
<path fill="none" stroke="#ff6900" stroke-dasharray="5,2" d="M787.9331,-659.1209C777.1612,-657.4637 765.4524,-655.6623 754.2086,-653.9325"/>
<polygon fill="#ff6900" stroke="#ff6900" points="754.4696,-650.4315 744.0536,-652.3702 753.4051,-657.3501 754.4696,-650.4315"/>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modboundary.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge38" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modboundary.f90</title>
<path fill="none" stroke="#f6ff00" stroke-dasharray="5,2" d="M787.9106,-674.9788C741.463,-685.1313 666.8153,-701.4477 614.8,-712.8172"/>
<polygon fill="#f6ff00" stroke="#f6ff00" points="613.7357,-709.4671 604.7138,-715.0218 615.2305,-716.3056 613.7357,-709.4671"/>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~moddriver.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge49" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~moddriver.f90</title>
<path fill="none" stroke="#00ffaf" stroke-dasharray="5,2" d="M700.5,-529.6696C676.4516,-518.2397 517.6416,-594.0236 447.1293,-628.8404"/>
<polygon fill="#00ffaf" stroke="#00ffaf" points="445.1957,-625.8923 437.789,-633.468 448.3034,-632.1647 445.1957,-625.8923"/>
</g>
<!-- sourcefile~modforces.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node16" class="node">
<title>sourcefile~modforces.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node16"><a xlink:href=".././sourcefile/modforces.f90.html" xlink:title="modforces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="596.5,-459.6696 515.5,-459.6696 515.5,-435.6696 596.5,-435.6696 596.5,-459.6696"/>
<text text-anchor="middle" x="556" y="-445.2696" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modforces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modforces.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge51" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modforces.f90</title>
<path fill="none" stroke="#00ffe4" stroke-dasharray="5,2" d="M823.2877,-653.4371C806.1198,-625.6193 759.7957,-557.8522 700.5,-529.6696"/>
<path fill="none" stroke="#00ffe4" stroke-dasharray="5,2" d="M700.5,-529.6696C660.2761,-510.5517 660.4313,-489.373 621,-468.6696 616.3932,-466.2508 611.4563,-464.0443 606.4376,-462.0483"/>
<polygon fill="#00ffe4" stroke="#00ffe4" points="607.3443,-458.6521 596.7511,-458.469 604.918,-465.2182 607.3443,-458.6521"/>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modinlet.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge53" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modinlet.f90</title>
<path fill="none" stroke="#00e4ff" stroke-dasharray="5,2" d="M822.3985,-677.6776C808.8081,-696.6108 779.3983,-732.6833 744,-746.6696 648.517,-784.3963 525.0538,-769.3859 459.3678,-756.9282"/>
<polygon fill="#00e4ff" stroke="#00e4ff" points="459.8217,-753.4506 449.3348,-754.9592 458.4736,-760.3195 459.8217,-753.4506"/>
</g>
<!-- sourcefile~modthermodynamics.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node27" class="node">
<title>sourcefile~modthermodynamics.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node27"><a xlink:href=".././sourcefile/modthermodynamics.f90.html" xlink:title="modthermodynamics.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="621,-501.6696 491,-501.6696 491,-477.6696 621,-477.6696 621,-501.6696"/>
<text text-anchor="middle" x="556" y="-487.2696" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modthermodynamics.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modthermodynamics.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge70" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modthermodynamics.f90</title>
<path fill="none" stroke="#ff00d3" stroke-dasharray="5,2" d="M700.5,-529.6696C677.5641,-518.7684 651.1239,-510.3667 627.1813,-504.1427"/>
<polygon fill="#ff00d3" stroke="#ff00d3" points="627.9946,-500.7383 617.4429,-501.6932 626.2871,-507.5268 627.9946,-500.7383"/>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge82" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0069" stroke-dasharray="5,2" d="M700.5,-529.6696C643.1731,-500.7193 620.0812,-525.4164 556,-529.6696"/>
<path fill="none" stroke="#ff0069" stroke-dasharray="5,2" d="M556,-529.6696C492.8057,-533.864 476.6532,-524.8959 413.5,-529.6696"/>
</g>
<!-- sourcefile~modchecksim.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node12" class="node">
<title>sourcefile~modchecksim.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node12"><a xlink:href=".././sourcefile/modchecksim.f90.html" xlink:title="modchecksim.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="335,-337.6696 239,-337.6696 239,-313.6696 335,-313.6696 335,-337.6696"/>
<text text-anchor="middle" x="287" y="-323.2696" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modchecksim.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modchecksim.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge10" class="edge">
<title>sourcefile~modchecksim.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M238.7019,-315.1074C213.5072,-312.116 183.0201,-312.6256 159,-325.6696"/>
</g>
<!-- sourcefile~modchecksim.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge83" class="edge">
<title>sourcefile~modchecksim.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0069" stroke-dasharray="5,2" d="M275.9999,-337.952C265.7342,-349.6325 250.2095,-367.8656 238,-384.6696 212.3089,-420.0286 185.8491,-463.642 171.0056,-488.8923"/>
<polygon fill="#ff0069" stroke="#ff0069" points="167.9321,-487.2148 165.9113,-497.6152 173.9768,-490.7451 167.9321,-487.2148"/>
</g>
<!-- sourcefile~wf_uno.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node13" class="node">
<title>sourcefile~wf_uno.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node13"><a xlink:href=".././sourcefile/wf_uno.f90.html" xlink:title="wf_uno.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="319.5,-1023.6696 254.5,-1023.6696 254.5,-999.6696 319.5,-999.6696 319.5,-1023.6696"/>
<text text-anchor="middle" x="287" y="-1009.2696" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">wf_uno.f90</text>
</a>
</g>
</g>
<!-- sourcefile~wf_uno.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge12" class="edge">
<title>sourcefile~wf_uno.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M254.4999,-1020.5244C226.9967,-1026.0622 187.6032,-1029.2148 159,-1011.6696"/>
</g>
<!-- sourcefile~wf_uno.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge57" class="edge">
<title>sourcefile~wf_uno.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#0046ff" stroke-dasharray="5,2" d="M254.426,-1001.588C248.489,-998.7239 242.6971,-995.1318 238,-990.6696 196.6519,-951.3891 174.0287,-885.892 164.5035,-851.8068"/>
<polygon fill="#0046ff" stroke="#0046ff" points="167.8244,-850.6763 161.864,-841.917 161.0611,-852.4814 167.8244,-850.6763"/>
</g>
<!-- sourcefile~modeb.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node14" class="node">
<title>sourcefile~modeb.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node14"><a xlink:href=".././sourcefile/modeb.f90.html" xlink:title="modEB.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="319.5,-257.6696 254.5,-257.6696 254.5,-233.6696 319.5,-233.6696 319.5,-257.6696"/>
<text text-anchor="middle" x="287" y="-243.2696" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modEB.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modeb.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge13" class="edge">
<title>sourcefile~modeb.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M262.7757,-257.8384C254.7805,-262.035 245.9119,-266.8869 238,-271.6696 201.6033,-293.6712 196.3745,-305.3735 159,-325.6696"/>
</g>
<!-- sourcefile~modeb.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge61" class="edge">
<title>sourcefile~modeb.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#0046ff" stroke-dasharray="5,2" d="M273.1379,-257.7094C261.5563,-268.673 245.7316,-285.9659 238,-304.6696 170.6567,-467.5826 237.9139,-527.0836 202,-699.6696 193.8699,-738.7391 177.9122,-782.4697 167.8888,-807.9483"/>
<polygon fill="#0046ff" stroke="#0046ff" points="164.5804,-806.7954 164.1197,-817.3802 171.0806,-809.393 164.5804,-806.7954"/>
</g>
<!-- sourcefile~modeb.f90&#45;&gt;sourcefile~modstat_nc.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge67" class="edge">
<title>sourcefile~modeb.f90&#45;&gt;sourcefile~modstat_nc.f90</title>
<path fill="none" stroke="#c100ff" stroke-dasharray="5,2" d="M254.2812,-235.7373C248.3562,-232.8609 242.6057,-229.2261 238,-224.6696 192.9189,-180.07 171.576,-105.3261 163.3235,-68.1214"/>
<polygon fill="#c100ff" stroke="#c100ff" points="166.6486,-66.9241 161.1708,-57.8552 159.7976,-68.3607 166.6486,-66.9241"/>
</g>
<!-- sourcefile~moddriver.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge14" class="edge">
<title>sourcefile~moddriver.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M387.5521,-657.7183C362.4621,-668.4344 323.0516,-682.8373 287,-685.6696"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M287,-685.6696C230.2859,-690.1253 207.642,-715.1704 159,-685.6696"/>
</g>
<!-- sourcefile~moddriver.f90&#45;&gt;sourcefile~modsave.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge42" class="edge">
<title>sourcefile~moddriver.f90&#45;&gt;sourcefile~modsave.f90</title>
<path fill="none" stroke="#8cff00" stroke-dasharray="5,2" d="M406.9455,-657.8658C395.2268,-678.6551 368.8105,-721.174 336,-746.6696 334.2186,-748.0539 332.3322,-749.3649 330.377,-750.6041"/>
<polygon fill="#8cff00" stroke="#8cff00" points="328.4955,-747.6461 321.4757,-755.5816 331.912,-753.7557 328.4955,-747.6461"/>
</g>
<!-- sourcefile~moddriver.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge84" class="edge">
<title>sourcefile~moddriver.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0069" stroke-dasharray="5,2" d="M373.966,-635.0732C339.3197,-625.48 293.4886,-611.9237 287,-605.6696"/>
<path fill="none" stroke="#ff0069" stroke-dasharray="5,2" d="M287,-605.6696C255.1954,-575.0145 213.5124,-545.4008 186.4961,-527.3636"/>
<polygon fill="#ff0069" stroke="#ff0069" points="188.2047,-524.2976 177.9318,-521.7056 184.3461,-530.1381 188.2047,-524.2976"/>
</g>
<!-- sourcefile~modforces.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge15" class="edge">
<title>sourcefile~modforces.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M515.4902,-436.2858C506.7831,-432.5786 498.0812,-427.7884 491,-421.6696 466.8901,-400.8365 478.5555,-381.1277 455,-359.6696 411.9277,-320.4326 392.9048,-317.1839 336,-304.6696 258.6304,-287.6548 228.6158,-287.8649 159,-325.6696"/>
</g>
<!-- sourcefile~modforces.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge85" class="edge">
<title>sourcefile~modforces.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0069" stroke-dasharray="5,2" d="M515.2107,-458.3968C506.9734,-461.2357 498.5352,-464.6538 491,-468.6696 452.3166,-489.2859 457.2094,-526.3657 413.5,-529.6696"/>
</g>
<!-- sourcefile~modinlet.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge16" class="edge">
<title>sourcefile~modinlet.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M409.0995,-758.7136C401.054,-781.0005 383.7225,-830.2712 372,-872.6696 352.5762,-942.9228 383.5723,-977.4459 336,-1032.6696 320.7552,-1050.3664 309.5793,-1045.69 287,-1051.6696"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M287,-1051.6696C229.3842,-1066.9279 209.8055,-1042.8337 159,-1011.6696"/>
</g>
<!-- sourcefile~modinlet.f90&#45;&gt;sourcefile~modsave.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge43" class="edge">
<title>sourcefile~modinlet.f90&#45;&gt;sourcefile~modsave.f90</title>
<path fill="none" stroke="#8cff00" stroke-dasharray="5,2" d="M377.9261,-752.5752C364.4011,-754.8204 348.773,-757.4148 334.3295,-759.8126"/>
<polygon fill="#8cff00" stroke="#8cff00" points="333.3606,-756.4254 324.0688,-761.5159 334.507,-763.3309 333.3606,-756.4254"/>
</g>
<!-- sourcefile~modinlet.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge86" class="edge">
<title>sourcefile~modinlet.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0069" stroke-dasharray="5,2" d="M407.0044,-734.4113C392.1517,-706.7546 355.4914,-640.6711 336,-624.6696 317.9467,-609.8488 303.8175,-621.8793 287,-605.6696"/>
</g>
<!-- sourcefile~tstep.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node18" class="node">
<title>sourcefile~tstep.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node18"><a xlink:href=".././sourcefile/tstep.f90.html" xlink:title="tstep.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="440.5,-417.6696 386.5,-417.6696 386.5,-393.6696 440.5,-393.6696 440.5,-417.6696"/>
<text text-anchor="middle" x="413.5" y="-403.2696" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">tstep.f90</text>
</a>
</g>
</g>
<!-- sourcefile~tstep.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge17" class="edge">
<title>sourcefile~tstep.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M386.199,-395.7021C360.8042,-386.7515 321.7632,-373.8035 287,-365.6696"/>
</g>
<!-- sourcefile~tstep.f90&#45;&gt;sourcefile~modchem.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge45" class="edge">
<title>sourcefile~tstep.f90&#45;&gt;sourcefile~modchem.f90</title>
<path fill="none" stroke="#57ff00" stroke-dasharray="5,2" d="M386.3626,-414.6797C370.804,-419.8454 350.8613,-426.4667 332.9306,-432.4199"/>
<polygon fill="#57ff00" stroke="#57ff00" points="331.6044,-429.1723 323.2167,-435.6451 333.8102,-435.8157 331.6044,-429.1723"/>
</g>
<!-- sourcefile~tstep.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge87" class="edge">
<title>sourcefile~tstep.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0069" stroke-dasharray="5,2" d="M408.1575,-418.1183C393.6557,-449.738 350.3451,-530.594 287,-529.6696"/>
<path fill="none" stroke="#ff0069" stroke-dasharray="5,2" d="M287,-529.6696C260.3359,-529.2805 230.9148,-524.962 207.0096,-520.4371"/>
<polygon fill="#ff0069" stroke="#ff0069" points="207.6134,-516.9889 197.1264,-518.4962 206.2644,-523.8577 207.6134,-516.9889"/>
</g>
<!-- sourcefile~wfmneutral.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node19" class="node">
<title>sourcefile~wfmneutral.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node19"><a xlink:href=".././sourcefile/wfmneutral.f90.html" xlink:title="wfmneutral.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="328.5,-981.6696 245.5,-981.6696 245.5,-957.6696 328.5,-957.6696 328.5,-981.6696"/>
<text text-anchor="middle" x="287" y="-967.2696" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">wfmneutral.f90</text>
</a>
</g>
</g>
<!-- sourcefile~wfmneutral.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge18" class="edge">
<title>sourcefile~wfmneutral.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M258.0786,-981.7195C223.0462,-995.9186 167.6224,-1016.9586 159,-1011.6696"/>
</g>
<!-- sourcefile~wfmneutral.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge58" class="edge">
<title>sourcefile~wfmneutral.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#0046ff" stroke-dasharray="5,2" d="M258.8105,-957.6421C251.5778,-953.7986 244.1199,-949.106 238,-943.6696 207.4859,-916.5638 182.7464,-875.3757 169.5118,-850.6362"/>
<polygon fill="#0046ff" stroke="#0046ff" points="172.5914,-848.9723 164.8629,-841.7251 166.3852,-852.2101 172.5914,-848.9723"/>
</g>
<!-- sourcefile~initfac.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge19" class="edge">
<title>sourcefile~initfac.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M154.4804,-817.516C136.6614,-769.5993 71.1249,-593.3669 48.0796,-531.3964"/>
<polygon fill="#ff0000" stroke="#ff0000" points="51.2903,-529.9883 44.5241,-521.8354 44.7292,-532.4282 51.2903,-529.9883"/>
</g>
<!-- sourcefile~scalsource.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node21" class="node">
<title>sourcefile~scalsource.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node21"><a xlink:href=".././sourcefile/scalsource.f90.html" xlink:title="scalsource.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="328,-737.6696 246,-737.6696 246,-713.6696 328,-713.6696 328,-737.6696"/>
<text text-anchor="middle" x="287" y="-723.2696" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">scalsource.f90</text>
</a>
</g>
</g>
<!-- sourcefile~scalsource.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge20" class="edge">
<title>sourcefile~scalsource.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M245.9643,-718.1652C219.7477,-712.125 185.7749,-701.9082 159,-685.6696"/>
</g>
<!-- sourcefile~scalsource.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge59" class="edge">
<title>sourcefile~scalsource.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#0046ff" stroke-dasharray="5,2" d="M253.8636,-737.6828C248.3579,-740.2855 242.8636,-743.2885 238,-746.6696 212.733,-764.2349 189.157,-790.8772 174.4537,-809.2136"/>
<polygon fill="#0046ff" stroke="#0046ff" points="171.395,-807.4424 167.98,-817.4718 176.904,-811.761 171.395,-807.4424"/>
</g>
<!-- sourcefile~scalsource.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge88" class="edge">
<title>sourcefile~scalsource.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0069" stroke-dasharray="5,2" d="M275.6187,-713.6502C265.0837,-702.1556 249.3768,-684.0483 238,-666.6696 208.1199,-621.0261 181.4434,-562.5594 168.0698,-531.4437"/>
<polygon fill="#ff0069" stroke="#ff0069" points="171.1891,-529.8346 164.0591,-521.998 164.7459,-532.5705 171.1891,-529.8346"/>
</g>
<!-- sourcefile~wf_gr.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node22" class="node">
<title>sourcefile~wf_gr.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node22"><a xlink:href=".././sourcefile/wf_gr.f90.html" xlink:title="wf_gr.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="315.5,-821.6696 258.5,-821.6696 258.5,-797.6696 315.5,-797.6696 315.5,-821.6696"/>
<text text-anchor="middle" x="287" y="-807.2696" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">wf_gr.f90</text>
</a>
</g>
</g>
<!-- sourcefile~wf_gr.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge21" class="edge">
<title>sourcefile~wf_gr.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M258.4221,-800.3192C251.3484,-797.2486 244.0653,-793.3838 238,-788.6696 192.4484,-753.2656 208.3289,-715.587 159,-685.6696"/>
</g>
<!-- sourcefile~wf_gr.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge56" class="edge">
<title>sourcefile~wf_gr.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#0046ff" stroke-dasharray="5,2" d="M258.2743,-814.158C240.5302,-816.9305 217.5252,-820.5251 198.1292,-823.5557"/>
<polygon fill="#0046ff" stroke="#0046ff" points="197.4125,-820.1251 188.0727,-825.127 198.4932,-827.0412 197.4125,-820.1251"/>
</g>
<!-- sourcefile~advec_upw.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node23" class="node">
<title>sourcefile~advec_upw.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node23"><a xlink:href=".././sourcefile/advec_upw.f90.html" xlink:title="advec_upw.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="329.5,-501.6696 244.5,-501.6696 244.5,-477.6696 329.5,-477.6696 329.5,-501.6696"/>
<text text-anchor="middle" x="287" y="-487.2696" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">advec_upw.f90</text>
</a>
</g>
</g>
<!-- sourcefile~advec_upw.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge22" class="edge">
<title>sourcefile~advec_upw.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M251.0455,-477.6121C246.3497,-475.1081 241.8432,-472.1471 238,-468.6696 184.1598,-419.9528 222.8077,-291.0189 159,-325.6696"/>
</g>
<!-- sourcefile~advec_upw.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge89" class="edge">
<title>sourcefile~advec_upw.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0069" stroke-dasharray="5,2" d="M244.3779,-496.3293C232.4464,-498.1936 219.395,-500.2329 207.1665,-502.1436"/>
<polygon fill="#ff0069" stroke="#ff0069" points="206.4705,-498.7098 197.1307,-503.7117 207.5512,-505.6259 206.4705,-498.7098"/>
</g>
<!-- sourcefile~modfielddump.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node24" class="node">
<title>sourcefile~modfielddump.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node24"><a xlink:href=".././sourcefile/modfielddump.f90.html" xlink:title="modfielddump.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="336,-215.6696 238,-215.6696 238,-191.6696 336,-191.6696 336,-215.6696"/>
<text text-anchor="middle" x="287" y="-201.2696" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modfielddump.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modfielddump.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge23" class="edge">
<title>sourcefile~modfielddump.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M252.5521,-215.7935C247.4302,-218.3298 242.4007,-221.2827 238,-224.6696 192.8378,-259.4284 209.0814,-298.473 159,-325.6696"/>
</g>
<!-- sourcefile~modfielddump.f90&#45;&gt;sourcefile~modstat_nc.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge65" class="edge">
<title>sourcefile~modfielddump.f90&#45;&gt;sourcefile~modstat_nc.f90</title>
<path fill="none" stroke="#c100ff" stroke-dasharray="5,2" d="M276.7948,-191.5234C266.8342,-179.6349 251.282,-160.9843 238,-144.6696 215.9905,-117.6347 190.9432,-86.116 175.062,-66.0356"/>
<polygon fill="#c100ff" stroke="#c100ff" points="177.5989,-63.6008 168.6532,-57.924 172.1063,-67.9404 177.5989,-63.6008"/>
</g>
<!-- sourcefile~modfielddump.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge90" class="edge">
<title>sourcefile~modfielddump.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0069" stroke-dasharray="5,2" d="M248.7925,-215.81C244.7697,-218.2603 241.045,-221.1849 238,-224.6696 229.0776,-234.8806 181.0738,-422.3575 164.5738,-487.5495"/>
<polygon fill="#ff0069" stroke="#ff0069" points="161.0963,-487.0254 162.0401,-497.5781 167.883,-488.7401 161.0963,-487.0254"/>
</g>
<!-- sourcefile~modstat_nc.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge24" class="edge">
<title>sourcefile~modstat_nc.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M155.817,-58.0805C139.6514,-121.113 66.5922,-405.9825 45.6353,-487.6966"/>
<polygon fill="#ff0000" stroke="#ff0000" points="42.2316,-486.8799 43.1375,-497.436 49.0121,-488.619 42.2316,-486.8799"/>
</g>
<!-- sourcefile~advec_kappa.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node26" class="node">
<title>sourcefile~advec_kappa.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node26"><a xlink:href=".././sourcefile/advec_kappa.f90.html" xlink:title="advec_kappa.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="334,-417.6696 240,-417.6696 240,-393.6696 334,-393.6696 334,-417.6696"/>
<text text-anchor="middle" x="287" y="-403.2696" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">advec_kappa.f90</text>
</a>
</g>
</g>
<!-- sourcefile~advec_kappa.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge25" class="edge">
<title>sourcefile~advec_kappa.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M262.7757,-393.5009C254.7805,-389.3042 245.9119,-384.4523 238,-379.6696 201.6033,-357.6681 196.3745,-305.3735 159,-325.6696"/>
</g>
<!-- sourcefile~advec_kappa.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge91" class="edge">
<title>sourcefile~advec_kappa.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0069" stroke-dasharray="5,2" d="M253.8636,-417.6828C248.3579,-420.2855 242.8636,-423.2885 238,-426.6696 212.733,-444.2349 189.157,-470.8772 174.4537,-489.2136"/>
<polygon fill="#ff0069" stroke="#ff0069" points="171.395,-487.4424 167.98,-497.4718 176.904,-491.761 171.395,-487.4424"/>
</g>
<!-- sourcefile~modthermodynamics.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge26" class="edge">
<title>sourcefile~modthermodynamics.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M504.034,-477.5498C499.3069,-475.1123 494.8561,-472.185 491,-468.6696 460.9833,-441.3058 487.597,-408.9021 455,-384.6696 394.6952,-339.8393 360.1665,-382.7891 287,-365.6696"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M287,-365.6696C272.5521,-362.0251 172.0943,-318.5588 159,-325.6696"/>
</g>
<!-- sourcefile~modthermodynamics.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge92" class="edge">
<title>sourcefile~modthermodynamics.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0069" stroke-dasharray="5,2" d="M526.3261,-501.7266C497.9265,-512.3646 453.5995,-526.6385 413.5,-529.6696"/>
</g>
<!-- sourcefile~modstatistics.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge27" class="edge">
<title>sourcefile~modstatistics.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M278.25,-111.5104C254.3889,-79.0541 188.0371,6.3677 159,-5.6696"/>
</g>
<!-- sourcefile~modstatistics.f90&#45;&gt;sourcefile~modstat_nc.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge66" class="edge">
<title>sourcefile~modstatistics.f90&#45;&gt;sourcefile~modstat_nc.f90</title>
<path fill="none" stroke="#c100ff" stroke-dasharray="5,2" d="M262.8242,-111.4197C254.8323,-107.2177 245.9533,-102.3831 238,-97.6696 219.8156,-86.8929 199.9426,-73.8051 184.6778,-63.4558"/>
<polygon fill="#c100ff" stroke="#c100ff" points="186.5027,-60.4639 176.2702,-57.7169 182.5563,-66.2454 186.5027,-60.4639"/>
</g>
<!-- sourcefile~modstatistics.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge93" class="edge">
<title>sourcefile~modstatistics.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0069" stroke-dasharray="5,2" d="M273.7516,-135.9876C262.5634,-147.1296 246.9711,-164.5278 238,-182.6696 206.2674,-246.8411 218.7785,-270.0749 202,-339.6696 189.1791,-392.8489 173.1715,-455.1285 164.7672,-487.5335"/>
<polygon fill="#ff0069" stroke="#ff0069" points="161.3513,-486.7626 162.2241,-497.3214 168.1264,-488.5229 161.3513,-486.7626"/>
</g>
<!-- sourcefile~modfields.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge28" class="edge">
<title>sourcefile~modfields.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M120.6926,-509.6696C111.0106,-509.6696 100.4673,-509.6696 90.2922,-509.6696"/>
<polygon fill="#ff0000" stroke="#ff0000" points="90.2854,-506.1697 80.2854,-509.6696 90.2853,-513.1697 90.2854,-506.1697"/>
</g>
<!-- sourcefile~program.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node30" class="node">
<title>sourcefile~program.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node30"><a xlink:href=".././sourcefile/program.f90.html" xlink:title="program.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="988,-459.6696 917,-459.6696 917,-435.6696 988,-435.6696 988,-459.6696"/>
<text text-anchor="middle" x="952.5" y="-445.2696" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">program.f90</text>
</a>
</g>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge29" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M951.0351,-435.6386C942.1658,-368.7507 889.5409,-45.6696 700.5,-45.6696 700.5,-45.6696 700.5,-45.6696 556,-45.6696 436.4444,-45.6696 406.1967,-54.9257 287,-45.6696"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M287,-45.6696C227.6573,-40.1166 214.0585,17.1548 159,-5.6696"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M159,-5.6696C139.6991,-13.6708 128.7289,-8.1011 116,-24.6696 58.9778,-98.8924 43.8578,-402.7635 40.713,-487.5877"/>
<polygon fill="#ff0000" stroke="#ff0000" points="37.213,-487.5308 40.3592,-497.6477 44.2086,-487.7769 37.213,-487.5308"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modpois.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge31" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modpois.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M830.5,-765.6696C814.014,-775.1561 766.7965,-756.863 734.0539,-741.9964"/>
<polygon fill="#ff0000" stroke="#ff0000" points="735.3694,-738.7485 724.8242,-737.724 732.4288,-745.101 735.3694,-738.7485"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modibm.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge32" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modibm.f90</title>
<path fill="none" stroke="#ff3400" stroke-dasharray="5,2" d="M556,-933.6696C474.9031,-951.9613 378.4309,-924.4272 325.8765,-905.3483"/>
<polygon fill="#ff3400" stroke="#ff3400" points="326.8712,-901.9842 316.2783,-901.7794 324.4315,-908.5453 326.8712,-901.9842"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modsubgrid.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge34" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modsubgrid.f90</title>
<path fill="none" stroke="#ff6900" stroke-dasharray="5,2" d="M949.9486,-459.7854C938.2569,-513.9431 887.9026,-732.6386 830.5,-765.6696"/>
<path fill="none" stroke="#ff6900" stroke-dasharray="5,2" d="M830.5,-765.6696C804.7447,-780.4899 743.6588,-704.357 715.3618,-666.292"/>
<polygon fill="#ff6900" stroke="#ff6900" points="717.965,-663.9239 709.2235,-657.9376 712.324,-668.0686 717.965,-663.9239"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modboundary.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge39" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modboundary.f90</title>
<path fill="none" stroke="#f6ff00" stroke-dasharray="5,2" d="M830.5,-765.6696C752.1381,-810.7612 641.0916,-768.2101 587.4358,-742.3077"/>
<polygon fill="#f6ff00" stroke="#f6ff00" points="588.9266,-739.1404 578.4113,-737.8447 585.8235,-745.415 588.9266,-739.1404"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modstatsdump.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge41" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modstatsdump.f90</title>
<path fill="none" stroke="#c1ff00" stroke-dasharray="5,2" d="M916.8846,-435.9924C904.4424,-431.913 890.2853,-427.2714 877.0838,-422.943"/>
<polygon fill="#c1ff00" stroke="#c1ff00" points="877.8118,-419.4984 867.219,-419.7087 875.6309,-426.15 877.8118,-419.4984"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modsave.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge44" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modsave.f90</title>
<path fill="none" stroke="#8cff00" stroke-dasharray="5,2" d="M830.5,-765.6696C707.3375,-838.4028 693.5123,-894.3062 556,-933.6696"/>
<path fill="none" stroke="#8cff00" stroke-dasharray="5,2" d="M556,-933.6696C541.7632,-937.0737 348.8893,-795.6079 336,-788.6696 332.9745,-787.041 329.796,-785.4431 326.5725,-783.9012"/>
<polygon fill="#8cff00" stroke="#8cff00" points="328.0076,-780.7089 317.4585,-779.7254 325.0919,-787.0728 328.0076,-780.7089"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modstartup.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge46" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modstartup.f90</title>
<path fill="none" stroke="#23ff00" stroke-dasharray="5,2" d="M945.767,-459.7008C925.9417,-495.1263 867.5919,-599.3906 842.3548,-644.4864"/>
<polygon fill="#23ff00" stroke="#23ff00" points="839.192,-642.9712 837.3626,-653.4069 845.3005,-646.3898 839.192,-642.9712"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modchecksim.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge47" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modchecksim.f90</title>
<path fill="none" stroke="#00ff11" stroke-dasharray="5,2" d="M413.5,-268.6696C375.3203,-251.2872 330.5443,-283.9334 305.8157,-306.5854"/>
<polygon fill="#00ff11" stroke="#00ff11" points="303.3637,-304.0872 298.5252,-313.5126 308.1854,-309.1617 303.3637,-304.0872"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modeb.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge48" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modeb.f90</title>
<path fill="none" stroke="#00ff7b" stroke-dasharray="5,2" d="M413.5,-268.6696C387.1633,-256.6791 355.0606,-250.9344 329.7855,-248.1847"/>
<polygon fill="#00ff7b" stroke="#00ff7b" points="330.0519,-244.6942 319.7602,-247.2102 329.3746,-251.6613 330.0519,-244.6942"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modforces.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge52" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modforces.f90</title>
<path fill="none" stroke="#00ffe4" stroke-dasharray="5,2" d="M700.5,-447.6696C669.4684,-447.7412 634.6881,-447.7436 607.027,-447.727"/>
<polygon fill="#00ffe4" stroke="#00ffe4" points="606.7993,-444.2269 596.7968,-447.7198 606.7943,-451.2269 606.7993,-444.2269"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge63" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#0046ff" stroke-dasharray="5,2" d="M556,-933.6696C511.9805,-943.3287 500.0223,-940.6677 455,-942.6696 357.6088,-947.0003 322.787,-958.7837 238,-910.6696 211.3051,-895.5211 187.7663,-868.6885 173.476,-850.0786"/>
<polygon fill="#0046ff" stroke="#0046ff" points="176.1886,-847.8612 167.4065,-841.9345 170.5758,-852.0442 176.1886,-847.8612"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modfielddump.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge64" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modfielddump.f90</title>
<path fill="none" stroke="#8c00ff" stroke-dasharray="5,2" d="M916.6113,-447.6176C867.7342,-447.5586 777.4998,-447.492 700.5,-447.6696"/>
<path fill="none" stroke="#8c00ff" stroke-dasharray="5,2" d="M700.5,-447.6696C688.3302,-447.6977 500.2509,-391.577 491,-383.6696 463.198,-359.9056 476.314,-339.3916 455,-309.6696 439.8904,-288.5996 437.0972,-279.4129 413.5,-268.6696"/>
<path fill="none" stroke="#8c00ff" stroke-dasharray="5,2" d="M413.5,-268.6696C377.3925,-252.3882 371.4803,-242.276 336,-224.6696 332.6967,-223.0304 329.2347,-221.3928 325.7434,-219.7959"/>
<polygon fill="#8c00ff" stroke="#8c00ff" points="327.0813,-216.5604 316.5222,-215.6911 324.2345,-222.9554 327.0813,-216.5604"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modstat_nc.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge69" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modstat_nc.f90</title>
<path fill="none" stroke="#c100ff" stroke-dasharray="5,2" d="M287,-45.6696C262.5034,-43.7674 235.2902,-43.5083 212.2765,-43.8278"/>
<polygon fill="#c100ff" stroke="#c100ff" points="211.9586,-40.3329 202.0229,-44.0116 212.0841,-47.3318 211.9586,-40.3329"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modthermodynamics.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge71" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modthermodynamics.f90</title>
<path fill="none" stroke="#ff00d3" stroke-dasharray="5,2" d="M700.5,-447.6696C690.5775,-447.6925 641.5412,-462.48 603.31,-474.4999"/>
<polygon fill="#ff00d3" stroke="#ff00d3" points="601.8372,-471.2946 593.3553,-477.6435 603.9451,-477.9697 601.8372,-471.2946"/>
</g>
</g>
</svg>
</div><script>var pansourcefilemodglobalf90AfferentGraph = svgPanZoom('#sourcefilemodglobalf90AfferentGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="190pt" height="32pt"
 viewBox="0.00 0.00 190.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 186,-28 186,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="67,-24 0,-24 0,0 67,0 67,-24"/>
<text text-anchor="middle" x="33.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="182,-24 85,-24 85,0 182,0 182,-24"/>
<text text-anchor="middle" x="133.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/modglobal.html">modglobal</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/modglobal.f90.html#src">modglobal.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="c">!&gt; \file modglobal.f90</span>
<a name="ln-2"></a><span class="c">!!  Declares the global constants</span>
<a name="ln-3"></a>
<a name="ln-4"></a><span class="c">!&gt;</span>
<a name="ln-5"></a><span class="c">!! \author Jasper Tomas, TU Delft 31 March 2014</span>
<a name="ln-6"></a>
<a name="ln-7"></a><span class="c">!!  Declares the global constants</span>
<a name="ln-8"></a><span class="c">!&gt;</span>
<a name="ln-9"></a><span class="c">!  This file is part of DALES.</span>
<a name="ln-10"></a><span class="c">!</span>
<a name="ln-11"></a><span class="c">! DALES is free software; you can redistribute it and/or modify</span>
<a name="ln-12"></a><span class="c">! it under the terms of the GNU General Public License as published by</span>
<a name="ln-13"></a><span class="c">! the Free Software Foundation; either version 3 of the License, or</span>
<a name="ln-14"></a><span class="c">! (at your option) any later version.</span>
<a name="ln-15"></a><span class="c">!</span>
<a name="ln-16"></a><span class="c">! DALES is distributed in the hope that it will be useful,</span>
<a name="ln-17"></a><span class="c">! but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="ln-18"></a><span class="c">! MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="ln-19"></a><span class="c">! GNU General Public License for more details.</span>
<a name="ln-20"></a><span class="c">!</span>
<a name="ln-21"></a><span class="c">! You should have received a copy of the GNU General Public License</span>
<a name="ln-22"></a><span class="c">! along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="ln-23"></a><span class="c">!</span>
<a name="ln-24"></a><span class="c">!  Copyright 1993-2009 Delft University of Technology, Wageningen University, Utrecht University, KNMI</span>
<a name="ln-25"></a><span class="c">!</span>
<a name="ln-26"></a><span class="k">module </span><span class="n">modglobal</span>
<a name="ln-27"></a>
<a name="ln-28"></a>   <span class="k">implicit none</span>
<a name="ln-29"></a><span class="k">   save</span>
<a name="ln-30"></a>
<a name="ln-31"></a><span class="k">   </span><span class="kt">integer</span> <span class="kd">::</span> <span class="n">poisrcheck</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! switch to check if it is the first (RK) time step</span>
<a name="ln-32"></a>   <span class="c">! Simulation dimensions (parconst.f90)</span>
<a name="ln-33"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">imax</span> <span class="o">=</span> <span class="mi">64</span>
<a name="ln-34"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">jtot</span> <span class="o">=</span> <span class="mi">64</span>
<a name="ln-35"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">jmax</span>
<a name="ln-36"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">jsen</span>
<a name="ln-37"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">kmax</span> <span class="o">=</span> <span class="mi">96</span>
<a name="ln-38"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">isen</span>
<a name="ln-39"></a>   <span class="kt">integer</span> <span class="kd">::</span>  <span class="n">ib</span>
<a name="ln-40"></a>   <span class="kt">integer</span> <span class="kd">::</span>  <span class="n">ie</span>
<a name="ln-41"></a>   <span class="kt">integer</span> <span class="kd">::</span>  <span class="n">jb</span>
<a name="ln-42"></a>   <span class="kt">integer</span> <span class="kd">::</span>  <span class="n">je</span>
<a name="ln-43"></a>   <span class="kt">integer</span> <span class="kd">::</span>  <span class="n">jgb</span> <span class="c">! global j range</span>
<a name="ln-44"></a>   <span class="kt">integer</span> <span class="kd">::</span>  <span class="n">jge</span> <span class="c">! global j range</span>
<a name="ln-45"></a>   <span class="kt">integer</span> <span class="kd">::</span>  <span class="n">offset</span>
<a name="ln-46"></a>   <span class="kt">integer</span> <span class="kd">::</span>  <span class="n">kb</span>
<a name="ln-47"></a>   <span class="kt">integer</span> <span class="kd">::</span>  <span class="n">ke</span>
<a name="ln-48"></a>   <span class="kt">integer</span> <span class="kd">::</span>  <span class="n">nsv</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">!&lt; Number of additional scalar fields</span>
<a name="ln-49"></a>   <span class="kt">integer</span> <span class="kd">::</span>  <span class="n">nvar</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-50"></a>   <span class="kt">character</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fieldvars</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a name="ln-51"></a>
<a name="ln-52"></a>   <span class="kt">integer</span> <span class="kd">::</span>  <span class="n">ih</span> <span class="o">=</span> <span class="mi">3</span>
<a name="ln-53"></a>   <span class="kt">integer</span> <span class="kd">::</span>  <span class="n">jh</span> <span class="o">=</span> <span class="mi">3</span>
<a name="ln-54"></a>   <span class="kt">integer</span> <span class="kd">::</span>  <span class="n">kh</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-55"></a>   <span class="kt">integer</span> <span class="kd">::</span>  <span class="n">ihc</span> <span class="o">=</span> <span class="mi">2</span> <span class="c">! used in k-scheme</span>
<a name="ln-56"></a>   <span class="kt">integer</span> <span class="kd">::</span>  <span class="n">jhc</span> <span class="o">=</span> <span class="mi">2</span> <span class="c">! used in k-scheme</span>
<a name="ln-57"></a>   <span class="kt">integer</span> <span class="kd">::</span>  <span class="n">khc</span> <span class="o">=</span> <span class="mi">2</span> <span class="c">! used in k-scheme</span>
<a name="ln-58"></a>
<a name="ln-59"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">nblocks</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! no. of blocks in IBM</span>
<a name="ln-60"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="k">block</span><span class="p">(:,:)</span>
<a name="ln-61"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">nfcts</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="c">! no. of wall facets</span>
<a name="ln-62"></a>   <span class="kt">integer</span> <span class="kd">::</span>  <span class="n">iplane</span> <span class="c">! ib+iplane is the plane that is stored when lstoreplane=.true.</span>
<a name="ln-63"></a>   <span class="kt">integer</span> <span class="kd">::</span>  <span class="n">nstore</span> <span class="o">=</span> <span class="mi">1002</span> <span class="c">! number of rk steps in inletfile. This should be a multiple of three!</span>
<a name="ln-64"></a>   <span class="kt">character</span><span class="p">(</span><span class="mi">90</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fname_options</span> <span class="o">=</span> <span class="s1">&#39;namoptions&#39;</span>
<a name="ln-65"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">longint</span> <span class="o">=</span> <span class="mi">8</span>
<a name="ln-66"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lwarmstart</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!&lt;   flag for &quot;cold&quot; or &quot;warm&quot; start</span>
<a name="ln-67"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lstratstart</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-68"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lfielddump</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!&lt; switch to enable the fielddump</span>
<a name="ln-69"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lreadscal</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!&lt;   flag for reading scalar pollutant field (warm start)</span>
<a name="ln-70"></a>
<a name="ln-71"></a>   <span class="c">!Switches for boundary conditions</span>
<a name="ln-72"></a>   <span class="c">!momentum (m), temperature (T), humidity (q) and scalars (s)</span>
<a name="ln-73"></a>   <span class="c">!lateral in x/i direction (x), in y/j direction (y) at the top (top) and at the bottom (bot)</span>
<a name="ln-74"></a>   <span class="c">!1 = periodic, &gt;1 special in/outflow conditions</span>
<a name="ln-75"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">BCxm</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-76"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">BCxT</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-77"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">BCxq</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-78"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">BCxs</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-79"></a>   
<a name="ln-80"></a>   <span class="c">!y direction is currently alway periodic</span>
<a name="ln-81"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">BCym</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-82"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">BCyT</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-83"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">BCyq</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-84"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">BCys</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-85"></a>
<a name="ln-86"></a>   <span class="c">!at the top (top)</span>
<a name="ln-87"></a>   <span class="c">!1 = freeslip, 2 = noslip, 3 = determined by inflow conditions</span>
<a name="ln-88"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">BCtopm</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-89"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">BCtopT</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-90"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">BCtopq</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-91"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">BCtops</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-92"></a>
<a name="ln-93"></a>   <span class="c">!at the bottom (bot) !the bottom BC are defacto useless, since they will be covered by a road facet</span>
<a name="ln-94"></a>   <span class="c">!1 = flux, 2 = wall function</span>
<a name="ln-95"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">BCbotm</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-96"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">BCbotT</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-97"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">BCbotq</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-98"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">BCbots</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-99"></a>
<a name="ln-100"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iinletgen</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">!&lt;  0: no inletgen, 1: turb. inlet generator (Lund (1998)), 2: read inlet from file</span>
<a name="ln-101"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">idriver</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">!&lt;  0: no inlet driver store, 1: Save inlet driver data, 2: read inlet driver data from file</span>
<a name="ln-102"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">linoutflow</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!&lt;  switch for periodic BC in both horizontal directions (false) or inflow/outflow in i and periodic in j.</span>
<a name="ln-103"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lzerogradtop</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!&lt;  switch for zero gradient BC&#39;s at top wall (iinletgen 1 and 2 are seperate).</span>
<a name="ln-104"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lzerogradtopscal</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!</span>
<a name="ln-105"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lbuoyancy</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!&lt;  switch for buoyancy force in modforces</span>
<a name="ln-106"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ltempeq</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!&lt;  switch for solving temperature equation (either with or without buoyancy term)</span>
<a name="ln-107"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lscalrec</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!&lt;</span>
<a name="ln-108"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lSIRANEinout</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!&lt;  </span>
<a name="ln-109"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ltempinout</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!&lt;  seperate switch for inflow/outflow BC for temperature (only necessary when linoutflow.eqv..false.).</span>
<a name="ln-110"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lmoistinout</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!&lt;  seperate switch for inflow/outflow BC for moisture (only necessary when linoutflow.eqv..false.).</span>
<a name="ln-111"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lper2inout</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!&lt;  switch that determines type of restart: .true. means switching from periodic to in/outflow: inlet profile is read from prof.inp</span>
<a name="ln-112"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">libm</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span> <span class="c">!&lt;  switch that determines whether the Immersed Boundary Method is turned on</span>
<a name="ln-113"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lwalldist</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!&lt;  switch that determines whether the wall distances should be computed</span>
<a name="ln-114"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lles</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span> <span class="c">!&lt;  switch that determines whether the subgrid model is turned on or constant ekm and ekh are used (DNS)</span>
<a name="ln-115"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">linletRA</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!&lt;  switch that determines whether a Running Average should be used (.true.) in inlet generator</span>
<a name="ln-116"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lfixinlet</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!&lt;  switch that determines whether the average inlet profiles can evolve or not (only used when iinletgen=1,2)</span>
<a name="ln-117"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lfixutauin</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!&lt;  switch that determines whether the utau is kept fixed at the inlet (only used when iinletgen=1,2)</span>
<a name="ln-118"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lscasrc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!</span>
<a name="ln-119"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lscasrcl</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!tg3315</span>
<a name="ln-120"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lydump</span><span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>  <span class="c">!&lt;  switch to output y-averaged statistics every tsample</span>
<a name="ln-121"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lytdump</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>  <span class="c">!&lt;  switch to output y- and time- averaged statistics every tstatsdump</span>
<a name="ln-122"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lxydump</span>    <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>  <span class="c">!&lt;  switch to output x- and y-avewraged statistics every tsample</span>
<a name="ln-123"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lxytdump</span>   <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>  <span class="c">!&lt;  switch to output x-, y- and time-averaged statistics every tstatsdump</span>
<a name="ln-124"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lscasrcr</span>  <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>  <span class="c">!&lt;  switch for network of point sources at lowest level</span>
<a name="ln-125"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ltkedump</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!tg3315</span>
<a name="ln-126"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lslicedump</span><span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>  <span class="c">!&lt;  switch to output slices in the xy-plane every tstatsdump</span>
<a name="ln-127"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ltdump</span>    <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>      <span class="c">!&lt;  switch to output time-averaged statistics every tstatsdump</span>
<a name="ln-128"></a>
<a name="ln-129"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lreadminl</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!&lt;  switch for reading mean inlet/recycle plane profiles (used in inletgenerator)</span>
<a name="ln-130"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lwallfunc</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span> <span class="c">!&lt;  switch that determines whether wall functions are used to compute the wall-shear stress</span>
<a name="ln-131"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">luoutflowr</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!&lt;  switch that determines whether u-velocity is corrected to get a fixed outflow rate</span>
<a name="ln-132"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lvoutflowr</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!&lt;  switch that determines whether u-velocity is corrected to get a fixed outflow rate</span>
<a name="ln-133"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">luvolflowr</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!&lt;  switch that determines whether u-velocity is corrected to get a fixed volume flow rate</span>
<a name="ln-134"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lvvolflowr</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!&lt;  switch that determines whether u-velocity is corrected to get a fixed volume flow rate</span>
<a name="ln-135"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lstoreplane</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!&lt;  switch that determines whether i-plane data is stored.</span>
<a name="ln-136"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lstorexy</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!xy files stored</span>
<a name="ln-137"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lreadmean</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!&lt;  switch that determines whether mean variables should be read from means#myid#.#expnr#</span>
<a name="ln-138"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="nb">lstat</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-139"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lEB</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-140"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lwriteEBfiles</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-141"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lconstW</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>  <span class="c">! The evaporated water can be removed from the soil (lconstW=false) or the soil moisture can be assumed as constant in time (lconstW=true)</span>
<a name="ln-142"></a><span class="c">!  logical :: ifixuinf   = .true. !dpdxl relaxed to have Uinf 1. dpdx = (1/dt)*(Uh-Uinf)2. d/dt(dpdx) = 1/tau*(Uh-Uinf)</span>
<a name="ln-143"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ifixuinf</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-144"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lvinf</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!use Vinf instead of Uinf for the fixed velocity at infinity</span>
<a name="ln-145"></a>
<a name="ln-146"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">freestreamav</span> <span class="o">=</span> <span class="mf">0.</span> <span class="c">!</span>
<a name="ln-147"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">freestrtmpav</span> <span class="o">=</span> <span class="mf">0.</span> <span class="c">!</span>
<a name="ln-148"></a>   <span class="c">!&lt;  Global constants modconst.f90</span>
<a name="ln-149"></a>   <span class="c">!&lt; File numbers</span>
<a name="ln-150"></a>
<a name="ln-151"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">ifinput</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-152"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">ifoutput</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-153"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">ifnamopt</span> <span class="o">=</span> <span class="mi">3</span>
<a name="ln-154"></a>
<a name="ln-155"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">pi</span> <span class="o">=</span> <span class="mf">3.141592653589793116</span>
<a name="ln-156"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">grav</span> <span class="o">=</span> <span class="mf">9.81</span> <span class="c">!&lt;    *gravity acceleration.</span>
<a name="ln-157"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">rd</span> <span class="o">=</span> <span class="mi">28</span><span class="mf">7.04</span> <span class="c">!&lt;    *gas constant for dry air.</span>
<a name="ln-158"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">rv</span> <span class="o">=</span> <span class="mi">46</span><span class="mf">1.5</span> <span class="c">!&lt;    *gas constant for water vapor.</span>
<a name="ln-159"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">cp</span> <span class="o">=</span> <span class="mi">100</span><span class="mf">4.</span> <span class="c">!&lt;    *specific heat at constant pressure (dry air).</span>
<a name="ln-160"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">rlv</span> <span class="o">=</span> <span class="mf">2.26e6</span> <span class="c">!&lt;    *latent heat for vaporisation.</span>
<a name="ln-161"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">rlvi</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">rlv</span> <span class="c">!inverse</span>
<a name="ln-162"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">ep</span> <span class="o">=</span> <span class="n">rd</span><span class="o">/</span><span class="n">rv</span> <span class="c">!&lt;    0.622</span>
<a name="ln-163"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">ep2</span> <span class="o">=</span> <span class="n">rv</span><span class="o">/</span><span class="n">rd</span> <span class="o">-</span> <span class="mf">1.</span> <span class="c">!&lt;    0.61</span>
<a name="ln-164"></a>   <span class="c">!&lt; real,parameter :: cv       = cp-rd            !&lt;    716.96</span>
<a name="ln-165"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">rcp</span> <span class="o">=</span> <span class="n">rd</span><span class="o">/</span><span class="n">cp</span> <span class="c">!&lt;    0.286</span>
<a name="ln-166"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">cpr</span> <span class="o">=</span> <span class="n">cp</span><span class="o">/</span><span class="n">rd</span> <span class="c">!&lt;    3.50</span>
<a name="ln-167"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">rlvocp</span> <span class="o">=</span> <span class="n">rlv</span><span class="o">/</span><span class="n">cp</span> <span class="c">!&lt;    2.49</span>
<a name="ln-168"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">mair</span> <span class="o">=</span> <span class="mi">2</span><span class="mf">8.967</span> <span class="c">!&lt; Molar mass of air</span>
<a name="ln-169"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">rhoa</span> <span class="o">=</span> <span class="mf">1.2</span> <span class="c">!density of air used in some calculations</span>
<a name="ln-170"></a>
<a name="ln-171"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">wfc</span> <span class="o">=</span> <span class="mi">31</span><span class="mf">3.</span> <span class="c">!water content at field capacity (kg/m3)</span>
<a name="ln-172"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">wwilt</span> <span class="o">=</span> <span class="mi">17</span><span class="mf">1.</span> <span class="c">!water ocntent at wilting point (kg/m3)</span>
<a name="ln-173"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">wgrmax</span> <span class="o">=</span> <span class="mi">45</span><span class="mf">0.</span> <span class="c">!maximum water content (kg/m3)</span>
<a name="ln-174"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">rsmin</span> <span class="o">=</span> <span class="mi">11</span><span class="mf">0.</span> <span class="c">!minimum resistance of soil/plant</span>
<a name="ln-175"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">rsmax</span> <span class="o">=</span> <span class="mi">500</span><span class="mf">0.</span> <span class="c">!maximum resistance of soil/plant</span>
<a name="ln-176"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">GRLAI</span> <span class="o">=</span> <span class="mf">2.</span> <span class="c">!Leave area index of green roof</span>
<a name="ln-177"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">wsoil</span> <span class="o">=</span> <span class="mf">0.</span> <span class="c">!water content of soil (kg/m3)</span>
<a name="ln-178"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">bldT</span> <span class="o">=</span> <span class="mf">0.</span> <span class="c">!building internal temperature, currently also ground temperature at a depth equal to floor facet thickness</span>
<a name="ln-179"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">skyLW</span> <span class="o">=</span> <span class="mf">0.</span> <span class="c">!longwave radiation from the sky</span>
<a name="ln-180"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">gres</span> <span class="o">=</span> <span class="mf">0.</span> <span class="c">!saturation vapour pressure of green roof</span>
<a name="ln-181"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">grqs</span> <span class="o">=</span> <span class="mf">0.</span> <span class="c">!saturation humidity of green roof</span>
<a name="ln-182"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">grdqdt</span> <span class="o">=</span> <span class="mf">0.</span> <span class="c">!gradient of saturation humidity for green roof</span>
<a name="ln-183"></a>
<a name="ln-184"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">numol</span> <span class="o">=</span> <span class="mf">1.5e-5</span> <span class="c">!&lt; kinematic viscosity for couette flow Re=5000 (Re=Uinf*H/(2*nu)) H=1, Uinf=1</span>
<a name="ln-185"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">numoli</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">numol</span> <span class="c">!&lt; 1/numol</span>
<a name="ln-186"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">prandtlmol</span> <span class="o">=</span> <span class="mf">0.71</span> <span class="c">!&lt; Prandtl number (for air at 300K). Fluid property!</span>
<a name="ln-187"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">prandtlmoli</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">prandtlmol</span> <span class="c">!&lt; Inverse of Prandtl number</span>
<a name="ln-188"></a>
<a name="ln-189"></a>   <span class="kt">integer</span>         <span class="kd">::</span> <span class="n">iwallmom</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">iwalltemp</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">iwallmoist</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">iwallscal</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-190"></a>
<a name="ln-191"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">rhow</span> <span class="o">=</span> <span class="mf">0.998e3</span> <span class="c">!&lt;    * Density of water</span>
<a name="ln-192"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">pref0</span> <span class="o">=</span> <span class="mf">1.e5</span> <span class="c">!&lt;    *standard pressure used in exner function.</span>
<a name="ln-193"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">tmelt</span> <span class="o">=</span> <span class="mi">27</span><span class="mf">3.16</span> <span class="c">!&lt;    *temperature of melting of ice.</span>
<a name="ln-194"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">es0</span> <span class="o">=</span> <span class="mi">61</span><span class="mf">0.78</span> <span class="c">!&lt;    * constants used for computation</span>
<a name="ln-195"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">at</span> <span class="o">=</span> <span class="mi">1</span><span class="mf">7.27</span> <span class="c">!&lt;    * of saturation mixing ratio</span>
<a name="ln-196"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">bt</span> <span class="o">=</span> <span class="mi">3</span><span class="mf">5.86</span> <span class="c">!&lt;    * using Tetens Formula.</span>
<a name="ln-197"></a>   <span class="c">!      real,parameter :: ekmin    = 1.e-6            !&lt;    *minimum value for k-coefficient.</span>
<a name="ln-198"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">ekmin</span> <span class="o">=</span> <span class="mf">1.e-12</span> <span class="c">!&lt;    *minimum value for k-coefficient.</span>
<a name="ln-199"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">e12min</span> <span class="o">=</span> <span class="mf">5.e-5</span> <span class="c">!&lt;    *minimum value for TKE.</span>
<a name="ln-200"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">fkar</span> <span class="o">=</span> <span class="mf">0.41</span> <span class="c">!&lt;  0.41   *Von Karman constant</span>
<a name="ln-201"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">eps1</span> <span class="o">=</span> <span class="mf">1.e-10</span> <span class="c">!&lt;    *very small number*</span>
<a name="ln-202"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">epscloud</span> <span class="o">=</span> <span class="mf">1.e-5</span> <span class="c">!&lt;    *limit for cloud calculation 0.01 g/kg</span>
<a name="ln-203"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">boltz</span> <span class="o">=</span> <span class="mf">5.67e-8</span> <span class="c">!&lt;    *Stefan-Boltzmann constant</span>
<a name="ln-204"></a>
<a name="ln-205"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lprofforc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!&lt;  nudge flow to a profile !</span>
<a name="ln-206"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lcoriol</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!&lt;  switch for coriolis force</span>
<a name="ln-207"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">igrw_damp</span> <span class="o">=</span> <span class="mi">2</span> <span class="c">!&lt; switch to enable gravity wave damping</span>
<a name="ln-208"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">geodamptime</span> <span class="o">=</span> <span class="mi">720</span><span class="mf">0.</span> <span class="c">!&lt; time scale for nudging to geowind in sponge layer, prevents oscillations</span>
<a name="ln-209"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">uflowrate</span> <span class="o">=</span> <span class="mf">1.</span> <span class="c">!&lt; fixed flow rate used for u-velocity correction</span>
<a name="ln-210"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">vflowrate</span> <span class="o">=</span> <span class="mf">1.</span> <span class="c">!&lt; fixed flow rate used for v-velocity correction</span>
<a name="ln-211"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">Uinf</span> <span class="o">=</span> <span class="mf">0.</span> <span class="c">!&lt; fixed U_inf (used in inlet generator), also in conjunction with ifixuinf</span>
<a name="ln-212"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">Vinf</span> <span class="o">=</span> <span class="mf">0.</span> <span class="c">!fixed V_inf</span>
<a name="ln-213"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">inletav</span> <span class="o">=</span> <span class="mf">0.</span> <span class="c">!&lt; averaging interval for inlet generator</span>
<a name="ln-214"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">totinletav</span> <span class="o">=</span> <span class="mf">0.</span> <span class="c">!&lt; averaging interval for inlet generator (used in Running Average)</span>
<a name="ln-215"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">om22</span> <span class="c">!&lt;    *2.*omega_earth*cos(lat)</span>
<a name="ln-216"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">om23</span> <span class="c">!&lt;    *2.*omega_earth*sin(lat)</span>
<a name="ln-217"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">om22_gs</span> <span class="c">!&lt;    *2.*omega_earth*cos(lat)</span>
<a name="ln-218"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">om23_gs</span> <span class="c">!&lt;    *2.*omega_earth*sin(lat)</span>
<a name="ln-219"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">xlat</span> <span class="o">=</span> <span class="mi">5</span><span class="mf">2.</span> <span class="c">!&lt;    *latitude  in degrees.</span>
<a name="ln-220"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">xlon</span> <span class="o">=</span> <span class="mf">0.</span> <span class="c">!&lt;    *longitude in degrees.</span>
<a name="ln-221"></a>
<a name="ln-222"></a>   <span class="c">!scalar source in fluid domain</span>
<a name="ln-223"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">xSa</span><span class="p">(:)</span>
<a name="ln-224"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">ySa</span><span class="p">(:)</span>
<a name="ln-225"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">zSa</span><span class="p">(:)</span>
<a name="ln-226"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">xS</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">yS</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">zS</span> <span class="o">=</span> <span class="mf">0.</span>
<a name="ln-227"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">SS</span> <span class="o">=</span> <span class="mf">0.</span>
<a name="ln-228"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">sigS</span> <span class="o">=</span> <span class="mf">0.</span>
<a name="ln-229"></a>
<a name="ln-230"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lnudge</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>                   <span class="c">!&lt; switch for applying nudging at the top of the domain</span>
<a name="ln-231"></a>  <span class="kt">real</span>    <span class="kd">::</span> <span class="n">tnudge</span> <span class="o">=</span> <span class="mi">5</span><span class="mf">0.</span>                       <span class="c">!&lt; time scale for nudging</span>
<a name="ln-232"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">nnudge</span> <span class="o">=</span> <span class="mi">10</span>
<a name="ln-233"></a>
<a name="ln-234"></a>  <span class="c">!chemistry</span>
<a name="ln-235"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lchem</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>    <span class="c">! switch for basic chemistry</span>
<a name="ln-236"></a>  <span class="kt">real</span>    <span class="kd">::</span> <span class="n">k1</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">JNO2</span> <span class="o">=</span> <span class="mf">0.</span>   <span class="c">! k1 = rate constant (O3 + NO -&gt; NO2 + 02 ), JNO2 = NO2 photolysis rate</span>
<a name="ln-237"></a>
<a name="ln-238"></a>   <span class="c">! Poisson solver</span>
<a name="ln-239"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">POISS_FFT</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-240"></a>                         <span class="n">POISS_CYC</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-241"></a>
<a name="ln-242"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ipoiss</span>   <span class="o">=</span> <span class="n">POISS_CYC</span>
<a name="ln-243"></a>
<a name="ln-244"></a>   <span class="c">!Advection scheme</span>
<a name="ln-245"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">iadv_upw</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c">!&lt; first order upwind scheme</span>
<a name="ln-246"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">iadv_cd2</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c">!&lt; second order central difference scheme</span>
<a name="ln-247"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">iadv_kappa</span> <span class="o">=</span> <span class="mi">7</span>  <span class="c">!&lt; Kappa scheme</span>
<a name="ln-248"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iadv_mom</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">iadv_tke</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">iadv_thl</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">iadv_qt</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">iadv_sv</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-249"></a>
<a name="ln-250"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lmoist</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!&lt;   switch to calculate moisture fields</span>
<a name="ln-251"></a>   <span class="c">! Global variables (modvar.f90)</span>
<a name="ln-252"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">xday</span> <span class="o">=</span> <span class="mf">1.</span> <span class="c">!&lt;     * day number</span>
<a name="ln-253"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">xtime</span> <span class="o">=</span> <span class="mf">0.</span> <span class="c">!&lt;     * GMT time</span>
<a name="ln-254"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">runtime</span> <span class="o">=</span> <span class="mi">30</span><span class="mf">0.</span> <span class="c">!&lt;     * simulation time in secs</span>
<a name="ln-255"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">dtmax</span> <span class="o">=</span> <span class="mi">2</span><span class="mf">0.</span> <span class="c">!&lt;     * maximum time integration interval</span>
<a name="ln-256"></a>
<a name="ln-257"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">trestart</span> <span class="o">=</span> <span class="mi">1000</span><span class="mf">0.</span> <span class="c">!&lt;     * each trestart sec. a restart file is written to disk. bss116: per default do not write restart files</span>
<a name="ln-258"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">tfielddump</span> <span class="o">=</span> <span class="mi">1000</span><span class="mf">0.</span> <span class="c">!&lt; Time step for field outputs</span>
<a name="ln-259"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">tsample</span> <span class="o">=</span> <span class="mf">5.</span> <span class="c">!&lt;    Sample time steps for statistics</span>
<a name="ln-260"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">tstatsdump</span> <span class="o">=</span> <span class="mi">1000</span><span class="mf">0.</span> <span class="c">!&lt; Time step for statistics outputs tg3315</span>
<a name="ln-261"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">tnextrestart</span> <span class="c">!&lt;     * each trestart sec. a restart file is written to disk</span>
<a name="ln-262"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">tscale</span> <span class="c">!       timescale: domain height*Uinf/utau**2</span>
<a name="ln-263"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">tnextfielddump</span> <span class="c">!&lt;</span>
<a name="ln-264"></a>   <span class="kt">character</span><span class="p">(</span><span class="mi">90</span><span class="p">)</span> <span class="kd">::</span> <span class="n">startfile</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span> <span class="c">!&lt;    * name of the restart file</span>
<a name="ln-265"></a>
<a name="ln-266"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">totavtime</span> <span class="o">=</span> <span class="mf">0.</span> <span class="c">!&lt;    * the total time over which the values are averaged in meansXXX.XXX</span>
<a name="ln-267"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">dtEB</span> <span class="o">=</span> <span class="mi">1</span><span class="mf">0.</span> <span class="c">!time interval between calculations of facet energy balance</span>
<a name="ln-268"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">tEB</span> <span class="o">=</span> <span class="mf">0.</span> <span class="c">!time of last calculation of facet energy balance</span>
<a name="ln-269"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">tnextEB</span> <span class="o">=</span> <span class="mf">0.</span> <span class="c">!time for next calculation of facet energy balance</span>
<a name="ln-270"></a>
<a name="ln-271"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">thres</span> <span class="o">=</span> <span class="mf">5.e-3</span> <span class="c">!&lt;     * threshold value for inversion height calculations</span>
<a name="ln-272"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">dqt</span> <span class="c">!&lt;     * applied gradient of qt at top of model</span>
<a name="ln-273"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">dtheta</span> <span class="c">!&lt;     * applied gradient of theta at top of model</span>
<a name="ln-274"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dsv</span><span class="p">(:)</span> <span class="c">!&lt;     * applied gradient of sv(n) at top of model</span>
<a name="ln-275"></a>
<a name="ln-276"></a>   <span class="kt">real</span> <span class="kd">::</span>  <span class="n">dt</span> <span class="c">!&lt;     * time integration interval</span>
<a name="ln-277"></a>   <span class="c">!      integer(kind=longint) :: timee             !&lt;     * elapsed time since the &quot;cold&quot; start</span>
<a name="ln-278"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">timee</span> <span class="c">!&lt;     * elapsed time since the &quot;cold&quot; start</span>
<a name="ln-279"></a>   <span class="c">!      integer(kind=longint) :: btime             !&lt;     * time of (re)start</span>
<a name="ln-280"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">btime</span> <span class="c">!&lt;     * time of (re)start</span>
<a name="ln-281"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">runavtime</span> <span class="c">!&lt;     * time of starting running average</span>
<a name="ln-282"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ntimee</span> <span class="c">!&lt;     * number of timesteps since the cold start</span>
<a name="ln-283"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ntrun</span> <span class="c">!&lt;     * number of timesteps since the start of the run</span>
<a name="ln-284"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">timeleft</span>
<a name="ln-285"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ladaptive</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!&lt;    * adaptive timestepping on or off</span>
<a name="ln-286"></a>
<a name="ln-287"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">tdriverstart</span> <span class="o">=</span> <span class="mf">0.</span>   <span class="c">!&lt;     * time at which to start recording inlet driver file (only necessary if idriver == 1)                                                                            </span>
<a name="ln-288"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">tdriverdump</span>         <span class="c">!&lt;     * time in inlet driver simulation at which data dumps are made (idriver == 1)</span>
<a name="ln-289"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">dtdriver</span> <span class="o">=</span> <span class="mf">0.1</span>      <span class="c">!&lt;     * time frequency at which inlet driver data dumps are made (idriver == 1)</span>
<a name="ln-290"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">driverstore</span>         <span class="c">!&lt;     * number of stored driver steps for inlet (automatically calculated)</span>
<a name="ln-291"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">driverjobnr</span>         <span class="c">!&lt;     * Job number of the driver inlet generation run (idriver == 2)</span>
<a name="ln-292"></a>
<a name="ln-293"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">courant</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.</span>
<a name="ln-294"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">diffnr</span> <span class="o">=</span> <span class="mf">0.25</span>
<a name="ln-295"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">dt_lim</span>
<a name="ln-296"></a>
<a name="ln-297"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">rk3step</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-298"></a>
<a name="ln-299"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iexpnr</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">!&lt;     * number of the experiment</span>
<a name="ln-300"></a>
<a name="ln-301"></a>   <span class="kt">character</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="n">cexpnr</span>
<a name="ln-302"></a>
<a name="ln-303"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">thlsrc</span> <span class="o">=</span> <span class="mf">0.</span>
<a name="ln-304"></a>
<a name="ln-305"></a>   <span class="c">! modphsgrd.f90</span>
<a name="ln-306"></a>
<a name="ln-307"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">dy</span> <span class="c">!&lt;  grid spacing in y-direction</span>
<a name="ln-308"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">dy2</span> <span class="c">!&lt;  grid spacing in y-direction squared</span>
<a name="ln-309"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">dz</span> <span class="c">!&lt;  grid spacing in z-direction</span>
<a name="ln-310"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">dyi</span> <span class="c">!&lt;  1/dy</span>
<a name="ln-311"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">dyiq</span> <span class="c">!&lt;  1/(dy*4)</span>
<a name="ln-312"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">dyi5</span> <span class="c">!&lt;  1/(dy*2)</span>
<a name="ln-313"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">dy2i</span> <span class="c">!&lt;  (1/dy)**2</span>
<a name="ln-314"></a>   
<a name="ln-315"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">nwalllayers</span> <span class="o">=</span> <span class="mi">3</span>
<a name="ln-316"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>   <span class="kd">::</span> <span class="n">AM</span><span class="p">(:,:),</span> <span class="n">BM</span><span class="p">(:,:),</span> <span class="n">CM</span><span class="p">(:,:),</span> <span class="n">DM</span><span class="p">(:,:),</span> <span class="n">EM</span><span class="p">(:,:),</span> <span class="n">FM</span><span class="p">(:,:),</span> <span class="n">GM</span><span class="p">(:,:),</span> <span class="n">HM</span><span class="p">(:,:),</span> <span class="n">inAM</span><span class="p">(:,:),</span><span class="n">IDM</span><span class="p">(:,:)</span> <span class="c">!matrices for the facet energy balance</span>
<a name="ln-317"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>   <span class="kd">::</span> <span class="n">bb</span><span class="p">(:),</span><span class="n">w</span><span class="p">(:),</span><span class="n">dumv</span><span class="p">(:),</span><span class="n">Tdash</span><span class="p">(:)</span> <span class="c">!vector for the facet energy balance</span>
<a name="ln-318"></a>
<a name="ln-319"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">rslabs</span>
<a name="ln-320"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dzf</span><span class="p">(:)</span> <span class="c">!&lt;  thickness of full level</span>
<a name="ln-321"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dzfc</span><span class="p">(:)</span> <span class="c">!&lt;  thickness of full level (extra ghost nodes (used in k-scheme)</span>
<a name="ln-322"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dzfci</span><span class="p">(:)</span> <span class="c">!&lt;  1/dzfc</span>
<a name="ln-323"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dzf2</span><span class="p">(:)</span> <span class="c">!&lt;  thickness of full level squared</span>
<a name="ln-324"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dzh</span><span class="p">(:)</span> <span class="c">!&lt;  thickness of half level</span>
<a name="ln-325"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">zh</span><span class="p">(:)</span> <span class="c">!&lt;  height of half level [m]</span>
<a name="ln-326"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">zf</span><span class="p">(:)</span> <span class="c">!&lt;  height of full level [m]</span>
<a name="ln-327"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dzfi</span><span class="p">(:)</span> <span class="c">!&lt;  1/dzf</span>
<a name="ln-328"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dzfiq</span><span class="p">(:)</span> <span class="c">!&lt;  0.25*(1/dzf)</span>
<a name="ln-329"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dzfi5</span><span class="p">(:)</span> <span class="c">!&lt;  0.5*(1/dzf)</span>
<a name="ln-330"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dzhi</span><span class="p">(:)</span> <span class="c">!&lt;  1/dzh</span>
<a name="ln-331"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dzhci</span><span class="p">(:)</span> <span class="c">!&lt;  1/dzh (extra ghost nodes (used in k-scheme)</span>
<a name="ln-332"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dzhiq</span><span class="p">(:)</span> <span class="c">!&lt;  0.25*(1/dzh)</span>
<a name="ln-333"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dzh2i</span><span class="p">(:)</span> <span class="c">!&lt;  1/dzh^2</span>
<a name="ln-334"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">zhi</span><span class="p">(:)</span> <span class="c">!&lt;  1/zh</span>
<a name="ln-335"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">zfi</span><span class="p">(:)</span> <span class="c">!&lt;  1/zf</span>
<a name="ln-336"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dxf</span><span class="p">(:)</span> <span class="c">!&lt;  thickness of full level</span>
<a name="ln-337"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dxfc</span><span class="p">(:)</span> <span class="c">!&lt;  thickness of full level (extra ghost nodes (used in k-scheme)</span>
<a name="ln-338"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dxfci</span><span class="p">(:)</span> <span class="c">!&lt;  1/dxfc</span>
<a name="ln-339"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dxf2</span><span class="p">(:)</span> <span class="c">!&lt;  thickness of full level squared</span>
<a name="ln-340"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dxfi</span><span class="p">(:)</span> <span class="c">!&lt;  = 1/dxf</span>
<a name="ln-341"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dxfiq</span><span class="p">(:)</span> <span class="c">!&lt;  = 0.25*(1/dxf)</span>
<a name="ln-342"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dxfi5</span><span class="p">(:)</span> <span class="c">!&lt;  = 0.5*(1/dxf)</span>
<a name="ln-343"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dxh</span><span class="p">(:)</span> <span class="c">!&lt;  thickness of half level</span>
<a name="ln-344"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dxhi</span><span class="p">(:)</span> <span class="c">!&lt;  = 1/dxh</span>
<a name="ln-345"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dxhci</span><span class="p">(:)</span> <span class="c">!&lt;  = 1/dxh (with extra ghost nodes (used in k-scheme))</span>
<a name="ln-346"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dxhiq</span><span class="p">(:)</span> <span class="c">!&lt;  = 0.25*(1/dxh)</span>
<a name="ln-347"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dxh2i</span><span class="p">(:)</span> <span class="c">!&lt;  = 1/dxh^2</span>
<a name="ln-348"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">xh</span><span class="p">(:)</span> <span class="c">!&lt;  height of half level [m]</span>
<a name="ln-349"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">xf</span><span class="p">(:)</span> <span class="c">!&lt;  height of full level [m]</span>
<a name="ln-350"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">xsize</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.</span> <span class="c">!&lt;  domain size in x-direction</span>
<a name="ln-351"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">ysize</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.</span> <span class="c">!&lt;  domain size in y-direction</span>
<a name="ln-352"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">delta</span><span class="p">(:,</span> <span class="p">:)</span> <span class="c">!&lt;  (dx*dy*dz)**(1/3)</span>
<a name="ln-353"></a>
<a name="ln-354"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lmomsubs</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!&lt;  switch to apply subsidence on the momentum or not</span>
<a name="ln-355"></a>   <span class="kt">character</span><span class="p">(</span><span class="mi">80</span><span class="p">)</span> <span class="kd">::</span> <span class="n">author</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">version</span> <span class="o">=</span> <span class="s1">&#39;DALES U&#39;</span>
<a name="ln-356"></a><span class="k">contains</span>
<a name="ln-357"></a>
<a name="ln-358"></a>   <span class="c">!&gt; Initialize global settings.</span>
<a name="ln-359"></a>   <span class="c">!!</span>
<a name="ln-360"></a>   <span class="c">!! Set courant number, calculate the grid sizes (both computational and physical), and set the coriolis parameter</span>
<a name="ln-361"></a>   <span class="k">subroutine </span><span class="n">initglobal</span>
<a name="ln-362"></a>      <span class="k">use </span><span class="n">modmpi</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span><span class="n">nprocs</span><span class="p">,</span> <span class="n">myid</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">my_real</span><span class="p">,</span> <span class="n">mpierr</span>
<a name="ln-363"></a>      <span class="k">implicit none</span>
<a name="ln-364"></a>
<a name="ln-365"></a><span class="k">      </span><span class="kt">integer</span> <span class="kd">::</span> <span class="n">advarr</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-366"></a>      <span class="kt">real </span><span class="n">phi</span><span class="p">,</span> <span class="n">colat</span><span class="p">,</span> <span class="n">silat</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">omega_gs</span>
<a name="ln-367"></a>      <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">n</span>
<a name="ln-368"></a>      <span class="kt">character</span><span class="p">(</span><span class="mi">80</span><span class="p">)</span> <span class="n">chmess</span>
<a name="ln-369"></a>
<a name="ln-370"></a>      <span class="c">!timestepping</span>
<a name="ln-371"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">courant</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-372"></a><span class="k">         select case</span> <span class="p">(</span><span class="n">iadv_mom</span><span class="p">)</span>
<a name="ln-373"></a>         <span class="k">case</span> <span class="p">(</span><span class="n">iadv_cd2</span><span class="p">)</span>
<a name="ln-374"></a>            <span class="n">courant</span> <span class="o">=</span> <span class="mf">1.5</span>
<a name="ln-375"></a>         <span class="k">case </span><span class="n">default</span>
<a name="ln-376"></a>            <span class="n">courant</span> <span class="o">=</span> <span class="mf">1.4</span>
<a name="ln-377"></a>         <span class="k">end select</span>
<a name="ln-378"></a><span class="k">         if</span> <span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">iadv_sv</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nsv</span><span class="p">)</span> <span class="o">==</span> <span class="n">iadv_kappa</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="nb">any</span><span class="p">((</span><span class="o">/</span><span class="n">iadv_thl</span><span class="p">,</span> <span class="n">iadv_qt</span><span class="p">,</span> <span class="n">iadv_tke</span><span class="o">/</span><span class="p">)</span> <span class="o">==</span> <span class="n">iadv_kappa</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-379"></a><span class="k">            </span><span class="n">courant</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">courant</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<a name="ln-380"></a>         <span class="n">elseif</span> <span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">iadv_sv</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nsv</span><span class="p">)</span> <span class="o">==</span> <span class="n">iadv_upw</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="nb">any</span><span class="p">((</span><span class="o">/</span><span class="n">iadv_thl</span><span class="p">,</span> <span class="n">iadv_qt</span><span class="p">,</span> <span class="n">iadv_tke</span><span class="o">/</span><span class="p">)</span> <span class="o">==</span> <span class="n">iadv_upw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-381"></a><span class="k">            </span><span class="n">courant</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">courant</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<a name="ln-382"></a>         <span class="n">elseif</span> <span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">iadv_sv</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nsv</span><span class="p">)</span> <span class="o">==</span> <span class="n">iadv_cd2</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="nb">any</span><span class="p">((</span><span class="o">/</span><span class="n">iadv_thl</span><span class="p">,</span> <span class="n">iadv_qt</span><span class="p">,</span> <span class="n">iadv_tke</span><span class="o">/</span><span class="p">)</span> <span class="o">==</span> <span class="n">iadv_cd2</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-383"></a><span class="k">            </span><span class="n">courant</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">courant</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>
<a name="ln-384"></a>         <span class="k">end if</span>
<a name="ln-385"></a><span class="k">      end if</span>
<a name="ln-386"></a>
<a name="ln-387"></a>      <span class="c">! phsgrid</span>
<a name="ln-388"></a>
<a name="ln-389"></a>      <span class="n">jmax</span> <span class="o">=</span> <span class="n">jtot</span><span class="o">/</span><span class="n">nprocs</span>
<a name="ln-390"></a>      <span class="n">isen</span> <span class="o">=</span> <span class="n">imax</span><span class="o">/</span><span class="n">nprocs</span>
<a name="ln-391"></a>      <span class="n">jsen</span> <span class="o">=</span> <span class="n">jmax</span>
<a name="ln-392"></a>      <span class="c">!set the number of ghost cells. NB: This switch has to run in order of required ghost cells</span>
<a name="ln-393"></a>      <span class="n">advarr</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="n">iadv_mom</span><span class="p">,</span> <span class="n">iadv_tke</span><span class="p">,</span> <span class="n">iadv_thl</span><span class="p">,</span> <span class="n">iadv_qt</span><span class="o">/</span><span class="p">)</span>
<a name="ln-394"></a>      <span class="k">if</span> <span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">advarr</span> <span class="o">==</span> <span class="n">iadv_kappa</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-395"></a><span class="k">         </span><span class="n">ih</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-396"></a>         <span class="n">jh</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-397"></a>         <span class="c">! ih = 1</span>
<a name="ln-398"></a>         <span class="c">! jh = 1</span>
<a name="ln-399"></a>         <span class="n">kh</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-400"></a>      <span class="n">elseif</span> <span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">advarr</span> <span class="o">==</span> <span class="n">iadv_cd2</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="nb">any</span><span class="p">(</span><span class="n">iadv_sv</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nsv</span><span class="p">)</span> <span class="o">==</span> <span class="n">iadv_cd2</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-401"></a><span class="k">         </span><span class="n">ih</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-402"></a>         <span class="n">jh</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-403"></a>         <span class="n">kh</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-404"></a>         <span class="n">ihc</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-405"></a>         <span class="n">jhc</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-406"></a>         <span class="n">khc</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-407"></a>      <span class="k">end if</span>
<a name="ln-408"></a>
<a name="ln-409"></a>      <span class="c">! J. Tomas added this for using only kappa scheme for sv(:)</span>
<a name="ln-410"></a>      <span class="k">if</span> <span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">iadv_sv</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nsv</span><span class="p">)</span> <span class="o">==</span> <span class="n">iadv_kappa</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-411"></a><span class="k">         </span><span class="n">ihc</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-412"></a>         <span class="n">jhc</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-413"></a>         <span class="n">khc</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-414"></a>      <span class="k">end if</span>
<a name="ln-415"></a>
<a name="ln-416"></a><span class="k">      </span><span class="n">offset</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-417"></a>      <span class="n">ib</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">offset</span>
<a name="ln-418"></a>      <span class="n">ie</span> <span class="o">=</span> <span class="n">imax</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">offset</span>
<a name="ln-419"></a>      <span class="n">jb</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">offset</span>
<a name="ln-420"></a>      <span class="n">je</span> <span class="o">=</span> <span class="n">jmax</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">offset</span>
<a name="ln-421"></a>      <span class="n">jgb</span> <span class="o">=</span> <span class="n">jb</span> <span class="c">! global j range (starting at the same as j as the processor j range)</span>
<a name="ln-422"></a>      <span class="n">jge</span> <span class="o">=</span> <span class="n">jtot</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">offset</span> <span class="c">! global j range</span>
<a name="ln-423"></a>      <span class="n">kb</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">offset</span>
<a name="ln-424"></a>      <span class="n">ke</span> <span class="o">=</span> <span class="n">kmax</span> <span class="o">-</span> <span class="n">offset</span>
<a name="ln-425"></a>
<a name="ln-426"></a>      <span class="c">! Global constants</span>
<a name="ln-427"></a>
<a name="ln-428"></a>      <span class="c">! Select advection scheme for scalars. If not set in the options file, the momentum scheme is used</span>
<a name="ln-429"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">iadv_tke</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">iadv_tke</span> <span class="o">=</span> <span class="n">iadv_mom</span>
<a name="ln-430"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">iadv_thl</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">iadv_thl</span> <span class="o">=</span> <span class="n">iadv_mom</span>
<a name="ln-431"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">iadv_qt</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">iadv_qt</span> <span class="o">=</span> <span class="n">iadv_mom</span>
<a name="ln-432"></a>
<a name="ln-433"></a>      <span class="c">!CvH remove where</span>
<a name="ln-434"></a>      <span class="c">!where (iadv_sv&lt;0)  iadv_sv  = iadv_mom</span>
<a name="ln-435"></a>
<a name="ln-436"></a>      <span class="c">!tg3315 added - only uses kappa advection scheme...</span>
<a name="ln-437"></a>      <span class="k">do </span><span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nsv</span>
<a name="ln-438"></a>         <span class="n">iadv_sv</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="n">iadv_kappa</span>
<a name="ln-439"></a>      <span class="k">end do</span>
<a name="ln-440"></a>      <span class="c">!ends here</span>
<a name="ln-441"></a>
<a name="ln-442"></a>      <span class="n">phi</span> <span class="o">=</span> <span class="n">xlat</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">18</span><span class="mf">0.</span>
<a name="ln-443"></a>      <span class="n">colat</span> <span class="o">=</span> <span class="nb">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
<a name="ln-444"></a>      <span class="n">silat</span> <span class="o">=</span> <span class="nb">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
<a name="ln-445"></a>
<a name="ln-446"></a>      <span class="n">omega</span> <span class="o">=</span> <span class="mf">7.292e-5</span>
<a name="ln-447"></a>      <span class="n">omega_gs</span> <span class="o">=</span> <span class="mf">7.292e-5</span>
<a name="ln-448"></a>      <span class="n">om22</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="n">colat</span>
<a name="ln-449"></a>      <span class="n">om23</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="n">silat</span>
<a name="ln-450"></a>      <span class="n">om22_gs</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">*</span><span class="n">omega_gs</span><span class="o">*</span><span class="n">colat</span>
<a name="ln-451"></a>      <span class="n">om23_gs</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">*</span><span class="n">omega_gs</span><span class="o">*</span><span class="n">silat</span>
<a name="ln-452"></a>
<a name="ln-453"></a>      <span class="c">! Variables</span>
<a name="ln-454"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">dsv</span><span class="p">(</span><span class="n">nsv</span><span class="p">))</span>
<a name="ln-455"></a>      <span class="k">write</span> <span class="p">(</span><span class="n">cexpnr</span><span class="p">,</span> <span class="s1">&#39;(i3.3)&#39;</span><span class="p">)</span> <span class="n">iexpnr</span>
<a name="ln-456"></a>
<a name="ln-457"></a>      <span class="c">! Create the physical grid variables</span>
<a name="ln-458"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">dzf</span><span class="p">(</span><span class="n">kb</span> <span class="o">-</span> <span class="n">kh</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">))</span>
<a name="ln-459"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">dzf2</span><span class="p">(</span><span class="n">kb</span> <span class="o">-</span> <span class="n">kh</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">))</span>
<a name="ln-460"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">dzfi</span><span class="p">(</span><span class="n">kb</span> <span class="o">-</span> <span class="n">kh</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">))</span>
<a name="ln-461"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">dzfiq</span><span class="p">(</span><span class="n">kb</span> <span class="o">-</span> <span class="n">kh</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">))</span>
<a name="ln-462"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">dzfi5</span><span class="p">(</span><span class="n">kb</span> <span class="o">-</span> <span class="n">kh</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">))</span>
<a name="ln-463"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">dzh</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">))</span>
<a name="ln-464"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">dzhi</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">))</span>
<a name="ln-465"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">dzhiq</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">))</span>
<a name="ln-466"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">dzh2i</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">))</span>
<a name="ln-467"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">zh</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">))</span>
<a name="ln-468"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">zf</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">))</span>
<a name="ln-469"></a>
<a name="ln-470"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">dxf</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="n">ih</span><span class="p">:</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span><span class="p">))</span>
<a name="ln-471"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">dxf2</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="n">ih</span><span class="p">:</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span><span class="p">))</span>
<a name="ln-472"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">dxfi</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="n">ih</span><span class="p">:</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span><span class="p">))</span>
<a name="ln-473"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">dxfiq</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="n">ih</span><span class="p">:</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span><span class="p">))</span>
<a name="ln-474"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">dxfi5</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="n">ih</span><span class="p">:</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span><span class="p">))</span>
<a name="ln-475"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">dxh</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span><span class="p">))</span>
<a name="ln-476"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">dxhi</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span><span class="p">))</span>
<a name="ln-477"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">dxhiq</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span><span class="p">))</span>
<a name="ln-478"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">dxh2i</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span><span class="p">))</span>
<a name="ln-479"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">xh</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span><span class="p">))</span>
<a name="ln-480"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">xf</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span><span class="p">))</span>
<a name="ln-481"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">delta</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="n">ih</span><span class="p">:</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">))</span>
<a name="ln-482"></a>
<a name="ln-483"></a>      <span class="n">rslabs</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">imax</span><span class="o">*</span><span class="n">jtot</span><span class="p">)</span>
<a name="ln-484"></a>
<a name="ln-485"></a>      <span class="n">dy</span> <span class="o">=</span> <span class="n">ysize</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">jtot</span><span class="p">)</span>
<a name="ln-486"></a>
<a name="ln-487"></a>      <span class="c">! MPI</span>
<a name="ln-488"></a>
<a name="ln-489"></a>      <span class="c">! Note, that the loop for reading zf and calculating zh</span>
<a name="ln-490"></a>      <span class="c">! has been split so that reading is only done on PE 1</span>
<a name="ln-491"></a>
<a name="ln-492"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">myid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-493"></a><span class="k">         open</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="s1">&#39;prof.inp.&#39;</span><span class="o">//</span><span class="n">cexpnr</span><span class="p">)</span>
<a name="ln-494"></a>         <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="s1">&#39;(a72)&#39;</span><span class="p">)</span> <span class="n">chmess</span>
<a name="ln-495"></a>         <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="s1">&#39;(a72)&#39;</span><span class="p">)</span> <span class="n">chmess</span>
<a name="ln-496"></a>
<a name="ln-497"></a>         <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
<a name="ln-498"></a>            <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="n">zf</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<a name="ln-499"></a>         <span class="k">end do</span>
<a name="ln-500"></a><span class="k">         close</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">)</span>
<a name="ln-501"></a>
<a name="ln-502"></a>         <span class="c">! J. Tomas: Read the x-coordinates of the cell centers from xgrid.inp.XXX</span>
<a name="ln-503"></a>         <span class="k">open</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="s1">&#39;xgrid.inp.&#39;</span><span class="o">//</span><span class="n">cexpnr</span><span class="p">)</span>
<a name="ln-504"></a>         <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="s1">&#39;(a72)&#39;</span><span class="p">)</span> <span class="n">chmess</span>
<a name="ln-505"></a>         <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="s1">&#39;(a72)&#39;</span><span class="p">)</span> <span class="n">chmess</span>
<a name="ln-506"></a>
<a name="ln-507"></a>         <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ie</span>
<a name="ln-508"></a>            <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="n">xf</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-509"></a>         <span class="k">end do</span>
<a name="ln-510"></a><span class="k">         close</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">)</span>
<a name="ln-511"></a>
<a name="ln-512"></a>      <span class="k">end if</span> <span class="c">! end if myid==0</span>
<a name="ln-513"></a>
<a name="ln-514"></a>      <span class="c">! MPI broadcast kmax elements from zf</span>
<a name="ln-515"></a>      <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">zf</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-516"></a>      <span class="c">! MPI broadcast imax elements from xf</span>
<a name="ln-517"></a>      <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">xf</span><span class="p">,</span> <span class="n">imax</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-518"></a>
<a name="ln-519"></a>      <span class="n">zh</span><span class="p">(</span><span class="n">kb</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="ln-520"></a>      <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
<a name="ln-521"></a>         <span class="n">zh</span><span class="p">(</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">zh</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="mf">2.0</span><span class="o">*</span><span class="p">(</span><span class="n">zf</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">-</span> <span class="n">zh</span><span class="p">(</span><span class="n">k</span><span class="p">))</span>
<a name="ln-522"></a>      <span class="k">end do</span>
<a name="ln-523"></a><span class="k">      </span><span class="n">zf</span><span class="p">(</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">)</span> <span class="o">=</span> <span class="n">zf</span><span class="p">(</span><span class="n">ke</span><span class="p">)</span> <span class="o">+</span> <span class="mf">2.0</span><span class="o">*</span><span class="p">(</span><span class="n">zh</span><span class="p">(</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">)</span> <span class="o">-</span> <span class="n">zf</span><span class="p">(</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-524"></a>
<a name="ln-525"></a>      <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
<a name="ln-526"></a>         <span class="n">dzf</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">zh</span><span class="p">(</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">zh</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<a name="ln-527"></a>      <span class="k">end do</span>
<a name="ln-528"></a><span class="k">      </span><span class="n">dzf</span><span class="p">(</span><span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">dzf</span><span class="p">(</span><span class="n">ke</span><span class="p">)</span>
<a name="ln-529"></a>      <span class="n">dzf</span><span class="p">(</span><span class="n">kb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">dzf</span><span class="p">(</span><span class="n">kb</span><span class="p">)</span>
<a name="ln-530"></a>
<a name="ln-531"></a>      <span class="n">dzh</span><span class="p">(</span><span class="n">kb</span><span class="p">)</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">zf</span><span class="p">(</span><span class="n">kb</span><span class="p">)</span>
<a name="ln-532"></a>      <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span>
<a name="ln-533"></a>         <span class="n">dzh</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">zf</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">-</span> <span class="n">zf</span><span class="p">(</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-534"></a>      <span class="k">end do</span>
<a name="ln-535"></a>
<a name="ln-536"></a>      <span class="c">! j. tomas: same trick for x-direction...</span>
<a name="ln-537"></a>      <span class="n">xh</span><span class="p">(</span><span class="n">ib</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="ln-538"></a>      <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ie</span>
<a name="ln-539"></a>         <span class="n">xh</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">xh</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="mf">2.0</span><span class="o">*</span><span class="p">(</span><span class="n">xf</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">-</span> <span class="n">xh</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<a name="ln-540"></a>      <span class="k">end do</span>
<a name="ln-541"></a><span class="k">      </span><span class="n">xf</span><span class="p">(</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span><span class="p">)</span> <span class="o">=</span> <span class="n">xf</span><span class="p">(</span><span class="n">ie</span><span class="p">)</span> <span class="o">+</span> <span class="mf">2.0</span><span class="o">*</span><span class="p">(</span><span class="n">xh</span><span class="p">(</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span><span class="p">)</span> <span class="o">-</span> <span class="n">xf</span><span class="p">(</span><span class="n">ie</span><span class="p">))</span>
<a name="ln-542"></a>
<a name="ln-543"></a>      <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ie</span>
<a name="ln-544"></a>         <span class="n">dxf</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">xh</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">xh</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-545"></a>      <span class="k">end do</span>
<a name="ln-546"></a><span class="k">      </span><span class="n">dxf</span><span class="p">(</span><span class="n">ie</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">dxf</span><span class="p">(</span><span class="n">ie</span><span class="p">)</span>
<a name="ln-547"></a>      <span class="n">dxf</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">dxf</span><span class="p">(</span><span class="n">ib</span><span class="p">)</span>
<a name="ln-548"></a>
<a name="ln-549"></a>      <span class="n">dxh</span><span class="p">(</span><span class="n">ib</span><span class="p">)</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">xf</span><span class="p">(</span><span class="n">ib</span><span class="p">)</span>
<a name="ln-550"></a>      <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ib</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span>
<a name="ln-551"></a>         <span class="n">dxh</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">xf</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">-</span> <span class="n">xf</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-552"></a>      <span class="k">end do</span>
<a name="ln-553"></a>
<a name="ln-554"></a><span class="k">      do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span>
<a name="ln-555"></a>         <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ib</span> <span class="o">-</span> <span class="n">ih</span><span class="p">,</span> <span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span>
<a name="ln-556"></a>            <span class="n">delta</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">dxf</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">dy</span><span class="o">*</span><span class="n">dzf</span><span class="p">(</span><span class="n">k</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="mf">3.</span><span class="p">)</span>
<a name="ln-557"></a>         <span class="k">end do</span>
<a name="ln-558"></a><span class="k">      end do</span>
<a name="ln-559"></a>
<a name="ln-560"></a>      <span class="c">!--------------------------------------------------</span>
<a name="ln-561"></a>      <span class="c">! *** Check whether the grid is equidistant *****</span>
<a name="ln-562"></a>      <span class="c">!--------------------------------------------------</span>
<a name="ln-563"></a>      
<a name="ln-564"></a>      <span class="c">!if (myid == 0) then</span>
<a name="ln-565"></a>      <span class="c">!do k=kb,ke+kh</span>
<a name="ln-566"></a>      <span class="c">!if (.not.(dzf(k).eq.dzf(1)))</span>
<a name="ln-567"></a>      <span class="c">!      write (6, *) &amp;</span>
<a name="ln-568"></a>      <span class="c">!      &#39;WARNING, You are working with a non-equidistant grid!!!!&#39;</span>
<a name="ln-569"></a>      <span class="c">!end if</span>
<a name="ln-570"></a>      <span class="c">!end do</span>
<a name="ln-571"></a>      <span class="c">!end if ! end if myid==0</span>
<a name="ln-572"></a>
<a name="ln-573"></a>      <span class="n">dzhi</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">dzh</span>
<a name="ln-574"></a>      <span class="n">dzfi</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">dzf</span>
<a name="ln-575"></a>      <span class="n">dzf2</span> <span class="o">=</span> <span class="n">dzf</span><span class="o">*</span><span class="n">dzf</span>
<a name="ln-576"></a>      <span class="n">dxhi</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">dxh</span>
<a name="ln-577"></a>      <span class="n">dxfi</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">dxf</span>
<a name="ln-578"></a>      <span class="n">dxf2</span> <span class="o">=</span> <span class="n">dxf</span><span class="o">*</span><span class="n">dxf</span>
<a name="ln-579"></a>      <span class="n">dyi</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">dy</span>
<a name="ln-580"></a>      <span class="n">dy2</span> <span class="o">=</span> <span class="n">dy</span><span class="o">*</span><span class="n">dy</span>
<a name="ln-581"></a>
<a name="ln-582"></a>      <span class="n">dzhiq</span> <span class="o">=</span> <span class="mf">0.25</span><span class="o">*</span><span class="n">dzhi</span>
<a name="ln-583"></a>      <span class="n">dzfiq</span> <span class="o">=</span> <span class="mf">0.25</span><span class="o">*</span><span class="n">dzfi</span>
<a name="ln-584"></a>      <span class="n">dxhiq</span> <span class="o">=</span> <span class="mf">0.25</span><span class="o">*</span><span class="n">dxhi</span>
<a name="ln-585"></a>      <span class="n">dxfiq</span> <span class="o">=</span> <span class="mf">0.25</span><span class="o">*</span><span class="n">dxfi</span>
<a name="ln-586"></a>      <span class="n">dyiq</span> <span class="o">=</span> <span class="mf">0.25</span><span class="o">*</span><span class="n">dyi</span>
<a name="ln-587"></a>
<a name="ln-588"></a>      <span class="n">dzh2i</span> <span class="o">=</span> <span class="n">dzhi</span><span class="o">*</span><span class="n">dzhi</span>
<a name="ln-589"></a>      <span class="n">dxh2i</span> <span class="o">=</span> <span class="n">dxhi</span><span class="o">*</span><span class="n">dxhi</span>
<a name="ln-590"></a>      <span class="n">dy2i</span> <span class="o">=</span> <span class="n">dyi</span><span class="o">*</span><span class="n">dyi</span>
<a name="ln-591"></a>
<a name="ln-592"></a>      <span class="n">dzfi5</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">dzfi</span>
<a name="ln-593"></a>      <span class="n">dxfi5</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">dxfi</span>
<a name="ln-594"></a>      <span class="n">dyi5</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">dyi</span>
<a name="ln-595"></a>
<a name="ln-596"></a>      <span class="c">! Grid used in kappa scheme advection (extra ghost nodes)</span>
<a name="ln-597"></a>      <span class="k">if</span> <span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">iadv_sv</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nsv</span><span class="p">)</span> <span class="o">==</span> <span class="n">iadv_kappa</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-598"></a><span class="k">         allocate</span> <span class="p">(</span><span class="n">dzfc</span><span class="p">(</span><span class="n">kb</span> <span class="o">-</span> <span class="n">khc</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">khc</span><span class="p">))</span>
<a name="ln-599"></a>         <span class="k">allocate</span> <span class="p">(</span><span class="n">dxfc</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="n">ihc</span><span class="p">:</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ihc</span><span class="p">))</span>
<a name="ln-600"></a>         <span class="k">allocate</span> <span class="p">(</span><span class="n">dzfci</span><span class="p">(</span><span class="n">kb</span> <span class="o">-</span> <span class="n">khc</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">khc</span><span class="p">))</span>
<a name="ln-601"></a>         <span class="k">allocate</span> <span class="p">(</span><span class="n">dxfci</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="n">ihc</span><span class="p">:</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ihc</span><span class="p">))</span>
<a name="ln-602"></a>         <span class="k">allocate</span> <span class="p">(</span><span class="n">dzhci</span><span class="p">(</span><span class="n">kb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">khc</span><span class="p">))</span>
<a name="ln-603"></a>         <span class="k">allocate</span> <span class="p">(</span><span class="n">dxhci</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ihc</span><span class="p">))</span>
<a name="ln-604"></a>
<a name="ln-605"></a>         <span class="n">dzfc</span><span class="p">(</span><span class="n">kb</span> <span class="o">-</span> <span class="n">kh</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">)</span> <span class="o">=</span> <span class="n">dzf</span><span class="p">(</span><span class="n">kb</span> <span class="o">-</span> <span class="n">kh</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">)</span>
<a name="ln-606"></a>         <span class="n">dzfc</span><span class="p">(</span><span class="n">kb</span> <span class="o">-</span> <span class="n">khc</span><span class="p">)</span> <span class="o">=</span> <span class="n">dzfc</span><span class="p">(</span><span class="n">kb</span> <span class="o">-</span> <span class="n">kh</span><span class="p">)</span>
<a name="ln-607"></a>         <span class="n">dzfc</span><span class="p">(</span><span class="n">ke</span> <span class="o">+</span> <span class="n">khc</span><span class="p">)</span> <span class="o">=</span> <span class="n">dzfc</span><span class="p">(</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">)</span>
<a name="ln-608"></a>
<a name="ln-609"></a>         <span class="n">dxfc</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="n">ih</span><span class="p">:</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span><span class="p">)</span> <span class="o">=</span> <span class="n">dxf</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="n">ih</span><span class="p">:</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span><span class="p">)</span>
<a name="ln-610"></a>         <span class="n">dxfc</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="n">ihc</span><span class="p">)</span> <span class="o">=</span> <span class="n">dxfc</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="n">ih</span><span class="p">)</span>
<a name="ln-611"></a>         <span class="n">dxfc</span><span class="p">(</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ihc</span><span class="p">)</span> <span class="o">=</span> <span class="n">dxfc</span><span class="p">(</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span><span class="p">)</span>
<a name="ln-612"></a>
<a name="ln-613"></a>         <span class="n">dzhci</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">)</span> <span class="o">=</span> <span class="n">dzhi</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">)</span>
<a name="ln-614"></a>         <span class="n">dzhci</span><span class="p">(</span><span class="n">kb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">dzhci</span><span class="p">(</span><span class="n">kb</span><span class="p">)</span>
<a name="ln-615"></a>         <span class="n">dzhci</span><span class="p">(</span><span class="n">ke</span> <span class="o">+</span> <span class="n">khc</span><span class="p">)</span> <span class="o">=</span> <span class="n">dzhci</span><span class="p">(</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">)</span>
<a name="ln-616"></a>
<a name="ln-617"></a>         <span class="n">dxhci</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span><span class="p">)</span> <span class="o">=</span> <span class="n">dxhi</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span><span class="p">)</span>
<a name="ln-618"></a>         <span class="n">dxhci</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">dxhci</span><span class="p">(</span><span class="n">ib</span><span class="p">)</span>
<a name="ln-619"></a>         <span class="n">dxhci</span><span class="p">(</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ihc</span><span class="p">)</span> <span class="o">=</span> <span class="n">dxhci</span><span class="p">(</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span><span class="p">)</span>
<a name="ln-620"></a>
<a name="ln-621"></a>         <span class="n">dzfci</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">dzfc</span>
<a name="ln-622"></a>         <span class="n">dxfci</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">dxfc</span>
<a name="ln-623"></a>      <span class="k">end if</span>
<a name="ln-624"></a>
<a name="ln-625"></a><span class="k">      if</span> <span class="p">(</span><span class="n">myid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-626"></a>
<a name="ln-627"></a><span class="k">         write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;lev    dz     zf      zh       dzh    delta(ib,k)&#39;</span>
<a name="ln-628"></a>         <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-629"></a>            <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;(i4,5f8.5)&#39;</span><span class="p">)</span> <span class="n">k</span><span class="p">,</span> <span class="n">dzf</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="n">zf</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="n">zh</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="n">dzh</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="n">delta</span><span class="p">(</span><span class="n">ib</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
<a name="ln-630"></a>         <span class="k">end do</span>
<a name="ln-631"></a>         <span class="c">! same for x:</span>
<a name="ln-632"></a>         <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;lev    dxf     xf      xh       dxh    delta(i,kb)&#39;</span>
<a name="ln-633"></a>         <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ie</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ib</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-634"></a>            <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;(i4,5f9.5)&#39;</span><span class="p">)</span> <span class="n">i</span><span class="p">,</span> <span class="n">dxf</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">xf</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">xh</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">dxh</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">delta</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">kb</span><span class="p">)</span>
<a name="ln-635"></a>         <span class="k">end do</span>
<a name="ln-636"></a><span class="k">      end if</span>
<a name="ln-637"></a><span class="k">      </span><span class="n">tnextrestart</span> <span class="o">=</span> <span class="n">trestart</span>
<a name="ln-638"></a>      <span class="n">tnextfielddump</span> <span class="o">=</span> <span class="n">tfielddump</span>
<a name="ln-639"></a><span class="c">!    tnextstatsdump = tstatsdump</span>
<a name="ln-640"></a>      <span class="n">timeleft</span> <span class="o">=</span> <span class="n">runtime</span> <span class="c">! tg3315 previously btime + runtime</span>
<a name="ln-641"></a>
<a name="ln-642"></a>   <span class="k">end subroutine </span><span class="n">initglobal</span>
<a name="ln-643"></a>
<a name="ln-644"></a>   <span class="c">!&gt; Clean up when leaving the run</span>
<a name="ln-645"></a>   <span class="k">subroutine </span><span class="n">exitglobal</span>
<a name="ln-646"></a>      <span class="k">deallocate</span> <span class="p">(</span><span class="n">dsv</span><span class="p">,</span> <span class="n">dzf</span><span class="p">,</span> <span class="n">dzh</span><span class="p">,</span> <span class="n">zh</span><span class="p">,</span> <span class="n">zf</span><span class="p">,</span> <span class="n">delta</span><span class="p">)</span>
<a name="ln-647"></a>   <span class="k">end subroutine </span><span class="n">exitglobal</span>
<a name="ln-648"></a>
<a name="ln-649"></a><span class="k">end module </span><span class="n">modglobal</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2021 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> uDALES was developed by The uDALES Team</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>